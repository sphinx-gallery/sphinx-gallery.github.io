

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Configuration &mdash; Sphinx-Gallery 0.9.0.dev0-git documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Who uses Sphinx-Gallery" href="projects_list.html" />
    <link rel="prev" title="How to structure your Python scripts for Sphinx-Gallery" href="syntax.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Sphinx-Gallery
          

          
          </a>

          
            
            
              <div class="version">
                0.9.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Versions</span>
        v: dev
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Versions</dt>
          
            <dd><a href="https://sphinx-gallery.github.io/dev">dev</a></dd>
          
            <dd><a href="https://sphinx-gallery.github.io/stable">stable</a></dd>
          
        </dl>
      </div>
    </div>

    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Using Sphinx Gallery</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started with Sphinx-Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax.html">How to structure your Python scripts for Sphinx-Gallery</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#list-of-config-options">List of config options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#removing-warnings">Removing warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manage-multiple-galleries">Manage multiple galleries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parsing-and-executing-examples-via-matching-patterns">Parsing and executing examples via matching patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rerunning-stale-examples">Rerunning stale examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#passing-command-line-arguments-to-example-scripts">Passing command line arguments to example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting-gallery-subsections">Sorting gallery subsections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting-gallery-examples">Sorting gallery examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-intersphinx-links-to-your-examples">Add intersphinx links to your examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-mini-galleries-for-api-documentation">Add mini-galleries for API documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#examples-using-numpy-exp">Examples using <code class="docutils literal notranslate"><span class="pre">numpy.exp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#auto-documenting-your-api-with-links-to-examples">Auto-documenting your API with links to examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#toggling-global-variable-inspection">Toggling global variable inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stylizing-code-links-using-css">Stylizing code links using CSS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-custom-default-thumbnail">Using a custom default thumbnail</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-line-numbers-to-examples">Adding line numbers to examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#removing-config-comments">Removing config comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-your-own-first-and-last-notebook-cell">Add your own first and last notebook cell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-images-to-notebooks">Adding images to notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-pypandoc-to-convert-rst-to-markdown">Using pypandoc to convert rST to markdown</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-junit-xml-files">Using JUnit XML files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-log-level">Setting log level</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disabling-download-button-of-all-scripts">Disabling download button of all scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#choosing-the-thumbnail-image">Choosing the thumbnail image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#providing-an-image-for-the-thumbnail-image">Providing an image for the thumbnail image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-binder-links-for-gallery-notebooks-experimental">Generate Binder links for gallery notebooks (experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-without-executing-examples">Building without executing examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compressing-images">Compressing images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-scrapers">Image scrapers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resetting-modules">Resetting modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dealing-with-failing-gallery-example-scripts">Dealing with failing Gallery example scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abort-build-on-first-fail">Abort build on first fail</a></li>
<li class="toctree-l3"><a class="reference internal" href="#don-t-fail-the-build-on-exit">Don’t fail the build on exit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#setting-gallery-thumbnail-size">Setting gallery thumbnail size</a></li>
<li class="toctree-l2"><a class="reference internal" href="#minimal-reported-time">Minimal reported time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#showing-memory-consumption">Showing memory consumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="#show-signature">Show signature</a></li>
<li class="toctree-l2"><a class="reference internal" href="#controlling-what-output-is-captured">Controlling what output is captured</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prevent-capture-of-certain-classes">Prevent capture of certain classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="projects_list.html">Who uses Sphinx-Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced usage and information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Sphinx-Gallery Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Example galleries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Gallery of Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/index.html">Notebook style example</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_mayavi_examples/index.html">Gallery of Examples using Mayavi</a></li>
</ul>
<p class="caption"><span class="caption-text">API and developer reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Sphinx-Gallery API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery">Fork Sphinx-Gallery on Github</a></li>
</ul>

            
          

  
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sphinx-Gallery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Configuration</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration">
<span id="id1"></span><h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>Configuration and customization of Sphinx-Gallery is done primarily with a
dictionary specified in your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file. A list of the possible
keys are listed <a class="reference internal" href="#list-of-options"><span class="std std-ref">below</span></a> and explained in
greater detail in subsequent sections.</p>
<div class="section" id="list-of-config-options">
<span id="list-of-options"></span><h2>List of config options<a class="headerlink" href="#list-of-config-options" title="Permalink to this headline">¶</a></h2>
<p>Most Sphinx-Gallery configuration options are set in the Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>
file:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">examples_dirs</span></code> and <code class="docutils literal notranslate"><span class="pre">gallery_dirs</span></code> (<a class="reference internal" href="#multiple-galleries-config"><span class="std std-ref">Manage multiple galleries</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code> and <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code> (<a class="reference internal" href="#build-pattern"><span class="std std-ref">Parsing and executing examples via matching patterns</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run_stale_examples</span></code> (<a class="reference internal" href="#run-stale-examples"><span class="std std-ref">Rerunning stale examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset_argv</span></code> (<a class="reference internal" href="#reset-argv"><span class="std std-ref">Passing command line arguments to example scripts</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subsection_order</span></code> (<a class="reference internal" href="#sub-gallery-order"><span class="std std-ref">Sorting gallery subsections</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">within_subsection_order</span></code> (<a class="reference internal" href="#within-gallery-order"><span class="std std-ref">Sorting gallery examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reference_url</span></code> (<a class="reference internal" href="#link-to-documentation"><span class="std std-ref">Add intersphinx links to your examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">backreferences_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">doc_module</span></code>, and <code class="docutils literal notranslate"><span class="pre">inspect_global_variables</span></code> (<a class="reference internal" href="#references-to-examples"><span class="std std-ref">Add mini-galleries for API documentation</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_thumb_file</span></code> (<a class="reference internal" href="#custom-default-thumb"><span class="std std-ref">Using a custom default thumbnail</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code> (<a class="reference internal" href="#setting-thumbnail-size"><span class="std std-ref">Setting gallery thumbnail size</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">line_numbers</span></code> (<a class="reference internal" href="#adding-line-numbers"><span class="std std-ref">Adding line numbers to examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_config_comments</span></code> (<a class="reference internal" href="#removing-config-comments"><span class="std std-ref">Removing config comments</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_all_examples</span></code> (<a class="reference internal" href="#disable-all-scripts-download"><span class="std std-ref">Disabling download button of all scripts</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_gallery</span></code> (<a class="reference internal" href="#without-execution"><span class="std std-ref">Building without executing examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image_scrapers</span></code> (and the deprecated <code class="docutils literal notranslate"><span class="pre">find_mayavi_figures</span></code>)
(<a class="reference internal" href="#image-scrapers"><span class="std std-ref">Image scrapers</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compress_images</span></code> (<a class="reference internal" href="#compress-images"><span class="std std-ref">Compressing images</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset_modules</span></code> (<a class="reference internal" href="#reset-modules"><span class="std std-ref">Resetting modules</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abort_on_example_error</span></code> (<a class="reference internal" href="#abort-on-first"><span class="std std-ref">Abort build on first fail</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expected_failing_examples</span></code> (<a class="reference internal" href="#dont-fail-exit"><span class="std std-ref">Don’t fail the build on exit</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_reported_time</span></code> (<a class="reference internal" href="#min-reported-time"><span class="std std-ref">Minimal reported time</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_memory</span></code> (<a class="reference internal" href="#show-memory"><span class="std std-ref">Showing memory consumption</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_signature</span></code> (<a class="reference internal" href="#show-signature"><span class="std std-ref">Show signature</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binder</span></code> (<a class="reference internal" href="#binder-links"><span class="std std-ref">Generate Binder links for gallery notebooks (experimental)</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">first_notebook_cell</span></code> and <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code> (<a class="reference internal" href="#own-notebook-cell"><span class="std std-ref">Add your own first and last notebook cell</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notebook_images</span></code> (<a class="reference internal" href="#notebook-images"><span class="std std-ref">Adding images to notebooks</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> (<a class="reference internal" href="#use-pypandoc"><span class="std std-ref">Using pypandoc to convert rST to markdown</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">junit</span></code> (<a class="reference internal" href="#junit-xml"><span class="std std-ref">Using JUnit XML files</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_level</span></code> (<a class="reference internal" href="#log-level"><span class="std std-ref">Setting log level</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> and <code class="docutils literal notranslate"><span class="pre">ignore_repr_types</span></code> (<a class="reference internal" href="#capture-repr"><span class="std std-ref">Controlling what output is captured</span></a>)</p></li>
</ul>
<p>Some options can also be set or overridden on a file-by-file basis:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_line_numbers</span></code> (<a class="reference internal" href="#adding-line-numbers"><span class="std std-ref">Adding line numbers to examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_thumbnail_number</span></code> (<a class="reference internal" href="#choosing-thumbnail"><span class="std std-ref">Choosing the thumbnail image</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_thumbnail_path</span></code> (<a class="reference internal" href="#providing-thumbnail"><span class="std std-ref">Providing an image for the thumbnail image</span></a>)</p></li>
</ul>
<p>See also <a class="reference internal" href="#removing-config-comments"><span class="std std-ref">Removing config comments</span></a> to hide these comments from the
rendered examples.</p>
<p>Some options can be set during the build execution step, e.g. using a Makefile:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html-noplot</span></code> (<a class="reference internal" href="#without-execution"><span class="std std-ref">Building without executing examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html_abort_on_example_error</span></code> (<a class="reference internal" href="#abort-on-first"><span class="std std-ref">Abort build on first fail</span></a>)</p></li>
</ul>
<p>And some things can be tweaked directly in CSS:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.sphx-glr-thumbcontainer</span></code> (<a class="reference internal" href="#setting-thumbnail-size"><span class="std std-ref">Setting gallery thumbnail size</span></a>)</p></li>
</ul>
</div>
<div class="section" id="removing-warnings">
<span id="id2"></span><h2>Removing warnings<a class="headerlink" href="#removing-warnings" title="Permalink to this headline">¶</a></h2>
<p>To prevent warnings from being captured and included in your built
documentation, you can use the package <code class="docutils literal notranslate"><span class="pre">warnings</span></code> in the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file.
For example, to remove the specific Matplotlib agg warning, you can add:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="s1">&#39;Matplotlib is currently using agg, which is a&#39;</span>
                                <span class="s1">&#39; non-GUI backend, so cannot show the figure.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>to your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file.</p>
<p>Note that the above Matplotlib warning is removed by default.</p>
</div>
<div class="section" id="manage-multiple-galleries">
<span id="multiple-galleries-config"></span><h2>Manage multiple galleries<a class="headerlink" href="#manage-multiple-galleries" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery only supports up to sub-folder level in its gallery directories.
This might be a limitation for you. Or you might want to have separate
galleries for different purposes, an examples gallery and a tutorials gallery.
For this you use in your Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file a list of directories in
the sphinx configuration dictionary:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;examples_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples&#39;</span><span class="p">,</span> <span class="s1">&#39;../tutorials&#39;</span><span class="p">],</span>
    <span class="s1">&#39;gallery_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto_examples&#39;</span><span class="p">,</span> <span class="s1">&#39;tutorials&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Keep in mind that both lists have to be of the same length.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your examples take a long time to run, consider looking at the
<a class="reference internal" href="auto_examples/sg_execution_times.html#sphx-glr-auto-examples-sg-execution-times"><span class="std std-ref">execution times</span></a>
file that is generated for each gallery dir (as long as any examples
were actually executed in that directory during the build).</p>
</div>
</div>
<div class="section" id="parsing-and-executing-examples-via-matching-patterns">
<span id="build-pattern"></span><h2>Parsing and executing examples via matching patterns<a class="headerlink" href="#parsing-and-executing-examples-via-matching-patterns" title="Permalink to this headline">¶</a></h2>
<p>By default, Sphinx-Gallery will <strong>parse and add</strong> all files with a <code class="docutils literal notranslate"><span class="pre">.py</span></code>
extension to the gallery, but only <strong>execute</strong> files beginning with <code class="docutils literal notranslate"><span class="pre">plot_</span></code>.
These behaviors are controlled by the <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code> and <code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code>
entries, which have the default values:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/plot_&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ignore_pattern&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;__init__\.py&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To omit some files from the gallery entirely (i.e., not execute, parse, or
add them), you can change the <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code> option.
To choose which of the parsed and added Python scripts are actually
executed, you can modify <code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code>. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/plot_compute_&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>will build all examples starting with <code class="docutils literal notranslate"><span class="pre">plot_compute_</span></code>. The key
<code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code> (and <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code>) accepts <a class="reference external" href="https://docs.python.org/library/re.html">regular expressions</a>
which will be matched with the full path of the example. This is the reason
the leading <code class="docutils literal notranslate"><span class="pre">'/'</span></code> is required. Users are advised to use <code class="docutils literal notranslate"><span class="pre">re.escape(os.sep)</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">'/'</span></code> if they want to be agnostic to the operating system.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code> option is also useful if you want to build only a
subset of the examples. For example, you may
want to build only one example so that you can link it in the documentation. In that case,
you would do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;plot_awesome_example\.py&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, one should escape the dot <code class="docutils literal notranslate"><span class="pre">r'\.'</span></code> as otherwise python <a class="reference external" href="https://docs.python.org/library/re.html">regular expressions</a> matches any character. Nevertheless, as
one is targeting a specific file, it would match the dot in the filename even without this escape character.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sphinx-Gallery only re-runs examples that have changed (according to their
md5 hash). See <a class="reference internal" href="#run-stale-examples"><span class="std std-ref">Rerunning stale examples</span></a> below for information.</p>
</div>
<p>Similarly, to build only examples in a specific directory, you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/directory/plot_&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Alternatively, you can skip executing some examples. For example, to skip building examples
starting with <code class="docutils literal notranslate"><span class="pre">plot_long_examples_</span></code>, you would do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/plot_(?!long_examples)&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As the patterns are parsed as <a class="reference external" href="https://docs.python.org/library/re.html">regular expressions</a>, users are advised to consult the
<a class="reference external" href="https://docs.python.org/library/re.html">regular expressions</a> module for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that Sphinx allows overriding <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> values from the command
line, so you can for example build a single example directly via something like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sphinx-build -D sphinx_gallery_conf.filename_pattern<span class="o">=</span>plot_specific_example<span class="se">\.</span>py ...
</pre></div>
</div>
</div>
</div>
<div class="section" id="rerunning-stale-examples">
<span id="run-stale-examples"></span><h2>Rerunning stale examples<a class="headerlink" href="#rerunning-stale-examples" title="Permalink to this headline">¶</a></h2>
<p>By default, Sphinx-Gallery only rebuilds examples that have changed.
For example, when starting from a clean <code class="docutils literal notranslate"><span class="pre">doc/</span></code> directory, running your HTML
build once will result in Sphinx-Gallery executing all examples that match your
given <a class="reference internal" href="#build-pattern"><span class="std std-ref">filename/ignore patterns</span></a>. Then, running
the exact same command a second time <em>should not run any examples</em>, because the
MD5 hash of each example will be checked against the MD5 hash (saved to disk
as <code class="docutils literal notranslate"><span class="pre">&lt;filename&gt;.md5</span></code> in the generated directory) that the example file had
during the first build. These will match and thus the example will be
determined to be “stale”, and it will not be rebuilt by Sphinx-Gallery.
This design feature allows for more rapid documentation iteration by only
rebuilding examples when they change.</p>
<p>However, this presents a problem during some modes of debugging and
iteration. Let’s say that you have one particular
example that you want to rebuild repeatedly while modifying some function in
your underlying library but do not want to change the example file contents
themselves. To do this, you’d either need to make some change (e.g., add/delete
a newline) to your example or delete the <code class="docutils literal notranslate"><span class="pre">.md5</span></code> file to force Sphinx-Gallery
to rebuild the example. Instead, you can use the configuration value:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;run_stale_examples&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With this configuration, all examples matching the filename/ignore pattern will
be rebuilt, even if their MD5 hash shows that the example did not change.
You can combine this with <a class="reference internal" href="#build-pattern"><span class="std std-ref">filename/ignore patterns</span></a>
to repeatedly rerun a single example.
This could be done from the command line, for example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>make html <span class="nv">SPHINXOPTS</span><span class="o">=</span><span class="s2">&quot;-D sphinx_gallery_conf.run_stale_examples=True -D sphinx_gallery_conf.filename_pattern=&#39;my_example_name&#39;&quot;</span>
</pre></div>
</div>
<p>This command will cause any examples matching the filename pattern
<code class="docutils literal notranslate"><span class="pre">'my_example_name'</span></code> to be rebuilt, regardless of their MD5 hashes.</p>
</div>
<div class="section" id="passing-command-line-arguments-to-example-scripts">
<span id="reset-argv"></span><h2>Passing command line arguments to example scripts<a class="headerlink" href="#passing-command-line-arguments-to-example-scripts" title="Permalink to this headline">¶</a></h2>
<p>By default, Sphinx-Gallery will not pass any command line arguments to example
scripts.  By setting the <code class="docutils literal notranslate"><span class="pre">reset_argv</span></code> option, it is possible to change this
behavior and pass command line arguments to example scripts.  <code class="docutils literal notranslate"><span class="pre">reset_argv</span></code>
needs to be a Callable that accepts the <code class="docutils literal notranslate"><span class="pre">gallery_conf</span></code> and <code class="docutils literal notranslate"><span class="pre">script_vars</span></code>
dictionaries as input and returns a list of strings that are passed as
additional command line arguments to the interpreter.</p>
<p>An example could be:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ResetArgv</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;ResetArgv&#39;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sphinx_gallery_conf</span><span class="p">,</span> <span class="n">script_vars</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">script_vars</span><span class="p">[</span><span class="s1">&#39;src_file&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;example1.py&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">script_vars</span><span class="p">[</span><span class="s1">&#39;src_file&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;example2.py&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>which is included in the configuration dictionary as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reset_argv&#39;</span><span class="p">:</span> <span class="n">ResetArgv</span><span class="p">(),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>which is then used by Sphinx-Gallery as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">script_vars</span><span class="p">[</span><span class="s1">&#39;src_file&#39;</span><span class="p">]</span>
<span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">gallery_conf</span><span class="p">[</span><span class="s1">&#39;reset_argv&#39;</span><span class="p">](</span><span class="n">gallery_conf</span><span class="p">,</span> <span class="n">script_vars</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sorting-gallery-subsections">
<span id="sub-gallery-order"></span><h2>Sorting gallery subsections<a class="headerlink" href="#sorting-gallery-subsections" title="Permalink to this headline">¶</a></h2>
<p>Gallery subsections are sorted by default alphabetically by their folder
name, and as such you can always organize them by changing your folder
names. An alternative option is to use a sortkey to organize those
subsections. We provide an explicit order sortkey where you have to define
the order of all subfolders in your galleries:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sphinx_gallery.sorting</span> <span class="kn">import</span> <span class="n">ExplicitOrder</span>
<span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;examples_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples&#39;</span><span class="p">,</span><span class="s1">&#39;../tutorials&#39;</span><span class="p">],</span>
    <span class="s1">&#39;subsection_order&#39;</span><span class="p">:</span> <span class="n">ExplicitOrder</span><span class="p">([</span><span class="s1">&#39;../examples/sin_func&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;../examples/no_output&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;../tutorials/seaborn&#39;</span><span class="p">]),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here we build 2 main galleries <cite>examples</cite> and <cite>tutorials</cite>, each of them
with subsections. To specify their order explicitly in the gallery we
import <a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.ExplicitOrder" title="sphinx_gallery.sorting.ExplicitOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.ExplicitOrder</span></code></a> and initialize it with
the list of all subfolders with their paths relative to <cite>conf.py</cite> in the
order you prefer them to appear. Keep in mind that we use a single sort key
for all the galleries that are built, thus we include the prefix of each
gallery in the corresponding subsection folders. One does not define a
sortkey per gallery. You can use Linux paths, and if your documentation is
built in a Windows system, paths will be transformed to work accordingly,
the converse does not hold.</p>
<p>If you so desire you can implement your own sorting key. It will be
provided the relative paths to <cite>conf.py</cite> of each sub gallery folder.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you create your own class for <code class="docutils literal notranslate"><span class="pre">'subsection_order'</span></code>, ensure
that the <code class="docutils literal notranslate"><span class="pre">__str__</span></code> of your class is stable across runs.
Sphinx determines if the build environment has changed
(and thus if <em>all</em> documents should be rewritten)
by examining the config values using
<code class="docutils literal notranslate"><span class="pre">md5(str(obj).encode()).hexdigest()</span></code> in
<code class="docutils literal notranslate"><span class="pre">sphinx/builders/html.py</span></code>. Default class instances
in Python have their memory address in their <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> which
will in general change for each build. For <code class="docutils literal notranslate"><span class="pre">ExplicitOrder</span></code>
for example, this is fixed via:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_list</span><span class="p">)</span>
</pre></div>
</div>
<p>Thus the files are only all rebuilt if the specified ordered list
is changed.</p>
</div>
</div>
<div class="section" id="sorting-gallery-examples">
<span id="within-gallery-order"></span><h2>Sorting gallery examples<a class="headerlink" href="#sorting-gallery-examples" title="Permalink to this headline">¶</a></h2>
<p>Within a given gallery (sub)section, the example files are ordered by
using the standard <a class="reference external" href="https://docs.python.org/3/library/functions.html#sorted" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sorted()</span></code></a> function with the <code class="docutils literal notranslate"><span class="pre">key</span></code> argument by default
set to
<a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.NumberOfCodeLinesSortKey" title="sphinx_gallery.sorting.NumberOfCodeLinesSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumberOfCodeLinesSortKey(src_dir)</span></code></a>,
which sorts the files based on the number of code lines:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sphinx_gallery.sorting</span> <span class="kn">import</span> <span class="n">NumberOfCodeLinesSortKey</span>
<span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;within_subsection_order&#39;</span><span class="p">:</span> <span class="n">NumberOfCodeLinesSortKey</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In addition, multiple convenience classes are provided for use with
<code class="docutils literal notranslate"><span class="pre">within_subsection_order</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.NumberOfCodeLinesSortKey" title="sphinx_gallery.sorting.NumberOfCodeLinesSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.NumberOfCodeLinesSortKey</span></code></a> (default) to sort by
the number of code lines.</p></li>
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FileSizeSortKey" title="sphinx_gallery.sorting.FileSizeSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.FileSizeSortKey</span></code></a> to sort by file size.</p></li>
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FileNameSortKey" title="sphinx_gallery.sorting.FileNameSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.FileNameSortKey</span></code></a> to sort by file name.</p></li>
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.ExampleTitleSortKey" title="sphinx_gallery.sorting.ExampleTitleSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.ExampleTitleSortKey</span></code></a> to sort by example title.</p></li>
</ul>
</div>
<div class="section" id="add-intersphinx-links-to-your-examples">
<span id="link-to-documentation"></span><h2>Add intersphinx links to your examples<a class="headerlink" href="#add-intersphinx-links-to-your-examples" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery enables you to add hyperlinks in your example scripts so that
you can link the used functions to their matching online documentation. As such
code snippets within the gallery appear like this</p>
<div class="highlight-python"><div class="highlight"><pre>
<span class="n">y</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.sin.html#numpy.sin"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div><p>Have a look at this in full action
in our example <a class="reference internal" href="auto_examples/plot_0_sin.html#sphx-glr-auto-examples-plot-0-sin-py"><span class="std std-ref">Introductory example - Plotting sin</span></a>.</p>
<p>To make this work in your documentation you need to include to the configuration
dictionary within your Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reference_url&#39;</span><span class="p">:</span> <span class="p">{</span>
         <span class="c1"># The module you locally document uses None</span>
        <span class="s1">&#39;sphinx_gallery&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To link to external modules, if you use the Sphinx extension
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#module-sphinx.ext.intersphinx" title="(in Sphinx v4.0.0+)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sphinx.ext.intersphinx</span></code></a>, no additional changes are necessary,
as the <code class="docutils literal notranslate"><span class="pre">intersphinx</span></code> inventory will automatically be used.
If you do not use <code class="docutils literal notranslate"><span class="pre">intersphinx</span></code>, then you should add entries that
point to the directory containing <code class="docutils literal notranslate"><span class="pre">searchindex.js</span></code>, such as
<code class="docutils literal notranslate"><span class="pre">'matplotlib':</span> <span class="pre">'https://matplotlib.org'</span></code>.</p>
</div>
<div class="section" id="add-mini-galleries-for-api-documentation">
<span id="references-to-examples"></span><h2>Add mini-galleries for API documentation<a class="headerlink" href="#add-mini-galleries-for-api-documentation" title="Permalink to this headline">¶</a></h2>
<p>When documenting a given function/class, Sphinx-Gallery enables you to link to
any examples that either:</p>
<ol class="arabic simple">
<li><p>Use the function/instantiate the class in the code.</p></li>
<li><p>Refer to that function/class using sphinx markup <code class="docutils literal notranslate"><span class="pre">:func:</span></code>/<code class="docutils literal notranslate"><span class="pre">:class:</span></code>
in a documentation block.</p></li>
</ol>
<p>The former is useful for auto-documenting functions that are used and classes
that are explicitly instantiated. The latter is useful for classes that are
typically implicitly returned rather than explicitly instantiated (e.g.,
<a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> which is most often instantiated only indirectly
within function calls).</p>
<p>For example, we can embed a small gallery of all examples that use or
refer to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.exp.html#numpy.exp" title="(in NumPy v1.20)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.exp</span></code></a>, which looks like this:</p>
<div class="section" id="examples-using-numpy-exp">
<h3>Examples using <code class="docutils literal notranslate"><span class="pre">numpy.exp</span></code><a class="headerlink" href="#examples-using-numpy-exp" title="Permalink to this headline">¶</a></h3>
<div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to import a local module and how images are stacked when two plot..."><div class="figure align-default" id="id8">
<img alt="Plotting the exponential function" src="_images/sphx_glr_plot_1_exp_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="auto_examples/plot_1_exp.html#sphx-glr-auto-examples-plot-1-exp-py"><span class="std std-ref">Plotting the exponential function</span></a></span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to choose the figure that is displayed as the thumbnail, if the e..."><div class="figure align-default" id="id9">
<img alt="Choosing the thumbnail figure" src="_images/sphx_glr_plot_4_choose_thumbnail_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="auto_examples/plot_4_choose_thumbnail.html#sphx-glr-auto-examples-plot-4-choose-thumbnail-py"><span class="std std-ref">Choosing the thumbnail figure</span></a></span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This demonstrates how Sphinx-Gallery identifies function names to figure out which functions ar..."><div class="figure align-default" id="id10">
<img alt="Identifying function names in a script" src="_images/sphx_glr_plot_6_function_identifier_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="auto_examples/plot_6_function_identifier.html#sphx-glr-auto-examples-plot-6-function-identifier-py"><span class="std std-ref">Identifying function names in a script</span></a></span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
</div><div class="sphx-glr-clear"></div><p>For such behavior to be available, you have to activate it in
your Sphinx-Gallery configuration <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file with:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="c1"># directory where function/class granular galleries are stored</span>
    <span class="s1">&#39;backreferences_dir&#39;</span>  <span class="p">:</span> <span class="s1">&#39;gen_modules/backreferences&#39;</span><span class="p">,</span>

    <span class="c1"># Modules for which function/class level galleries are created. In</span>
    <span class="c1"># this case sphinx_gallery and numpy in a tuple of strings.</span>
    <span class="s1">&#39;doc_module&#39;</span>          <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;sphinx_gallery&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)}</span>
</pre></div>
</div>
<p>The path you specify in <code class="docutils literal notranslate"><span class="pre">backreferences_dir</span></code> (here we choose
<code class="docutils literal notranslate"><span class="pre">gen_modules/backreferences</span></code>) will be populated with
ReStructuredText files. Each .rst file will contain a reduced version of the
gallery specific to every function/class that is used across all the examples
and belonging to the modules listed in <code class="docutils literal notranslate"><span class="pre">doc_module</span></code>.
<code class="docutils literal notranslate"><span class="pre">backreferences_dir</span></code> should be a string or <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> object that is
<strong>relative</strong> to the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file, or <code class="docutils literal notranslate"><span class="pre">None</span></code>. It is <code class="docutils literal notranslate"><span class="pre">None</span></code> by default.</p>
<p>Within your sphinx documentation <code class="docutils literal notranslate"><span class="pre">.rst</span></code> files, you can use easily
add this reduced version of the Gallery. For example, the rst below adds
the reduced version of the Gallery for <code class="docutils literal notranslate"><span class="pre">numpy.exp</span></code>, which includes all
examples that use the specific function <code class="docutils literal notranslate"><span class="pre">numpy.exp</span></code>:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">minigallery</span><span class="p">::</span> numpy.exp
    <span class="nc">:add-heading:</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">add-heading</span></code> option adds a heading for the mini-gallery, which will be a
default generated message if no string is provided as an argument.  The example
mini-gallery shown above uses the default heading.  The level of the heading
defaults to <code class="docutils literal notranslate"><span class="pre">^</span></code>, but can be changed using the <code class="docutils literal notranslate"><span class="pre">heading-level</span></code> option, which
accepts a single character (e.g., <code class="docutils literal notranslate"><span class="pre">-</span></code>).</p>
<p>You can also list multiple items, separated by spaces, which will merge all
examples into a single mini-gallery, e.g.:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">minigallery</span><span class="p">::</span> numpy.exp numpy.sin
    <span class="nc">:add-heading:</span> Mini-gallery using <span class="s">``numpy.exp``</span> or <span class="s">``numpy.sin``</span>
    <span class="nc">:heading-level:</span> -
</pre></div>
</div>
<p>For such a mini-gallery, specifying a custom heading message is recommended
because the default message is vague: “Examples of one of multiple objects”.</p>
</div>
<div class="section" id="auto-documenting-your-api-with-links-to-examples">
<h3>Auto-documenting your API with links to examples<a class="headerlink" href="#auto-documenting-your-api-with-links-to-examples" title="Permalink to this headline">¶</a></h3>
<p>The previous feature can be automated for all your modules combining
it with the standard sphinx extensions <a class="reference external" href="http://sphinx-doc.org/ext/autodoc.html">autodoc</a> and <a class="reference external" href="http://sphinx-doc.org/ext/autosummary.html">autosummary</a>. First enable them in your
<code class="docutils literal notranslate"><span class="pre">conf.py</span></code> extensions list:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sphinx_gallery</span>
<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span>
    <span class="s1">&#39;sphinx.ext.autodoc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.ext.autosummary&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx_gallery.gen_gallery&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="c1"># generate autosummary even if no references</span>
<span class="n">autosummary_generate</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p><a class="reference external" href="http://sphinx-doc.org/ext/autodoc.html">autodoc</a> and <a class="reference external" href="http://sphinx-doc.org/ext/autosummary.html">autosummary</a> are very powerful
extensions, please read about them. In this example we’ll explain how
the <a class="reference internal" href="reference.html#sphx-glr-api-reference"><span class="std std-ref">Sphinx-Gallery API Reference</span></a> is automatically generated. The
documentation is done at the module level. We first start with the
<code class="docutils literal notranslate"><span class="pre">reference.rst</span></code> file</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="nt">_sphx_glr_api_reference:</span>

<span class="gh">Sphinx-Gallery API Reference</span>
<span class="gh">============================</span>

The complete Sphinx-Gallery project is automatically documented for
every module.

<span class="p">..</span> <span class="ow">currentmodule</span><span class="p">::</span> sphinx_gallery

<span class="p">..</span> <span class="ow">automodule</span><span class="p">::</span> sphinx_gallery
   <span class="nc">:no-members:</span>
   <span class="nc">:no-inherited-members:</span>

<span class="na">:py:mod:</span><span class="nv">`sphinx_gallery`</span>:

<span class="p">..</span> <span class="ow">autosummary</span><span class="p">::</span>
   <span class="nc">:toctree:</span> gen_modules/
   <span class="nc">:template:</span> module.rst

   gen_gallery
   backreferences
   gen_rst
   scrapers
   py_source_parser
   docs_resolv
   notebook
   downloads
   sorting
   binder
   directives

<span class="p">..</span> <span class="ow">currentmodule</span><span class="p">::</span> sphinx_gallery.utils

<span class="p">..</span> <span class="ow">automodule</span><span class="p">::</span> sphinx_gallery.utils
   <span class="nc">:no-members:</span>
   <span class="nc">:no-inherited-members:</span>

<span class="na">:py:mod:</span><span class="nv">`sphinx_gallery.utils`</span>:

<span class="p">..</span> <span class="ow">autosummary</span><span class="p">::</span>
   <span class="nc">:toctree:</span> gen_modules/
   <span class="nc">:template:</span> module.rst

   optipng
</pre></div>
</div>
<p>The important directives are <code class="docutils literal notranslate"><span class="pre">currentmodule</span></code> where we specify which
module we are documenting, for our purpose is <code class="docutils literal notranslate"><span class="pre">sphinx_gallery</span></code>. The
<code class="docutils literal notranslate"><span class="pre">autosummary</span></code> directive is responsible for generating the <code class="docutils literal notranslate"><span class="pre">rst</span></code>
files documenting each module.  <code class="docutils literal notranslate"><span class="pre">autosummary</span></code> takes the option
<em>toctree</em> which is where the <code class="docutils literal notranslate"><span class="pre">rst</span></code> files are saved and <em>template</em>
which is the file that describes how the module <code class="docutils literal notranslate"><span class="pre">rst</span></code> documentation
file is to be constructed, finally we write the modules we wish to
document, in this case all modules of Sphinx-Gallery.</p>
<p>The template file <code class="docutils literal notranslate"><span class="pre">module.rst</span></code> for the <code class="docutils literal notranslate"><span class="pre">autosummary</span></code> directive has
to be saved in the path <code class="docutils literal notranslate"><span class="pre">_templates/module.rst</span></code>. We present our
configuration in the following block. The most relevant part is the
loop defined between lines <strong>12-21</strong> that parses all the functions/classes
of the module. There we have used the <code class="docutils literal notranslate"><span class="pre">minigallery</span></code> directive introduced in
the previous section.</p>
<p>We also add a cross referencing label (on line 16) before including the
examples mini-gallery. This enables you to reference the mini-gallery for
all functions/classes of the module using
<code class="docutils literal notranslate"><span class="pre">:ref:`sphx_glr_backref_&lt;fun/class&gt;`</span></code>, where ‘&lt;fun/class&gt;’ is the full path
to the function/class using dot notation (e.g.,
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery.backreferences.identify_names</span></code>). For example, see:
<a class="reference internal" href="gen_modules/sphinx_gallery.backreferences.html#sphx-glr-backref-sphinx-gallery-backreferences-identify-names"><span class="std std-ref">Examples using sphinx_gallery.backreferences.identify_names</span></a>.</p>
<div class="highlight-rst notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span>{{ fullname }}
{{ underline }}

<span class="p">..</span> <span class="ow">automodule</span><span class="p">::</span> {{ fullname }}

   {% block functions %}
   {% if functions %}

   Functions
   ---------

<span class="hll">   {% for item in functions %}
</span><span class="hll">
</span><span class="hll"><span class="p">   ..</span> <span class="ow">autofunction</span><span class="p">::</span> {{ item }}
</span><span class="hll">
</span><span class="hll"><span class="p">   ..</span> <span class="nt">_sphx_glr_backref_{{fullname}}.{{item}}:</span>
</span><span class="hll">
</span><span class="hll"><span class="p">   ..</span> <span class="ow">minigallery</span><span class="p">::</span> {{fullname}}.{{item}}
</span><span class="hll">       <span class="nc">:add-heading:</span>
</span><span class="hll">
</span><span class="hll">   {%- endfor %}
</span>   {% endif %}
   {% endblock %}

   {% block classes %}
   {% if classes %}

   Classes
   -------

<span class="hll">   {% for item in classes %}
</span><span class="hll"><span class="p">   ..</span> <span class="ow">autoclass</span><span class="p">::</span> {{ item }}
</span><span class="hll">      <span class="nc">:members:</span>
</span><span class="hll">
</span><span class="hll"><span class="p">   ..</span> <span class="nt">_sphx_glr_backref_{{fullname}}.{{item}}:</span>
</span><span class="hll">
</span><span class="hll"><span class="p">   ..</span> <span class="ow">minigallery</span><span class="p">::</span> {{fullname}}.{{item}}
</span><span class="hll">       <span class="nc">:add-heading:</span>
</span>
   {%- endfor %}
   {% endif %}
   {% endblock %}

   {% block exceptions %}
   {% if exceptions %}

   Exceptions
   ----------

<span class="p">   ..</span> <span class="ow">autosummary</span><span class="p">::</span>
   {% for item in exceptions %}
      {{ item }}
   {%- endfor %}
   {% endif %}
   {% endblock %}
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="toggling-global-variable-inspection">
<h3>Toggling global variable inspection<a class="headerlink" href="#toggling-global-variable-inspection" title="Permalink to this headline">¶</a></h3>
<p>By default, Sphinx-Gallery will inspect global variables (and code objects)
at the end of each code block to try to find classes of variables and
method calls. It also tries to find methods called on classes.
For example, this code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
</pre></div>
</div>
<p>should end up with the following links (assuming intersphinx is set up
properly):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lst</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v3.3.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plt.subplots</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">fig</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ax</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="(in Matplotlib v3.3.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ax.plot</span></code></a></p></li>
</ul>
<p>However, this feature might not work properly in all instances.
Moreover, if variable names get reused in the same script to refer to
different classes, it will break.</p>
<p>To disable this global variable introspection, you can use the configuration
key:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;inspect_global_variables&#39;</span>  <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="stylizing-code-links-using-css">
<h3>Stylizing code links using CSS<a class="headerlink" href="#stylizing-code-links-using-css" title="Permalink to this headline">¶</a></h3>
<p>Each link in the code blocks will be decorated with two or three CSS classes.</p>
<ol class="arabic">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-module-*</span></code></dt><dd><p>CSS class named after the module where the object is documented.
<code class="docutils literal notranslate"><span class="pre">*</span></code> represents the module, e.g.,
<code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-module-matplotlib-figure</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-type-*</span></code></dt><dd><p>CSS class named after the type of the object, where <code class="docutils literal notranslate"><span class="pre">*</span></code> represents
the object type. This is a sanitized intersphinx type, e.g., a
<code class="docutils literal notranslate"><span class="pre">py:class</span></code> will have the CSS class <code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-type-py-class</span></code>.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-instance</span></code></dt><dd><p>The third ‘optional’ class that is added only if the object is an
instance of a class (rather than, e.g., a class itself, method, or
function). By default, Sphinx-Gallery adds the following CSS in
<code class="docutils literal notranslate"><span class="pre">gallery.css</span></code>:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="nt">a</span><span class="p">.</span><span class="nc">sphx-glr-backref-instance</span> <span class="p">{</span>
    <span class="k">text-decoration</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is done to reduce the visual impact of instance linking
in example code. This means that for the following code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code>, an instance of a class, will have the
<code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-instance</span></code> CSS class, and will not be decorated.
<code class="docutils literal notranslate"><span class="pre">Figure</span></code> however, is a class, so will not have the
<code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-instance</span></code> CSS class, and will thus be decorated the
standard way for links in the given parent styles.</p>
</dd>
</dl>
</li>
</ol>
<p>These three CSS classes are meant to give fine-grained control over how
different links are decorated. For example, using CSS selectors you could
choose to avoid highlighting any <code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-*</span></code> links except for ones
that you whitelist (e.g., those from your own module). For example, the
following css prevents any module except for matplotlib from being decorated:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="nt">a</span><span class="o">[</span><span class="nt">class</span><span class="o">^=</span><span class="s2">&quot;sphx-glr-backref-module-&quot;</span><span class="o">]</span> <span class="p">{</span>
    <span class="k">text-decoration</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">a</span><span class="o">[</span><span class="nt">class</span><span class="o">^=</span><span class="s2">&quot;sphx-glr-backref-module-matplotlib&quot;</span><span class="o">]</span> <span class="p">{</span>
    <span class="k">text-decoration</span><span class="p">:</span> <span class="kc">underline</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are likely elements other than <code class="docutils literal notranslate"><span class="pre">text-decoration</span></code> that might be worth
setting, as well.</p>
</div>
</div>
<div class="section" id="using-a-custom-default-thumbnail">
<span id="custom-default-thumb"></span><h2>Using a custom default thumbnail<a class="headerlink" href="#using-a-custom-default-thumbnail" title="Permalink to this headline">¶</a></h2>
<p>In case you want to use your own image for the thumbnail of examples that do
not generate any plot, you can specify it by editing your Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>
file. You need to add to the configuration dictionary a key called
<cite>default_thumb_file</cite>. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;default_thumb_file&#39;</span><span class="p">:</span> <span class="s1">&#39;path/to/thumb/file.png&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-line-numbers-to-examples">
<span id="adding-line-numbers"></span><h2>Adding line numbers to examples<a class="headerlink" href="#adding-line-numbers-to-examples" title="Permalink to this headline">¶</a></h2>
<p>Line numbers can be displayed in listings by adding the global <code class="docutils literal notranslate"><span class="pre">line_numbers</span></code>
setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;line_numbers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or by adding a comment to the example script, which overrides any global
setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_line_numbers = True</span>
</pre></div>
</div>
</div>
<div class="section" id="removing-config-comments">
<span id="id5"></span><h2>Removing config comments<a class="headerlink" href="#removing-config-comments" title="Permalink to this headline">¶</a></h2>
<p>Some configurations can be done on a file-by-file basis by adding a special
comment with the pattern <code class="samp docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_</span><em><span class="pre">config</span></em> <span class="pre">=</span> <em><span class="pre">value</span></em></code> to the
example source files. By default, the source files are parsed as is and thus
the comment will appear in the example.</p>
<p>To remove the comment from the rendered example set the option:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;remove_config_comments&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This only removes configuration comments from code blocks, not from text
blocks. However, note that technically, configuration comments will work when
put in either code blocks or text blocks.</p>
</div>
<div class="section" id="add-your-own-first-and-last-notebook-cell">
<span id="own-notebook-cell"></span><h2>Add your own first and last notebook cell<a class="headerlink" href="#add-your-own-first-and-last-notebook-cell" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery allows you to add your own first and/or last cell to <em>every</em>
generated notebook. Adding a first cell can be useful for including code that
is required to run properly in the notebook, but not in a <code class="docutils literal notranslate"><span class="pre">.py</span></code> file. By
default, the following first cell is added to each notebook:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<p>Adding a last cell can be useful for performing a desired action such as
reporting on the user’s environment. By default no last cell is added.</p>
<p>You can choose whatever text you like by modifying the <code class="docutils literal notranslate"><span class="pre">first_notebook_cell</span></code>
and <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code> configuration parameters. For example, the gallery
of this documentation adds the following first cell:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="c1"># This cell is added by sphinx-gallery</span>
<span class="c1"># It can be customized to whatever you like</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<p>Which is achieved by the following configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;first_notebook_cell&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;# This cell is added by sphinx-gallery</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;# It can be customized to whatever you like</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;%matplotlib inline&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A last cell may be added similarly by setting the <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code>
parameter:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;first_notebook_cell&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;# This cell is added by sphinx-gallery</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;# It can be customized to whatever you like</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;%matplotlib inline&quot;</span><span class="p">),</span>
    <span class="s1">&#39;last_notebook_cell&#39;</span><span class="p">:</span> <span class="s2">&quot;# This is the last cell&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">first_notebook_cell</span></code> or <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then no extra first or last cell will be added to the notebook.</p>
</div>
<div class="section" id="adding-images-to-notebooks">
<span id="notebook-images"></span><h2>Adding images to notebooks<a class="headerlink" href="#adding-images-to-notebooks" title="Permalink to this headline">¶</a></h2>
<p>When notebooks are produced, by default (<code class="docutils literal notranslate"><span class="pre">notebook_images</span> <span class="pre">=</span> <span class="pre">False</span></code>) image
paths from the <cite>image</cite> directive in rST documentation blocks (not images
generated fom code) are included in markdown using their original paths. This
includes paths to images expected to be present on the local filesystem which
is unlikely to be the case for those downloading the notebook.</p>
<p>By setting <code class="docutils literal notranslate"><span class="pre">notebook_images</span> <span class="pre">=</span> <span class="pre">True</span></code>, images will be embedded in the generated
notebooks via Base64-encoded <a class="reference external" href="https://en.wikipedia.org/wiki/Data_URI_scheme">data URIs</a>.
As inclusion of images via data URIs can significantly increase size of the
notebook, it’s suggested this only be used when small images are used throughout
galleries.</p>
<p>An alternative is to instead provide a prefix string that’ll be used for images
e.g. the root URL of where your documentation is hosted. So for example the
following configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;examples_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples&#39;</span><span class="p">],</span>
    <span class="s1">&#39;gallery_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto_examples&#39;</span><span class="p">],</span>
    <span class="o">...</span>
    <span class="s1">&#39;notebook_images&#39;</span><span class="p">:</span> <span class="s1">&#39;https://project.example.com/en/latest/&#39;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>with an example <cite>image</cite> directive in an rST documentation block being:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">image</span><span class="p">::</span> ../_static/example.jpg
    <span class="nc">:alt:</span> An example image
</pre></div>
</div>
<p>The image will be added to the generated notebook pointing to the source URL
<code class="docutils literal notranslate"><span class="pre">https://project.example.com/en/latest/_static/example.jpg</span></code>. Note the image
path in the rST examples above is a relative path, therefore the URL doesn’t
contain <code class="docutils literal notranslate"><span class="pre">auto_examples</span></code> as <code class="docutils literal notranslate"><span class="pre">../</span></code> moved up a directory to the documentation
source directory. Both relative and absolute (from source directory) paths are
supported; so in the example above <code class="docutils literal notranslate"><span class="pre">/_static/example.jpg</span></code> would have resulted
in the same URL being produced.</p>
<p>Note that the prefix is applied directly, so a trailing <code class="docutils literal notranslate"><span class="pre">/</span></code> should be
included in the prefix if it’s required.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If building multiple versions of your documentation on a hosted service and
using prefix, consider using <a class="reference external" href="https://www.sphinx-doc.org/en/master/man/sphinx-build.html#cmdoption-sphinx-build-D">sphinx build -D</a>
command line option to ensure links point to the correct version. For
example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sphinx-build <span class="se">\</span>
    -b html <span class="se">\</span>
    -D sphinx_gallery_conf.notebook_images<span class="o">=</span><span class="s2">&quot;https://project.example.com/docs/</span><span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span><span class="s2">/&quot;</span> <span class="se">\</span>
    source_dir build_dir
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-pypandoc-to-convert-rst-to-markdown">
<span id="use-pypandoc"></span><h2>Using pypandoc to convert rST to markdown<a class="headerlink" href="#using-pypandoc-to-convert-rst-to-markdown" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery can use <a class="reference external" href="https://github.com/bebraw/pypandoc">pypandoc</a>
(if installed) to convert rST text blocks to markdown for the iPython
notebooks (<code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> files) generated for each example. These are made
available for download, along with the raw <code class="docutils literal notranslate"><span class="pre">.py</span></code> version, at the bottom
of each example.</p>
<p>The Sphinx-Gallery rST to markdown converter has limited support for more
complex rST syntax. If your examples have more complex rST, <code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> may
produce better results. By default, the ‘pypandoc’ configuration is set to
<code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> is not used.</p>
<p>To use <code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> you can set:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;pypandoc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can also use pandoc options by setting the <code class="docutils literal notranslate"><span class="pre">pypandoc.convert_text()</span></code>
parameters <code class="docutils literal notranslate"><span class="pre">extra_args</span></code> and <code class="docutils literal notranslate"><span class="pre">filters</span></code>. To use these parameters, set the
‘pypandoc’ configuration to be a dictionary of keyword argument(s):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;pypandoc&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;extra_args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;--mathjax&#39;</span><span class="p">,],</span>
                 <span class="s1">&#39;filters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;pandoc-citeproc&#39;</span><span class="p">,],</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Certain pandoc options may result in undesirable effects. Use with caution.</p>
</div>
</div>
<div class="section" id="using-junit-xml-files">
<span id="junit-xml"></span><h2>Using JUnit XML files<a class="headerlink" href="#using-junit-xml-files" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery can create a JUnit XML file of your example run times,
successes, and failures. To create a file named e.g. <code class="docutils literal notranslate"><span class="pre">junit-result.xml</span></code>
in the <code class="docutils literal notranslate"><span class="pre">/build</span></code> output directory, set the configuration key (path is relative
to the HTML output directory):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;junit&#39;</span><span class="p">:</span> <span class="s1">&#39;../test-results/sphinx-gallery/junit.xml&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By default, JUnit XML file generation is disabled (by setting <code class="docutils literal notranslate"><span class="pre">'junit':</span> <span class="pre">''</span></code>).
JUnit XML files are useful for example on CircleCI builds, where you can add
a line like this to get a summary of your example run times in the CircleCI GUI
(which will parse the file path
<code class="docutils literal notranslate"><span class="pre">doc/_build/test-results/sphinx-gallery/junit.xml</span></code> and infer the tests
came from <code class="docutils literal notranslate"><span class="pre">sphinx-gallery</span></code> based on the nested subdirectory name):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">store_test_results</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">doc/_build/test-results</span>
<span class="p p-Indicator">-</span> <span class="nt">store_artifacts</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">doc/_build/test-results</span>
</pre></div>
</div>
<p>For more information on CircleCI integration, peruse the related
<a class="reference external" href="https://circleci.com/docs/2.0/collect-test-data/#metadata-collection-in-custom-test-steps">CircleCI doc</a>
and <a class="reference external" href="https://circleci.com/blog/how-to-output-junit-tests-through-circleci-2-0-for-expanded-insights/">blog post</a>.</p>
</div>
<div class="section" id="setting-log-level">
<span id="log-level"></span><h2>Setting log level<a class="headerlink" href="#setting-log-level" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery logs output at several stages. Warnings can be generated for
code that requires case sensitivity (e.g., <code class="docutils literal notranslate"><span class="pre">plt.subplot</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.Subplot</span></code>)
when building docs on a filesystem that does not support case sensitive
naming (e.g., Windows). In this case, by default a <code class="docutils literal notranslate"><span class="pre">logger.warning</span></code> is
emitted, which will lead to a build failure when buidling with <code class="docutils literal notranslate"><span class="pre">-W</span></code>.
The log level can be set with:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;log_level&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;backreference_missing&#39;</span><span class="p">:</span> <span class="s1">&#39;warning&#39;</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The only valid key currently is <code class="docutils literal notranslate"><span class="pre">backreference_missing</span></code>.
The valid values are <code class="docutils literal notranslate"><span class="pre">'debug'</span></code>, <code class="docutils literal notranslate"><span class="pre">'info'</span></code>, <code class="docutils literal notranslate"><span class="pre">'warning'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'error'</span></code>.</p>
</div>
<div class="section" id="disabling-download-button-of-all-scripts">
<span id="disable-all-scripts-download"></span><h2>Disabling download button of all scripts<a class="headerlink" href="#disabling-download-button-of-all-scripts" title="Permalink to this headline">¶</a></h2>
<p>By default Sphinx-Gallery collects all python scripts and all Jupyter
notebooks from each gallery into zip files which are made available for
download at the bottom of each gallery. To disable this behavior add to the
configuration dictionary in your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;download_all_examples&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="choosing-the-thumbnail-image">
<span id="choosing-thumbnail"></span><h2>Choosing the thumbnail image<a class="headerlink" href="#choosing-the-thumbnail-image" title="Permalink to this headline">¶</a></h2>
<p>For examples that generate multiple figures, the default behavior will use
the first figure created in each as the thumbnail image displayed in the
gallery. To change the thumbnail image to a figure generated later in
an example script, add a comment to the example script to specify the
number of the figure you would like to use as the thumbnail. For example,
to use the 2nd figure created as the thumbnail:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<p>The default behavior is <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_thumbnail_number</span> <span class="pre">=</span> <span class="pre">1</span></code>. See
<a class="reference internal" href="auto_examples/plot_4_choose_thumbnail.html#sphx-glr-auto-examples-plot-4-choose-thumbnail-py"><span class="std std-ref">Choosing the thumbnail figure</span></a> for an example
of this functionality.</p>
</div>
<div class="section" id="providing-an-image-for-the-thumbnail-image">
<span id="providing-thumbnail"></span><h2>Providing an image for the thumbnail image<a class="headerlink" href="#providing-an-image-for-the-thumbnail-image" title="Permalink to this headline">¶</a></h2>
<p>An arbitrary image can be used to serve as the thumbnail image for an example.
To specify an image to serve as the thumbnail, add a comment to the example
script specifying the path to the desired image. The path to the image should
be relative to the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file and the comment should be somewhere
below the docstring (ideally in a code block, see
<a class="reference internal" href="#removing-config-comments"><span class="std std-ref">Removing config comments</span></a>).</p>
<p>For example, the following defines that the image <code class="docutils literal notranslate"><span class="pre">demo.png</span></code> in the folder
<code class="docutils literal notranslate"><span class="pre">_static/</span></code> should be used to create the thumbnail:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_path = &#39;_static/demo.png&#39;</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_thumbnail_number</span></code> overrules
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_thumbnail_path</span></code>. See
<a class="reference internal" href="auto_examples/plot_4b_provide_thumbnail.html#sphx-glr-auto-examples-plot-4b-provide-thumbnail-py"><span class="std std-ref">Providing a figure for the thumbnail image</span></a> for an example of
this functionality.</p>
</div>
<div class="section" id="generate-binder-links-for-gallery-notebooks-experimental">
<span id="binder-links"></span><h2>Generate Binder links for gallery notebooks (experimental)<a class="headerlink" href="#generate-binder-links-for-gallery-notebooks-experimental" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery automatically generates Jupyter notebooks for any
examples built with the gallery. <a class="reference external" href="https://mybinder.org">Binder</a> makes it
possible to create interactive GitHub repositories that connect to cloud resources.</p>
<p>If you host your documentation on a GitHub repository, it is possible to
auto-generate a Binder link for each notebook. Clicking this link will
take users to a live version of the Jupyter notebook where they may
run the code interactively. For more information see the <a class="reference external" href="https://docs.mybinder.org">Binder documentation</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Binder is still beta technology, so there may be instability in the
experience of users who click Binder links.</p>
</div>
<p>In order to enable Binder links with Sphinx-Gallery, you must specify
a few pieces of information in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>. These are given as a nested
dictionary following the pattern below:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">...</span>
  <span class="s1">&#39;binder&#39;</span><span class="p">:</span> <span class="p">{</span>
     <span class="c1"># Required keys</span>
     <span class="s1">&#39;org&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;github_org&gt;&#39;</span><span class="p">,</span>
     <span class="s1">&#39;repo&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;github_repo&gt;&#39;</span><span class="p">,</span>
     <span class="s1">&#39;branch&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;github_branch&gt;&#39;</span><span class="p">,</span>  <span class="c1"># Can be any branch, tag, or commit hash. Use a branch that hosts your docs.</span>
     <span class="s1">&#39;binderhub_url&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;binder_url&gt;&#39;</span><span class="p">,</span>  <span class="c1"># Any URL of a binderhub deployment. Must be full URL (e.g. https://mybinder.org).</span>
     <span class="s1">&#39;dependencies&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;list_of_paths_to_dependency_files&gt;&#39;</span><span class="p">,</span>
     <span class="c1"># Optional keys</span>
     <span class="s1">&#39;filepath_prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;prefix&gt;&#39;</span> <span class="c1"># A prefix to prepend to any filepaths in Binder links.</span>
     <span class="s1">&#39;notebooks_dir&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;notebooks-directory-name&gt;&#39;</span> <span class="c1"># Jupyter notebooks for Binder will be copied to this directory (relative to built documentation root).</span>
     <span class="s1">&#39;use_jupyter_lab&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">bool</span><span class="o">&gt;</span> <span class="c1"># Whether Binder links should start Jupyter Lab instead of the Jupyter Notebook interface.</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If a Sphinx-Gallery configuration for Binder is discovered, the following extra things will happen:</p>
<ol class="arabic">
<li><p>The dependency files specified in <code class="docutils literal notranslate"><span class="pre">dependencies</span></code> will be copied to a <code class="docutils literal notranslate"><span class="pre">binder/</span></code> folder in your built documentation.</p></li>
<li><p>The built Jupyter Notebooks from the documentation will be copied to a folder called <code class="docutils literal notranslate"><span class="pre">&lt;notebooks_dir/&gt;</span></code> at the root of
your built documentation (they will follow the same folder hierarchy within the notebooks directory folder.</p></li>
<li><p>The rST output of each Sphinx-Gallery example will now have a <code class="docutils literal notranslate"><span class="pre">launch</span> <span class="pre">binder</span></code> button in it.</p></li>
<li><p>That button will point to a binder link with the following structure</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">binderhub_url</span><span class="p">&gt;</span>/v2/gh/<span class="p">&lt;</span><span class="nt">org</span><span class="p">&gt;</span>/<span class="p">&lt;</span><span class="nt">repo</span><span class="p">&gt;</span>/<span class="p">&lt;</span><span class="nt">ref</span><span class="p">&gt;</span>?filepath=<span class="p">&lt;</span><span class="nt">filepath_prefix</span><span class="p">&gt;</span>/<span class="p">&lt;</span><span class="nt">notebooks_dir</span><span class="p">&gt;</span>/path/to/notebook.ipynb
</pre></div>
</div>
</li>
</ol>
<p>Below is a more complete explanation of each field.</p>
<dl class="simple">
<dt>org (type: string)</dt><dd><p>The GitHub organization where your documentation is stored.</p>
</dd>
<dt>repo (type: string)</dt><dd><p>The GitHub repository where your documentation is stored.</p>
</dd>
<dt>ref (type: string)</dt><dd><p>A reference to the version of your repository where your documentation exists.
For example, if your built documentation is stored on a <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch, then this field
should be set to <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code>.</p>
</dd>
<dt>binderhub_url (type: string)</dt><dd><p>The full URL to a BinderHub deployment where you want your examples to run. One
public BinderHub deployment is at <code class="docutils literal notranslate"><span class="pre">https://mybinder.org</span></code>, though if you (and your users) have access to
another, this can be configured with this field.</p>
</dd>
<dt>dependencies (type: list)</dt><dd><p>A list of paths (relative to <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>) to dependency files that Binder uses to infer the environment needed
to run your examples. For example, a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file. These will be copied into a folder
called <code class="docutils literal notranslate"><span class="pre">binder/</span></code> in your built documentation folder. For a list of all the possible dependency files
you can use, see <a class="reference external" href="https://mybinder.readthedocs.io/en/latest/config_files.html#config-files">the Binder configuration documentation</a>.</p>
</dd>
<dt>filepath_prefix (type: string | None, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>A prefix to append to the filepath in the Binder links. You should use this if you will store your built
documentation in a sub-folder of a repository, instead of in the root.</p>
</dd>
<dt>notebooks_dir (type: string, default: <code class="docutils literal notranslate"><span class="pre">notebooks</span></code>)</dt><dd><p>The name of a folder where the built Jupyter notebooks will be copied. This ensures that all the notebooks are
in one place (though they retain their folder hierarchy) in case you’d like users to browse multiple notebook examples in one session.</p>
</dd>
<dt>use_jupyter_lab (type: bool, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</dt><dd><p>Whether the default interface activated by the Binder link will be for
Jupyter Lab or the classic Jupyter Notebook interface.</p>
</dd>
</dl>
<p>Each generated Jupyter Notebook will be copied to the folder
specified in <code class="docutils literal notranslate"><span class="pre">notebooks_dir</span></code>. This will be a subfolder of the sphinx output
directory and included with your site build.
Binder links will point to these notebooks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not currently possible to host notebooks generated by
Sphinx-Gallery with readthedocs.org, as RTD does not provide you
with a GitHub repository you could link Binder to. If you’d like to
use readthedocs with Sphinx-Gallery and Binder links, you should
independently build your documentation and host it on a GitHub branch
as well as building it with readthedocs.</p>
</div>
<p>See the Sphinx-Gallery <a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/blob/master/doc/conf.py">Sphinx configuration file</a>
for an example that uses the <a class="reference external" href="http://mybinder.org">public Binder server</a>.</p>
</div>
<div class="section" id="building-without-executing-examples">
<span id="without-execution"></span><h2>Building without executing examples<a class="headerlink" href="#building-without-executing-examples" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery can parse all your examples and build the gallery
without executing any of the scripts. This is just for speed
visualization processes of the gallery and the size it takes your
website to display, or any use you can imagine for it. To achieve this you
need to pass the no plot option in the build process by modifying
your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> with:</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="nf">html-noplot</span><span class="o">:</span>
    <span class="k">$(</span>SPHINXBUILD<span class="k">)</span> -D <span class="nv">plot_gallery</span><span class="o">=</span><span class="m">0</span> -b html <span class="k">$(</span>ALLSPHINXOPTS<span class="k">)</span> <span class="k">$(</span>SOURCEDIR<span class="k">)</span> <span class="k">$(</span>BUILDDIR<span class="k">)</span>/html
    @echo
    @echo <span class="s2">&quot;Build finished. The HTML pages are in </span><span class="k">$(</span>BUILDDIR<span class="k">)</span><span class="s2">/html.&quot;</span>
</pre></div>
</div>
<p>Remember that for <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> white space is significant and the indentation are tabs
and not spaces.</p>
<p>Alternatively, you can add the <code class="docutils literal notranslate"><span class="pre">plot_gallery</span></code> option to the
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code> dictionary inside your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> to have it as
a default:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;plot_gallery&#39;</span><span class="p">:</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The highest precedence is always given to the <cite>-D</cite> flag of the
<code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> command.</p>
</div>
<div class="section" id="compressing-images">
<span id="compress-images"></span><h2>Compressing images<a class="headerlink" href="#compressing-images" title="Permalink to this headline">¶</a></h2>
<p>When writing PNG files (the default scraper format), Sphinx-Gallery can be
configured to use <code class="docutils literal notranslate"><span class="pre">optipng</span></code> to optimize the PNG file sizes. Typically this
yields roughly a 50% reduction in file sizes, thus reducing the loading time
of galleries. However, it can increase build
time. The allowed values are <code class="docutils literal notranslate"><span class="pre">'images'</span></code> and <code class="docutils literal notranslate"><span class="pre">'thumbnails'</span></code>, or a
tuple/list (to optimize both), such as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;compress_images&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnails&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default is <code class="docutils literal notranslate"><span class="pre">()</span></code> (no optimization) and a warning will be emitted if
optimization is requested but <code class="docutils literal notranslate"><span class="pre">optipng</span></code> is not available. You can also pass
additional command-line options (starting with <code class="docutils literal notranslate"><span class="pre">'-'</span></code>), for example to
optimize less but speed up the build time you could do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;compress_images&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnails&#39;</span><span class="p">,</span> <span class="s1">&#39;-o1&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">optipng</span> <span class="pre">--help</span></code> for a complete list of options.</p>
</div>
<div class="section" id="image-scrapers">
<span id="id6"></span><h2>Image scrapers<a class="headerlink" href="#image-scrapers" title="Permalink to this headline">¶</a></h2>
<p>Image scrapers are plugins that allow Sphinx-Gallery to detect images produced
during execution of your examples, and then embed them into documentation.
Scrapers can be activated by appending scraper names to the
<code class="docutils literal notranslate"><span class="pre">'image_scrapers'</span></code> tuple in your Sphinx-Gallery configuration. For example,
to scrape both matplotlib and Mayavi images you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;image_scrapers&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;mayavi&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">'image_scrapers':</span> <span class="pre">('matplotlib',)</span></code> which only scrapes
Matplotlib images. Note that this includes any images produced by packages that
are based on Matplotlib, for example Seaborn or Yellowbrick. If you want
to embed <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.animation.Animation.html#matplotlib.animation.Animation" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.animation.Animation</span></code></a>s as animations rather
than a single static image of the animation figure, you should add:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;matplotlib_animations&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>HTML embedding options can be changed by setting <code class="docutils literal notranslate"><span class="pre">rcParams['animation.html']</span></code>
and related options in your
<a class="reference external" href="https://matplotlib.org/tutorials/introductory/customizing.html#matplotlib-rcparams" title="(in Matplotlib v3.3.3)"><span class="xref std std-ref">matplotlib rcParams</span></a>.
It’s also recommended to ensure that “imagemagick” is available as a
<code class="docutils literal notranslate"><span class="pre">writer</span></code>, which you can check with
<a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.animation.ImageMagickWriter.html#matplotlib.animation.ImageMagickWriter" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.animation.ImageMagickWriter.isAvailable()</span></code></a>.
The FFmpeg writer in some light testing did not work as well for
creating GIF thumbnails for the gallery pages.</p>
<p>The following scrapers are supported:</p>
<ul class="simple">
<li><dl class="simple">
<dt>matplotlib</dt><dd><p>Sphinx-Gallery maintains a scraper for
<a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v3.3.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code></a> figures via the string
<code class="docutils literal notranslate"><span class="pre">'matplotlib'</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Mayavi</dt><dd><p>Sphinx-Gallery maintains a scraper for
<a class="reference external" href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_reference.html#module-mayavi.mlab" title="(in mayavi v4.7.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Mayavi</span></code></a> figures via the string
<code class="docutils literal notranslate"><span class="pre">'mayavi'</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PyVista</dt><dd><p><a class="reference external" href="https://github.com/pyvista/pyvista">PyVista</a> maintains a scraper
(for PyVista &gt;= 0.20.3) enabled by the string <code class="docutils literal notranslate"><span class="pre">'pyvista'</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PyGMT</dt><dd><p>See <a class="reference external" href="https://www.pygmt.org/dev/">their website</a> for more information on
how to integrate with Sphinx-Gallery.</p>
</dd>
</dl>
</li>
</ul>
<p>It is possible to write custom scrapers for images generated by packages
outside of those listed above. This is accomplished
by writing your own Python function to define how to detect and retrieve
images produced by an arbitrary package. For instructions, see
<a class="reference internal" href="advanced.html#custom-scraper"><span class="std std-ref">Write a custom image scraper</span></a>. If you come up with an implementation that would be
useful for general use (e.g., a custom scraper for a plotting library)
feel free to add it to the list above (see discussion
<a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/issues/441#issuecomment-493782430">here</a>)!</p>
</div>
<div class="section" id="resetting-modules">
<span id="reset-modules"></span><h2>Resetting modules<a class="headerlink" href="#resetting-modules" title="Permalink to this headline">¶</a></h2>
<p>Often you wish to “reset” the behavior of your visualization packages in order
to ensure that any changes made to plotting behavior in one example do not
propagate to the other examples.</p>
<p>By default, before each example file executes, Sphinx-Gallery will
reset <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> (by using <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.rcdefaults.html#matplotlib.pyplot.rcdefaults" title="(in Matplotlib v3.3.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.rcdefaults()</span></code></a>) and <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>
(by trying to unload the module from <code class="docutils literal notranslate"><span class="pre">sys.modules</span></code>). This is equivalent to the
following configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reset_modules&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Currently, Sphinx-Gallery natively supports resetting <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and
<code class="docutils literal notranslate"><span class="pre">seaborn</span></code>. However, you can also add your own custom function to
this tuple in order to define resetting behavior for other visualization libraries.</p>
<p>To do so, follow the instructions in <a class="reference internal" href="advanced.html#custom-reset"><span class="std std-ref">Define resetting behavior (e.g., for custom libraries)</span></a>.</p>
</div>
<div class="section" id="dealing-with-failing-gallery-example-scripts">
<h2>Dealing with failing Gallery example scripts<a class="headerlink" href="#dealing-with-failing-gallery-example-scripts" title="Permalink to this headline">¶</a></h2>
<p>As your project evolves some of your example scripts might stop
executing properly. Sphinx-Gallery will assist you in the discovery process
of those bugged examples. The default behavior is to replace the
thumbnail of those examples in the gallery with the broken
thumbnail. That allows you to find with a quick glance of the gallery
which examples failed. Broken examples remain accessible in the html
view of the gallery and the traceback message is written for the
failing code block. Refer to example
<a class="reference internal" href="auto_examples/no_output/plot_raise.html#sphx-glr-auto-examples-no-output-plot-raise-py"><span class="std std-ref">Example that fails to execute</span></a> to view the default
behavior.</p>
<p>The build is also failed exiting with code 1 and giving you a summary
of the failed examples with their respective traceback. This way you
are aware of failing examples right after the build and can find them
easily.</p>
<p>There are some additional options at your hand to deal with broken examples.</p>
<div class="section" id="abort-build-on-first-fail">
<span id="abort-on-first"></span><h3>Abort build on first fail<a class="headerlink" href="#abort-build-on-first-fail" title="Permalink to this headline">¶</a></h3>
<p>Sphinx-Gallery provides the early fail option. In
this mode the gallery build process breaks as soon as an exception
occurs in the execution of the examples scripts. To activate this
behavior you need to pass a flag at the build process. It can be done
by including in your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>:</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="nf">html_abort_on_example_error</span><span class="o">:</span>
    <span class="k">$(</span>SPHINXBUILD<span class="k">)</span> -D <span class="nv">abort_on_example_error</span><span class="o">=</span><span class="m">1</span> -b html <span class="k">$(</span>ALLSPHINXOPTS<span class="k">)</span> <span class="k">$(</span>BUILDDIR<span class="k">)</span>/html
    @echo
    @echo <span class="s2">&quot;Build finished. The HTML pages are in </span><span class="k">$(</span>BUILDDIR<span class="k">)</span><span class="s2">/html.&quot;</span>
</pre></div>
</div>
<p>Remember that for <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> white space is significant and the indentation are tabs
and not spaces.</p>
<p>Alternatively, you can add the <code class="docutils literal notranslate"><span class="pre">abort_on_example_error</span></code> option to
the <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code> dictionary inside your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>
configuration file to have it as a default:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;abort_on_example_error&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The highest precedence is always given to the <cite>-D</cite> flag of
the <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> command.</p>
</div>
<div class="section" id="don-t-fail-the-build-on-exit">
<span id="dont-fail-exit"></span><h3>Don’t fail the build on exit<a class="headerlink" href="#don-t-fail-the-build-on-exit" title="Permalink to this headline">¶</a></h3>
<p>It might be the case that you want to keep the gallery even with
failed examples. Thus you can configure Sphinx-Gallery to allow
certain examples to fail and still exit with a 0 exit code. For this
you need to list all the examples you want to allow to fail during
build. Change your <cite>conf.py</cite> accordingly:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;expected_failing_examples&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples/plot_raise.py&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here you list the examples you allow to fail during the build process,
keep in mind to specify the full relative path from your <cite>conf.py</cite> to
the example script.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an example is expected to fail, Sphinx-Gallery will error if
the example runs without error.</p>
</div>
</div>
</div>
<div class="section" id="setting-gallery-thumbnail-size">
<span id="setting-thumbnail-size"></span><h2>Setting gallery thumbnail size<a class="headerlink" href="#setting-gallery-thumbnail-size" title="Permalink to this headline">¶</a></h2>
<p>By default Sphinx-Gallery will generate thumbnails at size <code class="docutils literal notranslate"><span class="pre">(400,</span> <span class="pre">280)</span></code>.
The thumbnail image will then be scaled to the size specified by
<code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code>, adding pillarboxes or letterboxes as necessary to
maintain the original aspect ratio. The default <code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code> is
<code class="docutils literal notranslate"><span class="pre">(400,</span> <span class="pre">280)</span></code> (no scaling) and can be changed via the <code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code>
configuration, e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;thumbnail_size&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The gallery uses various CSS classes to display these thumbnails, which
default to maximum 160x112px. To change this, e.g. to display the images
at 250x250px, you can modify the default CSS with something like the following
in your <code class="docutils literal notranslate"><span class="pre">gallery.css</span></code> file:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span> <span class="p">{</span>
    <span class="k">min-height</span><span class="p">:</span> <span class="mi">320</span><span class="kt">px</span> <span class="cp">!important</span><span class="p">;</span>
    <span class="k">margin</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span> <span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span> <span class="p">.</span><span class="nc">figure</span> <span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">250</span><span class="kt">px</span> <span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span> <span class="nt">img</span> <span class="p">{</span>
    <span class="k">max-height</span><span class="p">:</span> <span class="mi">250</span><span class="kt">px</span> <span class="cp">!important</span><span class="p">;</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">250</span><span class="kt">px</span> <span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span> <span class="nt">a</span><span class="p">.</span><span class="nc">internal</span> <span class="p">{</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">270</span><span class="kt">px</span> <span class="mi">10</span><span class="kt">px</span> <span class="mi">0</span> <span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value of <code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code> will change from
<code class="docutils literal notranslate"><span class="pre">(400,</span> <span class="pre">280)</span></code> (2.5x maximum specified by CSS) to <code class="docutils literal notranslate"><span class="pre">(320,</span> <span class="pre">224)</span></code>
(2x maximum specified by CSS) in version 0.9.0. This is to
prevent unnecessary over-sampling.</p>
</div>
</div>
<div class="section" id="minimal-reported-time">
<span id="min-reported-time"></span><h2>Minimal reported time<a class="headerlink" href="#minimal-reported-time" title="Permalink to this headline">¶</a></h2>
<p>By default, Sphinx-Gallery logs and embeds in the html output the time it took
to run each script.  If the majority of your examples runs quickly, you may not
need this information.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">min_reported_time</span></code> parameter can be set to a number of seconds.  The
duration of scripts that ran faster than that amount will not be logged nor
embedded in the html output.</p>
</div>
<div class="section" id="showing-memory-consumption">
<span id="show-memory"></span><h2>Showing memory consumption<a class="headerlink" href="#showing-memory-consumption" title="Permalink to this headline">¶</a></h2>
<p>Sphinx-Gallery can use <code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code>, if installed, to report the peak
memory during the run of an example. After installing <code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code>,
you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;show_memory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It’s also possible to use your own custom memory reporter, for example
if you would rather see the GPU memory. In that case, <code class="docutils literal notranslate"><span class="pre">show_memory</span></code> must
be a callable that takes a single function to call (i.e., one generated
internally to run an individual script code block), and returns a two-element
tuple containing:</p>
<ol class="arabic simple">
<li><p>The memory used in MiB while running the function, and</p></li>
<li><p>The function output</p></li>
</ol>
<p>A version of this that would always report 0 memory used would be:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;show_memory&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">func</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">func</span><span class="p">()),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="show-signature">
<span id="id7"></span><h2>Show signature<a class="headerlink" href="#show-signature" title="Permalink to this headline">¶</a></h2>
<p>By default, Sphinx-Gallery writes a <strong>Generated by …</strong> notice in the
generated output.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">show_signature</span></code> parameter can be used to disable it.</p>
</div>
<div class="section" id="controlling-what-output-is-captured">
<span id="capture-repr"></span><h2>Controlling what output is captured<a class="headerlink" href="#controlling-what-output-is-captured" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Configure <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> to be an empty tuple (i.e., <cite>capture_repr: ()</cite>)
to return to the output capturing behaviour prior to release v0.5.0.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> configuration allows the user to control what output
is captured, while executing the example <code class="docutils literal notranslate"><span class="pre">.py</span></code> files, and subsequently
incorporated into the built documentation. Data directed to standard output
is always captured. The value of the last statement of <em>each</em> code block, <em>if</em>
it is an expression, can also be captured. This can be done by providing
the name of the ‘representation’ method to be captured in the <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code>
tuple, in order of preference. The representation methods currently supported
are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__repr__</span></code> - returns the official string representation of an object. This
is what is returned when your Python shell evaluates an expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__str__</span></code> - returns a string containing a nicely printable representation
of an object. This is what is used when you <code class="docutils literal notranslate"><span class="pre">print()</span></code> an object or pass it
to <code class="docutils literal notranslate"><span class="pre">format()</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code> - returns a HTML version of the object. This method is only
present in some objects, for example, pandas dataframes.</p></li>
</ul>
<p>The default setting is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;capture_repr&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span> <span class="s1">&#39;__repr__&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the default setting Sphinx-Gallery would first attempt to capture the
<code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code> of the last statement of a code block, <em>if</em> it is an
expression. If this method does not exist for the expression, the second
‘representation’ method in the tuple, <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>, would be captured. If the
<code class="docutils literal notranslate"><span class="pre">__repr__</span></code> also does not exist (unlikely for non-user defined objects),
nothing would be captured. Data directed to standard output is <strong>always</strong>
captured. For several examples, see <a class="reference internal" href="auto_examples/plot_3_capture_repr.html#capture-repr-examples"><span class="std std-ref">Capturing output representations</span></a>.</p>
<p>To capture only data directed to standard output, configure <code class="docutils literal notranslate"><span class="pre">'capture_repr'</span></code>
to be an empty tuple: <code class="docutils literal notranslate"><span class="pre">'capture_repr':</span> <span class="pre">()</span></code>. This will imitate the behaviour
of Sphinx-Gallery prior to v0.5.0.</p>
<p>From another perspective, take for example the following code block:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="mi">2</span>
<span class="n">a</span>   <span class="c1"># this is an expression</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">'Hello</span> <span class="pre">world'</span></code> would be captured for every <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> setting as this
is directed to standard output. Further,</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> is an empty tuple, nothing else would be
captured.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> is <code class="docutils literal notranslate"><span class="pre">('__repr__')</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code> would also be captured.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> is <code class="docutils literal notranslate"><span class="pre">('_repr_html_',</span> <span class="pre">'__repr__')</span></code> (the default)
Sphinx-Gallery would first attempt to capture <code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code>. Since this
does not exist for <code class="docutils literal notranslate"><span class="pre">a</span></code>, it will then attempt to capture <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>.
The <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> method does exist for <code class="docutils literal notranslate"><span class="pre">a</span></code>, thus <code class="docutils literal notranslate"><span class="pre">2</span></code> would be also
captured in this case.</p></li>
</ul>
<p><strong>Matplotlib note</strong>: if the <code class="docutils literal notranslate"><span class="pre">'capture_repr'</span></code> tuple includes <code class="docutils literal notranslate"><span class="pre">'__repr__'</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">'__str__'</span></code>, code blocks which have a Matplotlib function call as the
last expression will generally produce a yellow output box in the built
documentation, as well as the figure. This is because matplotlib function calls
usually return something as well as creating/amending the plot in standard
output. For example, <code class="docutils literal notranslate"><span class="pre">matplotlib.plot()</span></code> returns a list of <code class="docutils literal notranslate"><span class="pre">Line2D</span></code> objects
representing the plotted data. This list has a <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> and a <code class="docutils literal notranslate"><span class="pre">__str__</span></code>
method which would thus be captured. You can prevent this by:</p>
<ul>
<li><p>assigning the (last) plotting function to a temporary variable. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>add <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> (which does not return anything) to the end of your
code block. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
<p>The unwanted string output will not occur if <code class="docutils literal notranslate"><span class="pre">'capture_repr'</span></code> is an empty
tuple or does not contain <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> or <code class="docutils literal notranslate"><span class="pre">__str__</span></code>.</p>
<div class="section" id="prevent-capture-of-certain-classes">
<h3>Prevent capture of certain classes<a class="headerlink" href="#prevent-capture-of-certain-classes" title="Permalink to this headline">¶</a></h3>
<p>If you wish to capture a representation of the last expression of each code
blocks <strong>unless</strong> the last expression is of a certain type, you can use
<code class="docutils literal notranslate"><span class="pre">'ignore_repr_types'</span></code>. <code class="docutils literal notranslate"><span class="pre">'ignore_repr_types'</span></code> is by default an empty raw
string (<code class="docutils literal notranslate"><span class="pre">r''</span></code>), meaning no types are ignored. To exclude specific type(s)
from being captured, <code class="docutils literal notranslate"><span class="pre">'ignore_repr_types'</span></code> can be set to a regular
expression matching the name(s) of the type(s) to be excluded.</p>
<p>For example, the configuration below would capture the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> of the
last expression of each code block unless the name of the <code class="docutils literal notranslate"><span class="pre">type()</span></code> of the last
expression includes the string ‘matplotlib.text’ <em>or</em> ‘matplotlib.axes’.
This would prevent capturing of all subclasses of ‘matplotlib.text’, e.g.
expressions of type ‘matplotlib.text.Annotation’, ‘matplotlib.text.OffsetFrom’
etc. Similarly subclasses of ‘matplotlib.axes’ (e.g. ‘matplotlib.axes.Axes’,
‘matplotlib.axes.Axes.plot’ etc.) will also not be captured.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;capture_repr&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;__repr__&#39;</span><span class="p">),</span>
    <span class="s1">&#39;ignore_repr_types&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;matplotlib[text, axes]&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="projects_list.html" class="btn btn-neutral float-right" title="Who uses Sphinx-Gallery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="syntax.html" class="btn btn-neutral float-left" title="How to structure your Python scripts for Sphinx-Gallery" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2014-2021, Sphinx-gallery developers.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>