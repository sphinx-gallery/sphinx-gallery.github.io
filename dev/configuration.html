
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Configuration &#8212; Sphinx-Gallery 0.18.dev0-git documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="_static/jupyterlite_sphinx.css?v=13b285a0" />
    <link rel="stylesheet" type="text/css" href="_static/theme_override.css?v=6ecc848e" />
    <link rel="stylesheet" type="text/css" href="_static/hide_links.css?v=60d22a59" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=e77a2ce9"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/jupyterlite_sphinx.js?v=0b35d31f"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'configuration';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://sphinx-gallery.github.io/dev/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Who uses Sphinx-Gallery" href="projects_list.html" />
    <link rel="prev" title="Structuring Python scripts for Sphinx-Gallery" href="syntax.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">üñºÔ∏è Sphinx-Gallery</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="usage.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="advanced_index.html">
    Advanced
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="galleries.html">
    Demo galleries
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contribute.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="changes.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/sphinx-gallery/sphinx-gallery" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/sphinx-gallery" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="usage.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="advanced_index.html">
    Advanced
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="galleries.html">
    Demo galleries
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contribute.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="changes.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/sphinx-gallery/sphinx-gallery" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/sphinx-gallery" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started with Sphinx-Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax.html">Structuring Python scripts for Sphinx-Gallery</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects_list.html">Who uses Sphinx-Gallery</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="usage.html" class="nav-link">Using Sphinx-Gallery</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Configuration</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="configuration">
<span id="id1"></span><h1>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h1>
<p>Configuration and customization of Sphinx-Gallery is done primarily with a
dictionary specified in your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file. A list of the possible
keys are listed <a class="reference internal" href="#list-of-options"><span class="std std-ref">below</span></a> and explained in
greater detail in subsequent sections.</p>
<p>When using these flags, it is good practice to make sure the source Python files
are equivalent to the generated HTML and iPython notebooks (i.e. make sure
<code class="docutils literal notranslate"><span class="pre">.py</span> <span class="pre">==</span> <span class="pre">.html</span> <span class="pre">==</span> <span class="pre">.ipynb</span></code>). This principle should be violated only when
necessary, and on a case-by-case basis.</p>
<section id="configuration-options">
<span id="list-of-options"></span><h2>Configuration options<a class="headerlink" href="#configuration-options" title="Link to this heading">#</a></h2>
<section id="global-conf-py-configurations">
<h3>Global <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> configurations<a class="headerlink" href="#global-conf-py-configurations" title="Link to this heading">#</a></h3>
<p>Sphinx-Gallery configuration options that can be set in the Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>
file, inside a <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code> dictionary.</p>
<p><strong>Gallery files and ordering</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">examples_dirs</span></code> and <code class="docutils literal notranslate"><span class="pre">gallery_dirs</span></code> (<a class="reference internal" href="#multiple-galleries-config"><span class="std std-ref">Manage multiple galleries</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code>, <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code>, <code class="docutils literal notranslate"><span class="pre">example_extensions</span></code>, and
<code class="docutils literal notranslate"><span class="pre">filetype_parsers</span></code> (<a class="reference internal" href="#build-pattern"><span class="std std-ref">Parsing and executing examples via matching patterns</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">copyfile_regex</span></code> (<a class="reference internal" href="#manual-passthrough"><span class="std std-ref">Manually passing files</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subsection_order</span></code> (<a class="reference internal" href="#sub-gallery-order"><span class="std std-ref">Sorting gallery subsections</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">within_subsection_order</span></code> (<a class="reference internal" href="#within-gallery-order"><span class="std std-ref">Sorting gallery examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nested_sections</span></code> (<a class="reference internal" href="#nested-sections"><span class="std std-ref">Nesting gallery sections</span></a>)</p></li>
</ul>
<p><strong>Example execution</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reset_argv</span></code> (<a class="reference internal" href="#reset-argv"><span class="std std-ref">Passing command line arguments to example scripts</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> and <code class="docutils literal notranslate"><span class="pre">ignore_repr_types</span></code> (<a class="reference internal" href="#capture-repr"><span class="std std-ref">Controlling what output is captured</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_gallery</span></code> (<a class="reference internal" href="#without-execution"><span class="std std-ref">Building without executing examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run_stale_examples</span></code> (<a class="reference internal" href="#run-stale-examples"><span class="std std-ref">Rerunning stale examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abort_on_example_error</span></code> (<a class="reference internal" href="#abort-on-first"><span class="std std-ref">Abort build on first fail</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expected_failing_examples</span></code> (<a class="reference internal" href="#dont-fail-exit"><span class="std std-ref">Don‚Äôt fail the build if specific examples error</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">only_warn_on_example_error</span></code> (<a class="reference internal" href="#warning-on-error"><span class="std std-ref">Never fail the build on error</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset_modules</span></code> and <code class="docutils literal notranslate"><span class="pre">reset_modules_order</span></code> (<a class="reference internal" href="#reset-modules"><span class="std std-ref">Resetting modules</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parallel</span></code> (<a class="reference internal" href="#parallel"><span class="std std-ref">Build examples in parallel</span></a>)</p></li>
</ul>
<p><strong>Cross-referencing</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reference_url</span></code>, <code class="docutils literal notranslate"><span class="pre">prefer_full_module</span></code> (<a class="reference internal" href="#link-to-documentation"><span class="std std-ref">Add intersphinx links to your examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">backreferences_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">doc_module</span></code>, <code class="docutils literal notranslate"><span class="pre">exclude_implicit_doc</span></code>,
and <code class="docutils literal notranslate"><span class="pre">inspect_global_variables</span></code> (<a class="reference internal" href="#minigalleries-to-examples"><span class="std std-ref">Add mini-galleries</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minigallery_sort_order</span></code> (<a class="reference internal" href="#minigallery-order"><span class="std std-ref">Sort mini-gallery thumbnails from files</span></a>)</p></li>
</ul>
<p><strong>Images and thumbnails</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">default_thumb_file</span></code> (<a class="reference internal" href="#custom-default-thumb"><span class="std std-ref">Using a custom default thumbnail</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code> (<a class="reference internal" href="#setting-thumbnail-size"><span class="std std-ref">Setting gallery thumbnail size</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image_srcset</span></code> (<a class="reference internal" href="#image-srcset"><span class="std std-ref">Multi-resolution images</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image_scrapers</span></code> (<a class="reference internal" href="#image-scrapers"><span class="std std-ref">Image scrapers</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compress_images</span></code> (<a class="reference internal" href="#compress-images"><span class="std std-ref">Compressing images</span></a>)</p></li>
</ul>
<p><strong>Compute costs</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">min_reported_time</span></code> (<a class="reference internal" href="#min-reported-time"><span class="std std-ref">Minimal reported time</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_computation_times</span></code> (<a class="reference internal" href="#write-computation-times"><span class="std std-ref">Write computation times</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_memory</span></code> (<a class="reference internal" href="#show-memory"><span class="std std-ref">Showing memory consumption</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">junit</span></code> (<a class="reference internal" href="#junit-xml"><span class="std std-ref">Using JUnit XML files</span></a>)</p></li>
</ul>
<p><strong>Jupyter notebooks and interactivity</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">notebook_extensions</span></code> (<a class="reference internal" href="#notebook-extensions"><span class="std std-ref">Controlling notebook download links</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">promote_jupyter_magic</span></code> (<a class="reference internal" href="#promote-jupyter-magic"><span class="std std-ref">Making cell magic executable in notebooks</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">first_notebook_cell</span></code> and <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code> (<a class="reference internal" href="#own-notebook-cell"><span class="std std-ref">Add your own first and last notebook cell</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notebook_images</span></code> (<a class="reference internal" href="#notebook-images"><span class="std std-ref">Adding images to notebooks</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> (<a class="reference internal" href="#use-pypandoc"><span class="std std-ref">Using pypandoc to convert reST to markdown</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binder</span></code> (<a class="reference internal" href="#binder-links"><span class="std std-ref">Generate Binder links for gallery notebooks (experimental)</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jupyterlite</span></code> (<a class="reference internal" href="#jupyterlite"><span class="std std-ref">Generate JupyterLite links for gallery notebooks (experimental)</span></a>)</p></li>
</ul>
<p><strong>Appearance</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">line_numbers</span></code> (<a class="reference internal" href="#adding-line-numbers"><span class="std std-ref">Adding line numbers to examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_config_comments</span></code> (<a class="reference internal" href="#removing-config-comments"><span class="std std-ref">Removing config comments</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_signature</span></code> (<a class="reference internal" href="#show-signature"><span class="std std-ref">Show signature</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_all_examples</span></code> (<a class="reference internal" href="#disable-all-scripts-download"><span class="std std-ref">Disabling download button of all scripts</span></a>)</p></li>
</ul>
<p><strong>Miscellaneous</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">recommender</span></code> (<a class="reference internal" href="#recommend-examples"><span class="std std-ref">Enabling the example recommender system</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_level</span></code> (<a class="reference internal" href="#log-level"><span class="std std-ref">Setting log level</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_api_usage</span></code> and <code class="docutils literal notranslate"><span class="pre">api_usage_ignore</span></code> (<a class="reference internal" href="#show-api-usage"><span class="std std-ref">Showing API Usage</span></a>)</p></li>
</ul>
</section>
<section id="configurations-inside-examples">
<h3>Configurations inside examples<a class="headerlink" href="#configurations-inside-examples" title="Link to this heading">#</a></h3>
<p>Some options can also be set or overridden on a file-by-file basis:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_line_numbers</span></code> (<a class="reference internal" href="#adding-line-numbers"><span class="std std-ref">Adding line numbers to examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_thumbnail_number</span></code> (<a class="reference internal" href="#choosing-thumbnail"><span class="std std-ref">Choosing the thumbnail image</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_thumbnail_path</span></code> (<a class="reference internal" href="#providing-thumbnail"><span class="std std-ref">Providing an image for the thumbnail image</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_failing_thumbnail</span></code> (<a class="reference internal" href="#failing-thumbnail"><span class="std std-ref">Controlling thumbnail behaviour in failing examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_dummy_images</span></code> (<a class="reference internal" href="#dummy-images"><span class="std std-ref">Generating dummy images</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_capture_repr</span></code> (<a class="reference internal" href="#capture-repr"><span class="std std-ref">Controlling what output is captured</span></a>)</p></li>
</ul>
<p>Some options can be set on a per-code-block basis in a file:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_defer_figures</span></code> (<a class="reference internal" href="#defer-figures"><span class="std std-ref">Using multiple code blocks to create a single figure</span></a>)</p></li>
</ul>
<p>Some options can be set on a per-line basis in a file:
- <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_start_ignore</span></code> and <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_end_ignore</span></code> (<a class="reference internal" href="#hiding-code-blocks"><span class="std std-ref">Hiding lines of code</span></a>)</p>
<p>See also <a class="reference internal" href="#removing-config-comments"><span class="std std-ref">Removing config comments</span></a> to hide config comments in files from
the rendered examples.</p>
</section>
<section id="build-options">
<h3>Build options<a class="headerlink" href="#build-options" title="Link to this heading">#</a></h3>
<p>Some options can be set during the build execution step, e.g. using a Makefile:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html-noplot</span></code> (<a class="reference internal" href="#without-execution"><span class="std std-ref">Building without executing examples</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html_abort_on_example_error</span></code> (<a class="reference internal" href="#abort-on-first"><span class="std std-ref">Abort build on first fail</span></a>)</p></li>
</ul>
</section>
<section id="css-changes">
<h3>CSS changes<a class="headerlink" href="#css-changes" title="Link to this heading">#</a></h3>
<p>Some things can be tweaked directly in CSS:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.sphx-glr-thumbcontainer</span></code> (<a class="reference internal" href="#setting-thumbnail-size"><span class="std std-ref">Setting gallery thumbnail size</span></a>)</p></li>
</ul>
</section>
</section>
<section id="removing-warnings">
<span id="id2"></span><h2>Removing warnings<a class="headerlink" href="#removing-warnings" title="Link to this heading">#</a></h2>
<p>To prevent warnings from being captured and included in your built
documentation, you can use the package <code class="docutils literal notranslate"><span class="pre">warnings</span></code> in the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file.
For example, to remove the specific Matplotlib agg warning, you can add:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="s1">&#39;Matplotlib is currently using agg, which is a&#39;</span>
                                <span class="s1">&#39; non-GUI backend, so cannot show the figure.&#39;</span>
                                <span class="s1">&#39;|(</span><span class="se">\n</span><span class="s1">|.)*is non-interactive, and thus cannot be shown&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>to your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file.</p>
<p>Note that the above Matplotlib warning is removed by default.</p>
</section>
<section id="importing-callables">
<span id="id3"></span><h2>Importing callables<a class="headerlink" href="#importing-callables" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery configuration values that are instantiated classes, classes
or functions should be passed as fully qualified name strings to the objects.
The object needs to be importable by Sphinx-Gallery.</p>
<p>Two common ways to achieve this are:</p>
<ol class="arabic">
<li><p>Define your object with your package. For example, you could write a function
<code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">my_sorter</span></code> and put it in <code class="docutils literal notranslate"><span class="pre">mymod/utils.py</span></code>, then use:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">#...,</span>
<span class="s2">&quot;minigallery_sort_order&quot;</span><span class="p">:</span> <span class="s2">&quot;mymod.utils.my_sorter&quot;</span><span class="p">,</span>
<span class="c1">#...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Define your object with your documentation. For example,
you can add documentation-specific stuff in a different path and ensure
that it can be resolved at build time. For example, you could create a file
<code class="docutils literal notranslate"><span class="pre">doc/sphinxext.py</span></code> and define your function:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotted_sorter</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="n">fname</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;plot_&quot;</span><span class="p">),</span> <span class="n">fname</span>
</pre></div>
</div>
<p>And set in your configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

<span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">#...,</span>
<span class="s2">&quot;minigallery_sort_order&quot;</span><span class="p">:</span> <span class="s2">&quot;sphinxext.plotted_sorter&quot;</span><span class="p">,</span>
<span class="c1">#...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And Sphinx-Gallery would resolve <code class="docutils literal notranslate"><span class="pre">&quot;sphinxext.plotted_sorter&quot;</span></code> to the
<code class="docutils literal notranslate"><span class="pre">plotted_sorter</span></code> object because the <code class="docutils literal notranslate"><span class="pre">doc/</span></code> directory is first on the path.</p>
</li>
</ol>
<p>Built in classes like <a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FileNameSortKey" title="sphinx_gallery.sorting.FileNameSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.FileNameSortKey</span></code></a> and similar can
be used with shorter direct alias strings like <code class="docutils literal notranslate"><span class="pre">&quot;FileNameSortKey&quot;</span></code> (see
<a class="reference internal" href="#within-gallery-order"><span class="std std-ref">Sorting gallery examples</span></a> for details).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sphinx-Gallery &gt;0.16.0 supports use of fully qualified name strings as a response
to the Sphinx &gt;7.3.0 changes to caching and serialization checks of the
<code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file.</p>
<p>This means that the previous use of class instances as configuration values to
ensure the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> was stable across builds is redundant <em>if</em> you are passing
configuration values via name strings. When using name strings, the configuration
object can just be a function.</p>
</div>
</section>
<section id="ensuring-a-stable-repr">
<span id="stable-repr"></span><h2>Ensuring a stable <code class="docutils literal notranslate"><span class="pre">__repr__</span></code><a class="headerlink" href="#ensuring-a-stable-repr" title="Link to this heading">#</a></h2>
<p>For backwards compatibility Sphinx-Gallery allows certain configuration values to be
a callable object instead of a <a class="reference internal" href="#importing-callables"><span class="std std-ref">importable name string</span></a>.</p>
<p>If you wish to use a callable object you will have to ensure that the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>
is stable across runs. Sphinx determines if the build environment has
changed, and thus if <em>all</em> documents should be rewritten, by examining the
config values using <code class="docutils literal notranslate"><span class="pre">md5(str(obj).encode()).hexdigest()</span></code> in
<code class="docutils literal notranslate"><span class="pre">sphinx/builders/html.py</span></code>. Default class instances in Python have their
memory address in their <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> which is why generally the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>
changes in each build.</p>
<p>Your callable should be a class that defines a stable <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> method.
For example, <a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.ExplicitOrder" title="sphinx_gallery.sorting.ExplicitOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.ExplicitOrder</span></code></a> stability is
ensured via the custom <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_list</span><span class="p">)</span>
</pre></div>
</div>
<p>Therefore, the files are only all rebuilt when the specified ordered list
is changed.</p>
</section>
<section id="manage-multiple-galleries">
<span id="multiple-galleries-config"></span><h2>Manage multiple galleries<a class="headerlink" href="#manage-multiple-galleries" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery only supports one level of subfolder nesting in its gallery directories.
For example our <a class="reference internal" href="auto_examples/index.html#examples-index"><span class="std std-ref">Basics Gallery with Matplotlib</span></a>, has the parent gallery in <cite>examples/</cite> and
the subsection (aka sub-gallery) in <cite>examples/no_output/</cite>. Further sub-folders are
not supported. This might be a limitation for you. Or you might want to have separate
galleries for different purposes; an examples gallery and a tutorials gallery.
To do this set the Sphinx-Gallery configuration dictionary keys <cite>examples_dirs</cite> and
<cite>gallery_dirs</cite> in your Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file to be a list of directories:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;examples_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples&#39;</span><span class="p">,</span> <span class="s1">&#39;../tutorials&#39;</span><span class="p">],</span>
    <span class="s1">&#39;gallery_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto_examples&#39;</span><span class="p">,</span> <span class="s1">&#39;tutorials&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Keep in mind that both lists have to be of the same length.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your examples take a long time to run, consider looking at the
<a class="reference internal" href="auto_examples/sg_execution_times.html#sphx-glr-auto-examples-sg-execution-times"><span class="std std-ref">execution times</span></a>
file that is generated for each gallery dir (as long as any examples
were actually executed in that directory during the build)
and globally for all galleries.</p>
</div>
</section>
<section id="parsing-and-executing-examples-via-matching-patterns">
<span id="build-pattern"></span><h2>Parsing and executing examples via matching patterns<a class="headerlink" href="#parsing-and-executing-examples-via-matching-patterns" title="Link to this heading">#</a></h2>
<p>By default, Sphinx-Gallery will <strong>parse and add</strong> all files with a <code class="docutils literal notranslate"><span class="pre">.py</span></code>
extension to the gallery, but only <strong>execute</strong> files beginning with <code class="docutils literal notranslate"><span class="pre">plot_</span></code>.
These behaviors are controlled by the <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code>, <code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code>,
and <code class="docutils literal notranslate"><span class="pre">example_extensions</span></code> entries, which have the default values:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/plot_&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ignore_pattern&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;__init__\.py&#39;</span><span class="p">,</span>
    <span class="s1">&#39;example_extensions&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;.py&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To omit some files from the gallery entirely (i.e., not execute, parse, or
add them), you can change the <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code> option.
To choose which of the parsed and added Python scripts are actually
executed, you can modify <code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code>. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/plot_compute_&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>will build all examples starting with <code class="docutils literal notranslate"><span class="pre">plot_compute_</span></code>. The key
<code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code> (and <code class="docutils literal notranslate"><span class="pre">ignore_pattern</span></code>) accepts <a class="reference external" href="https://docs.python.org/3/library/re.html">regular expressions</a>
which will be matched with the full path of the example. This is the reason
the leading <code class="docutils literal notranslate"><span class="pre">'/'</span></code> is required. Users are advised to use <code class="docutils literal notranslate"><span class="pre">re.escape(os.sep)</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">'/'</span></code> if they want to be agnostic to the operating system.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code> option is also useful if you want to build only a
subset of the examples. For example, you may
want to build only one example so that you can link it in the documentation.
In that case, you would do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;plot_awesome_example\.py&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, one should escape the dot <code class="docutils literal notranslate"><span class="pre">r'\.'</span></code> as otherwise python
<a class="reference external" href="https://docs.python.org/3/library/re.html">regular expressions</a> matches any character. Nevertheless, as
one is targeting a specific file, it would match the dot in the filename even
without this escape character.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sphinx-Gallery only re-runs examples that have changed (according to their
md5 hash). See <a class="reference internal" href="#run-stale-examples"><span class="std std-ref">Rerunning stale examples</span></a> below for information.</p>
</div>
<p>Similarly, to build only examples in a specific directory, you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/directory/plot_&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Alternatively, you can skip executing some examples. For example, to skip
building examples starting with <code class="docutils literal notranslate"><span class="pre">plot_long_examples_</span></code>, you would do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filename_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;/plot_(?!long_examples)&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As the patterns are parsed as <a class="reference external" href="https://docs.python.org/3/library/re.html">regular expressions</a>, users are advised to
consult the <a class="reference external" href="https://docs.python.org/3/library/re.html">regular expressions</a> module for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that Sphinx allows overriding <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> values from the command
line, so you can for example build a single example directly via something
like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sphinx-build<span class="w"> </span>-D<span class="w"> </span>sphinx_gallery_conf.filename_pattern<span class="o">=</span>plot_specific_example<span class="se">\.</span>py<span class="w"> </span>...
</pre></div>
</div>
</div>
<p>You can also parse and highlight syntax examples in other languages by adding their
extensions to <code class="docutils literal notranslate"><span class="pre">example_extensions</span></code>, though they will not be executed. For example, to
include examples in Python, Julia, and C++:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;example_extensions&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;.py&#39;</span><span class="p">,</span> <span class="s1">&#39;.jl&#39;</span><span class="p">,</span> <span class="s1">&#39;.cpp&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Parsing and syntax highlighting is supported by the Pygments library, with the language
determined by the file extension. To override Pygments‚Äô default file associations, the
<code class="docutils literal notranslate"><span class="pre">filetype_parsers</span></code> option can be used to specify a <code class="docutils literal notranslate"><span class="pre">dict</span></code> mapping any of the file
extensions in <code class="docutils literal notranslate"><span class="pre">example_extensions</span></code> to any of the <a class="reference external" href="https://pygments.org/languages/">pygments language names</a>. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;filetype_parsers&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;.m&#39;</span><span class="p">:</span> <span class="s1">&#39;Matlab&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="rerunning-stale-examples">
<span id="run-stale-examples"></span><h2>Rerunning stale examples<a class="headerlink" href="#rerunning-stale-examples" title="Link to this heading">#</a></h2>
<p>By default, Sphinx-Gallery only rebuilds examples that have changed.
For example, when starting from a clean <code class="docutils literal notranslate"><span class="pre">doc/</span></code> directory, running your HTML
build once will result in Sphinx-Gallery executing all examples that match your
given <a class="reference internal" href="#build-pattern"><span class="std std-ref">filename/ignore patterns</span></a>. Then, running
the exact same command a second time <em>should not run any examples</em>, because the
MD5 hash of each example will be checked against the MD5 hash (saved to disk
as <code class="docutils literal notranslate"><span class="pre">&lt;filename&gt;.md5</span></code> in the generated directory) that the example file had
during the first build. These will match and thus the example will be
determined to be ‚Äústale‚Äù, and it will not be rebuilt by Sphinx-Gallery.
This design feature allows for more rapid documentation iteration by only
rebuilding examples when they change.</p>
<p>However, this presents a problem during some modes of debugging and
iteration. Let‚Äôs say that you have one particular
example that you want to rebuild repeatedly while modifying some function in
your underlying library but do not want to change the example file contents
themselves. To do this, you‚Äôd either need to make some change (e.g., add/delete
a newline) to your example or delete the <code class="docutils literal notranslate"><span class="pre">.md5</span></code> file to force Sphinx-Gallery
to rebuild the example. Instead, you can use the configuration value:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;run_stale_examples&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With this configuration, all examples matching the filename/ignore pattern will
be rebuilt, even if their MD5 hash shows that the example did not change.
You can combine this with <a class="reference internal" href="#build-pattern"><span class="std std-ref">filename/ignore patterns</span></a>
to repeatedly rerun a single example.
This could be done from the command line, for example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>make<span class="w"> </span>html<span class="w"> </span><span class="nv">SPHINXOPTS</span><span class="o">=</span><span class="s2">&quot;-D sphinx_gallery_conf.run_stale_examples=True -D sphinx_gallery_conf.filename_pattern=&#39;my_example_name&#39;&quot;</span>
</pre></div>
</div>
<p>This command will cause any examples matching the filename pattern
<code class="docutils literal notranslate"><span class="pre">'my_example_name'</span></code> to be rebuilt, regardless of their MD5 hashes.</p>
</section>
<section id="passing-command-line-arguments-to-example-scripts">
<span id="reset-argv"></span><h2>Passing command line arguments to example scripts<a class="headerlink" href="#passing-command-line-arguments-to-example-scripts" title="Link to this heading">#</a></h2>
<p>By default, Sphinx-Gallery will not pass any command line arguments to example
scripts. By setting the <code class="docutils literal notranslate"><span class="pre">reset_argv</span></code> option, it is possible to change this
behavior and pass command line arguments to example scripts. <code class="docutils literal notranslate"><span class="pre">reset_argv</span></code>
needs to be a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> that accepts the <code class="docutils literal notranslate"><span class="pre">gallery_conf</span></code> and <code class="docutils literal notranslate"><span class="pre">script_vars</span></code>
dictionaries as input and returns a list of strings that are passed as
additional command line arguments to the interpreter.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">reset_argv</span></code> example could be:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span> <span class="nf">reset_argv</span><span class="p">(</span><span class="n">sphinx_gallery_conf</span><span class="p">,</span> <span class="n">script_vars</span><span class="p">):</span>
    <span class="n">src_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">script_vars</span><span class="p">[</span><span class="s1">&#39;src_file&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="n">src_file</span> <span class="o">==</span> <span class="s1">&#39;example1.py&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">src_file</span> <span class="o">==</span> <span class="s1">&#39;example2.py&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
</pre></div>
</div>
<p>This function is defined in <code class="docutils literal notranslate"><span class="pre">doc/sphinxext.py</span></code> and we ensured that it is importable
(see <a class="reference internal" href="#importing-callables"><span class="std std-ref">Importing callables</span></a>).</p>
<p>This can be included in the configuration dictionary as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reset_argv&#39;</span><span class="p">:</span> <span class="s2">&quot;sphinxext.reset_argv&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>which is then resolved by Sphinx-Gallery to the callable <code class="docutils literal notranslate"><span class="pre">reset_argv</span></code> and used as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">script_vars</span><span class="p">[</span><span class="s1">&#39;src_file&#39;</span><span class="p">]</span>
<span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">reset_argv</span><span class="p">(</span><span class="n">gallery_conf</span><span class="p">,</span> <span class="n">script_vars</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For backwards compatibility you can also set your configuration to be a callable
object but you will have to ensure that the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> is stable across runs.
See <a class="reference internal" href="#stable-repr"><span class="std std-ref">Ensuring a stable __repr__</span></a>.</p>
</div>
</section>
<section id="sorting-gallery-subsections">
<span id="sub-gallery-order"></span><h2>Sorting gallery subsections<a class="headerlink" href="#sorting-gallery-subsections" title="Link to this heading">#</a></h2>
<p>Gallery subsections (aka sub-galleries) are sorted by default alphabetically by
their folder name, and as such you can always organize them by changing your folder
names. Alternatively, you can specify the order via the config value
‚Äòsubsection_order‚Äô by providing a list of the subsections as paths
relative to <code class="file docutils literal notranslate"><span class="pre">conf.py</span></code> in the desired order:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;examples_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples&#39;</span><span class="p">,</span><span class="s1">&#39;../tutorials&#39;</span><span class="p">],</span>
    <span class="s1">&#39;subsection_order&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples/sin_func&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;../examples/no_output&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;../tutorials/seaborn&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here we build 2 main galleries <cite>examples</cite> and <cite>tutorials</cite>, each of them
with subsections. You must list all subsections. If that‚Äôs too cumbersome,
one entry can be ‚Äú*‚Äù, which will collect all not-listed subsections, e.g.
<code class="docutils literal notranslate"><span class="pre">[&quot;first_subsection&quot;,</span> <span class="pre">&quot;*&quot;,</span> <span class="pre">&quot;last_subsection&quot;]</span></code>.</p>
<p>Even more generally, you can set ‚Äòsubsection_order‚Äô to any callable, which
will be used as sorting key function on the subsection paths. See
<a class="reference internal" href="#own-sort-keys"><span class="std std-ref">Custom sort keys</span></a> for more information.</p>
<p>In fact, the
above list is a convenience shortcut and it is internally wrapped in
<a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.ExplicitOrder" title="sphinx_gallery.sorting.ExplicitOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.ExplicitOrder</span></code></a> as a sortkey.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sphinx-Gallery &lt;0.16.0 required to wrap the list in
<a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.ExplicitOrder" title="sphinx_gallery.sorting.ExplicitOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitOrder</span></code></a></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sphinx_gallery.sorting</span> <span class="kn">import</span> <span class="n">ExplicitOrder</span>
<span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;subsection_order&#39;</span><span class="p">:</span> <span class="n">ExplicitOrder</span><span class="p">([</span><span class="o">...</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This pattern is discouraged in favor of passing the simple list.</p>
</div>
<p>Keep in mind that we use a single sort key
for all the galleries that are built, thus we include the prefix of each
gallery in the corresponding subsection folders. One does not define a
sortkey per gallery. You can use Linux paths, and if your documentation is
built in a Windows system, paths will be transformed to work accordingly,
the converse does not hold.</p>
</section>
<section id="sorting-gallery-examples">
<span id="within-gallery-order"></span><h2>Sorting gallery examples<a class="headerlink" href="#sorting-gallery-examples" title="Link to this heading">#</a></h2>
<p>Within a given gallery (sub)section, the example files are ordered by
using the standard <a class="reference external" href="https://docs.python.org/3/library/functions.html#sorted" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sorted()</span></code></a> function with the <code class="docutils literal notranslate"><span class="pre">key</span></code> argument by default
set to
<a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.NumberOfCodeLinesSortKey" title="sphinx_gallery.sorting.NumberOfCodeLinesSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumberOfCodeLinesSortKey(src_dir)</span></code></a>,
which sorts the files based on the number of code lines:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;within_subsection_order&#39;</span><span class="p">:</span> <span class="s2">&quot;NumberOfCodeLinesSortKey&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Built in convenience classes supported by <code class="docutils literal notranslate"><span class="pre">within_subsection_order</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.NumberOfCodeLinesSortKey" title="sphinx_gallery.sorting.NumberOfCodeLinesSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.NumberOfCodeLinesSortKey</span></code></a> (default) to sort by
the number of code lines.</p></li>
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FileSizeSortKey" title="sphinx_gallery.sorting.FileSizeSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.FileSizeSortKey</span></code></a> to sort by file size.</p></li>
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FileNameSortKey" title="sphinx_gallery.sorting.FileNameSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.FileNameSortKey</span></code></a> to sort by file name.</p></li>
<li><p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.ExampleTitleSortKey" title="sphinx_gallery.sorting.ExampleTitleSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.ExampleTitleSortKey</span></code></a> to sort by example title.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These built in Sphinx-Gallery classes can be
specified using just the stem, e.g., <code class="docutils literal notranslate"><span class="pre">&quot;NumberOfLinesSortKey&quot;</span></code>. It is
functionally equivalent to providing the fully qualified name
<code class="docutils literal notranslate"><span class="pre">&quot;sphinx_gallery.sorting.NumberOfCodeLinesSortKey&quot;</span></code>. See
<a class="reference internal" href="#importing-callables"><span class="std std-ref">Importing callables</span></a> for details.</p>
</div>
</section>
<section id="custom-sort-keys">
<span id="own-sort-keys"></span><h2>Custom sort keys<a class="headerlink" href="#custom-sort-keys" title="Link to this heading">#</a></h2>
<p>You can create a custom sort key callable for the following configurations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sub-gallery-order"><span class="std std-ref">subsection_order</span></a></p></li>
<li><p><a class="reference internal" href="#minigallery-order"><span class="std std-ref">minigallery_sort_order</span></a></p></li>
</ul>
<p>The best way to do this is to define a sort function, that takes the passed path
string:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotted_sorter</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="n">fname</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;plot_&quot;</span><span class="p">),</span> <span class="n">fname</span>
</pre></div>
</div>
<p>ensure it is importable (see <a class="reference internal" href="#importing-callables"><span class="std std-ref">Importing callables</span></a>) and set your configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">#...,</span>
<span class="s2">&quot;minigallery_sort_order&quot;</span><span class="p">:</span> <span class="s2">&quot;sphinxext.plotted_sorter&quot;</span><span class="p">,</span>
<span class="c1">#...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For backwards compatibility you can also set your configuration to be a callable
object but you will have to ensure that the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> is stable across runs.
See <a class="reference internal" href="#stable-repr"><span class="std std-ref">Ensuring a stable __repr__</span></a> for details.</p>
<p>We recommend that you use the <a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FunctionSortKey" title="sphinx_gallery.sorting.FunctionSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.FunctionSortKey</span></code></a>
because it will ensure that the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> is stable across runs.</p>
<p><a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FunctionSortKey" title="sphinx_gallery.sorting.FunctionSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.sorting.FunctionSortKey</span></code></a> takes a function on init.
You can create your sort key callable by instantiating a
<a class="reference internal" href="gen_modules/sphinx_gallery.sorting.html#sphinx_gallery.sorting.FunctionSortKey" title="sphinx_gallery.sorting.FunctionSortKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSortKey</span></code></a> instance with your sort key
function. For example, the following <code class="docutils literal notranslate"><span class="pre">minigallery_sort_order</span></code> configuration
(which sorts on paths) will sort using the first 10 letters of each filename:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">#...,</span>
<span class="s2">&quot;minigallery_sort_order&quot;</span><span class="p">:</span> <span class="n">FunctionSortKey</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">filename</span><span class="p">:</span> <span class="n">filename</span><span class="p">[:</span><span class="mi">10</span><span class="p">]),</span>
<span class="c1">#...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="add-intersphinx-links-to-your-examples">
<span id="link-to-documentation"></span><h2>Add intersphinx links to your examples<a class="headerlink" href="#add-intersphinx-links-to-your-examples" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery enables you to add hyperlinks in your example scripts so that
you can link used functions/methods/attributes/objects/classes to their matching
online documentation. Such code snippets within the gallery appear like this:</p>
<div class="highlight-python"><div class="highlight"><pre>
<span class="n">y</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.sin.html#numpy.sin"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div><p>Have a look at this in full action
in our example <a class="reference internal" href="auto_examples/plot_0_sin.html#sphx-glr-auto-examples-plot-0-sin-py"><span class="std std-ref">Introductory example - Plotting sin</span></a>.</p>
<p>To make this work in your documentation you need to include to the configuration
dictionary within your Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reference_url&#39;</span><span class="p">:</span> <span class="p">{</span>
         <span class="c1"># The module you locally document uses None</span>
        <span class="s1">&#39;sphinx_gallery&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To link to external modules, if you use the Sphinx extension
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#module-sphinx.ext.intersphinx" title="(in Sphinx v8.1.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sphinx.ext.intersphinx</span></code></a>, no additional changes are necessary,
as the <code class="docutils literal notranslate"><span class="pre">intersphinx</span></code> inventory will automatically be used.
If you do not use <code class="docutils literal notranslate"><span class="pre">intersphinx</span></code>, then you should add entries that
point to the directory containing <code class="docutils literal notranslate"><span class="pre">searchindex.js</span></code>, such as
<code class="docutils literal notranslate"><span class="pre">'matplotlib':</span> <span class="pre">'https://matplotlib.org'</span></code>.</p>
<p>If you wish to do the same for ordinary reST documentation,
see <a class="reference internal" href="syntax.html#plain-rst"><span class="std std-ref">Plain reST examples</span></a>.</p>
<section id="resolving-module-paths">
<h3>Resolving module paths<a class="headerlink" href="#resolving-module-paths" title="Link to this heading">#</a></h3>
<p>When finding links to objects we use, by default, the shortest module path,
checking that it still directs to the same object. This is because it is common
for a class that is defined in a deeper module to be documented in a shallower
one because it is imported in a higher level modules‚Äô <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> (thus
that‚Äôs the namespace users expect it to be).</p>
<p>However, if you are using inherited classes in your code and are experiencing
incorrect links in the sense that links point to the base class of an object
instead of the child, the option <code class="docutils literal notranslate"><span class="pre">prefer_full_module</span></code> might solve your issue.
See <a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/issues/947">the GitHub
issue</a>
for more context.</p>
<p>To make this work in your documentation you need to include
<code class="docutils literal notranslate"><span class="pre">prefer_full_module</span></code> in the Sphinx-Gallery configuration dictionary in
<code class="docutils literal notranslate"><span class="pre">conf.py</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="c1"># Regexes to match the fully qualified names of objects where the full</span>
    <span class="c1"># module name should be used. To use full names for all objects use: &#39;.*&#39;</span>
    <span class="s1">&#39;prefer_full_module&#39;</span><span class="p">:</span> <span class="p">{</span><span class="sa">r</span><span class="s1">&#39;module\.submodule&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example, all fully qualified names matching the regex
<code class="docutils literal notranslate"><span class="pre">'module\.submodule'</span></code> would use the full module name
(e.g., module.submodule.meth) when creating links, instead of the short module
name (e.g., module.meth). All others will use the (default) way of linking.</p>
</section>
</section>
<section id="add-mini-galleries">
<span id="minigalleries-to-examples"></span><h2>Add mini-galleries<a class="headerlink" href="#add-mini-galleries" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery provides the <a class="reference internal" href="gen_modules/sphinx_gallery.directives.html#sphinx_gallery.directives.MiniGallery" title="sphinx_gallery.directives.MiniGallery"><code class="xref py py-class docutils literal notranslate"><span class="pre">sphinx_gallery.directives.MiniGallery</span></code></a>
directive so that you can easily add a reduced version of the Gallery to
your Sphinx documentation <code class="docutils literal notranslate"><span class="pre">.rst</span></code> files. The minigallery directive therefore
supports passing a list (space separated) of any of the following:</p>
<ul class="simple">
<li><p>fully qualified name of object (see <a class="reference internal" href="#references-to-examples"><span class="std std-ref">Add mini-galleries for API documentation</span></a>) - this
adds all examples where the object was used in the code or referenced in
the example text</p></li>
<li><p>pathlike strings to example Python files, including glob-style
(see <a class="reference internal" href="#file-based-minigalleries"><span class="std std-ref">Create mini-galleries using file paths</span></a>)</p></li>
</ul>
<p>To use object names, you must enable backreference generation, see
<a class="reference internal" href="#references-to-examples"><span class="std std-ref">Add mini-galleries for API documentation</span></a> for details.
If backreference generation is not enabled, object entries to the
<a class="reference internal" href="gen_modules/sphinx_gallery.directives.html#sphinx_gallery.directives.MiniGallery" title="sphinx_gallery.directives.MiniGallery"><code class="xref py py-class docutils literal notranslate"><span class="pre">MiniGallery</span></code></a> directive will be ignored
and all entries will be treated as pathlike strings or glob-style pathlike strings.
See <a class="reference internal" href="#file-based-minigalleries"><span class="std std-ref">Create mini-galleries using file paths</span></a> for details.</p>
<section id="add-mini-galleries-for-api-documentation">
<span id="references-to-examples"></span><h3>Add mini-galleries for API documentation<a class="headerlink" href="#add-mini-galleries-for-api-documentation" title="Link to this heading">#</a></h3>
<p>Sphinx-Gallery can generate minigalleries for objects from specified modules,
consisting of all examples that either:</p>
<ol class="arabic simple">
<li><p>Use the function/method/attribute/object or instantiate the class in the
code (called <em>implicit backreferences</em>) or</p></li>
<li><p>Refer to that function/method/attribute/object/class using sphinx markup
<code class="docutils literal notranslate"><span class="pre">:func:</span></code> / <code class="docutils literal notranslate"><span class="pre">:meth:</span></code> / <code class="docutils literal notranslate"><span class="pre">:attr:</span></code> / <code class="docutils literal notranslate"><span class="pre">:obj:</span></code> / <code class="docutils literal notranslate"><span class="pre">:class:</span></code> in a text
block. You can omit this role markup if you have set the <a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/configuration.html#confval-default_role">default_role</a>
in your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> to any of these roles (called <em>explicit
backreferences</em>).</p></li>
</ol>
<p>This allows you to pass a fully qualified name of an object (e.g., function, method,
attribute, class) to the minigallery directive to add a minigallery of all examples
relevant to that object. This can be useful in API documentation.</p>
<p><strong>Implicit backreferences</strong> are useful for auto-documenting objects
that are used and classes that are explicitly instantiated, in the code. Any examples
where an object is used in the code are added <em>implicitly</em> as backreferences.
<strong>Explicit backreferences</strong> are for objects that are <em>explicitly</em> referred to
in an example‚Äôs text. They are useful for classes that are
typically implicitly returned in the code rather than explicitly instantiated (e.g.,
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> which is most often instantiated only indirectly
within function calls)..</p>
<p>For example, we can embed a small gallery of all examples that use or
refer to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.exp.html#numpy.exp" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.exp</span></code></a>, which looks like this:</p>
</section>
<section id="examples-using-numpy-exp">
<h3>Examples using <code class="docutils literal notranslate"><span class="pre">numpy.exp</span></code><a class="headerlink" href="#examples-using-numpy-exp" title="Link to this heading">#</a></h3>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to import a local module and how images are stacked when two plots are created in one code block. The variable N from the example &#x27;Local module&#x27; (file local_module.py) is imported in the code below. Further, note that when there is only one code block in an example, the output appears before the code block."><img alt="" src="_images/sphx_glr_plot_1_exp_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_1_exp.html#sphx-glr-auto-examples-plot-1-exp-py"><span class="std std-ref">Plotting the exponential function</span></a></p>
  <div class="sphx-glr-thumbnail-title">Plotting the exponential function</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to choose the figure that is displayed as the thumbnail, if the example generates more than one figure. This is done by specifying the keyword-value pair sphinx_gallery_thumbnail_number = &lt;fig number&gt; as a comment somewhere below the docstring in the example file. In this example, we specify that we wish for the second figure to be the thumbnail."><img alt="" src="_images/sphx_glr_plot_4_choose_thumbnail_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_4_choose_thumbnail.html#sphx-glr-auto-examples-plot-4-choose-thumbnail-py"><span class="std std-ref">Choosing the thumbnail figure</span></a></p>
  <div class="sphx-glr-thumbnail-title">Choosing the thumbnail figure</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This demonstrates how Sphinx-Gallery identifies when"><img alt="" src="_images/sphx_glr_plot_6_function_identifier_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_6_function_identifier.html#sphx-glr-auto-examples-plot-6-function-identifier-py"><span class="std std-ref">Identifying function names in a script</span></a></p>
  <div class="sphx-glr-thumbnail-title">Identifying function names in a script</div>
</div></div><p>For such behavior to be available, you have to activate it in
your Sphinx-Gallery configuration <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file with:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="c1"># directory where function/class granular galleries are stored</span>
    <span class="s1">&#39;backreferences_dir&#39;</span>  <span class="p">:</span> <span class="s1">&#39;gen_modules/backreferences&#39;</span><span class="p">,</span>

    <span class="c1"># Modules for which function/class level galleries are created. In</span>
    <span class="c1"># this case sphinx_gallery and numpy in a tuple of strings.</span>
    <span class="s1">&#39;doc_module&#39;</span>          <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;sphinx_gallery&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">),</span>

    <span class="c1"># Regexes to match objects to exclude from implicit backreferences.</span>
    <span class="c1"># The default option is an empty set, i.e. exclude nothing.</span>
    <span class="c1"># To exclude everything, use: &#39;.*&#39;</span>
    <span class="s1">&#39;exclude_implicit_doc&#39;</span><span class="p">:</span> <span class="p">{</span><span class="sa">r</span><span class="s1">&#39;pyplot\.show&#39;</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The path you specify in <code class="docutils literal notranslate"><span class="pre">backreferences_dir</span></code> (here we choose
<code class="docutils literal notranslate"><span class="pre">gen_modules/backreferences</span></code>) will be populated with
ReStructuredText files, with names ending with ‚Äò.examples‚Äô.
Each .rst file will contain a reduced version of the
gallery specific to every function/class that is used across all the examples
and belonging to the modules listed in <code class="docutils literal notranslate"><span class="pre">doc_module</span></code>.
Note that backreference files will be generated for all objects. Objects that
are not used in any example will have an empty file to prevent inclusion
errors during autodoc parsing.</p>
<p><code class="docutils literal notranslate"><span class="pre">backreferences_dir</span></code> should be a string or <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> object that is
<strong>relative</strong> to the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file, or <code class="docutils literal notranslate"><span class="pre">None</span></code>. It is <code class="docutils literal notranslate"><span class="pre">None</span></code> by default.</p>
<p>Sometimes, there are functions that are being used in practically every example
for the given module, for instance the <code class="docutils literal notranslate"><span class="pre">pyplot.show</span></code> or <code class="docutils literal notranslate"><span class="pre">pyplot.subplots</span></code>
functions in Matplotlib, so that a large number of often spurious examples will
be linked to these functions. To prevent this, you can exclude implicit
backreferences for certain objects by including them as regular expressions
in <code class="docutils literal notranslate"><span class="pre">exclude_implicit_doc</span></code>. The following setting will exclude any implicit
backreferences so that examples galleries are only created for objects
explicitly mentioned by Sphinx markup in a documentation block: <code class="docutils literal notranslate"><span class="pre">{'.*'}</span></code>.
To exclude the functions mentioned above you would use
<code class="docutils literal notranslate"><span class="pre">{r'pyplot\.show',</span> <span class="pre">r'pyplot\.subplots'}</span></code> (note the escape to match a dot
instead of any character, if the name is unambiguous you can also write
<code class="docutils literal notranslate"><span class="pre">pyplot.show</span></code> or just <code class="docutils literal notranslate"><span class="pre">show</span></code>).</p>
</section>
<section id="create-mini-galleries-using-file-paths">
<span id="file-based-minigalleries"></span><h3>Create mini-galleries using file paths<a class="headerlink" href="#create-mini-galleries-using-file-paths" title="Link to this heading">#</a></h3>
<p>Sometimes you may want to explicitly create a
<a class="reference internal" href="gen_modules/sphinx_gallery.directives.html#sphinx_gallery.directives.MiniGallery" title="sphinx_gallery.directives.MiniGallery"><code class="xref py py-class docutils literal notranslate"><span class="pre">mini-gallery</span></code></a> using files that
do not have functions in common, for example a set of tutorials. The
mini-gallery directive therefore also supports passing in:</p>
<ul class="simple">
<li><p>pathlike strings to sphinx gallery example files (relative to <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>)</p></li>
<li><p>glob-style pathlike strings to Sphinx-Gallery example files (relative to <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>)</p></li>
</ul>
<p>For example, the rst below adds the reduced version of the Gallery for all
examples that use the specific function <code class="docutils literal notranslate"><span class="pre">numpy.exp</span></code>, the example
<code class="docutils literal notranslate"><span class="pre">examples/plot_sin_.py</span></code>, and all files matching the string
<code class="docutils literal notranslate"><span class="pre">/examples/plot_4*</span></code>:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">minigallery</span><span class="p">::</span>
    <span class="nc">:add-heading:</span>

    numpy.exp
<span class="c">    ../examples/plot_0_sin.py</span>
<span class="c">    ../examples/plot_4*</span>
</pre></div>
</div>
<p>Listing multiple items merges all the examples into a single mini-gallery. The
mini-gallery will only be shown if the files exist or the items are actually
used or referred to in an example. Thumbnails may also be duplicated
if they correspond to multiple object names or an object name and file/glob
input.</p>
</section>
<section id="examples-using-one-of-multiple-objects">
<h3>Examples using one of multiple objects<a class="headerlink" href="#examples-using-one-of-multiple-objects" title="Link to this heading">#</a></h3>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="This is a general example demonstrating a Matplotlib plot output, embedded reST, the use of math notation and cross-linking to other examples. It would be useful to compare the source Python file &lt;plot_0_sin.py&gt; with the output below."><img alt="" src="_images/sphx_glr_plot_0_sin_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_0_sin.html#sphx-glr-auto-examples-plot-0-sin-py"><span class="std std-ref">Introductory example - Plotting sin</span></a></p>
  <div class="sphx-glr-thumbnail-title">Introductory example - Plotting sin</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to choose the figure that is displayed as the thumbnail, if the example generates more than one figure. This is done by specifying the keyword-value pair sphinx_gallery_thumbnail_number = &lt;fig number&gt; as a comment somewhere below the docstring in the example file. In this example, we specify that we wish for the second figure to be the thumbnail."><img alt="" src="_images/sphx_glr_plot_4_choose_thumbnail_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_4_choose_thumbnail.html#sphx-glr-auto-examples-plot-4-choose-thumbnail-py"><span class="std std-ref">Choosing the thumbnail figure</span></a></p>
  <div class="sphx-glr-thumbnail-title">Choosing the thumbnail figure</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to provide a figure that is displayed as the thumbnail. This is done by specifying the keyword-value pair sphinx_gallery_thumbnail_path = &#x27;fig path&#x27; as a comment somewhere below the docstring in the example file. In this example, we specify that we wish the figure demo.png in the folder _static to be used for the thumbnail."><img alt="" src="_images/sphx_glr_plot_4b_provide_thumbnail_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_4b_provide_thumbnail.html#sphx-glr-auto-examples-plot-4b-provide-thumbnail-py"><span class="std std-ref">Providing a figure for the thumbnail image</span></a></p>
  <div class="sphx-glr-thumbnail-title">Providing a figure for the thumbnail image</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to import a local module and how images are stacked when two plots are created in one code block. The variable N from the example &#x27;Local module&#x27; (file local_module.py) is imported in the code below. Further, note that when there is only one code block in an example, the output appears before the code block."><img alt="" src="_images/sphx_glr_plot_1_exp_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_1_exp.html#sphx-glr-auto-examples-plot-1-exp-py"><span class="std std-ref">Plotting the exponential function</span></a></p>
  <div class="sphx-glr-thumbnail-title">Plotting the exponential function</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to choose the figure that is displayed as the thumbnail, if the example generates more than one figure. This is done by specifying the keyword-value pair sphinx_gallery_thumbnail_number = &lt;fig number&gt; as a comment somewhere below the docstring in the example file. In this example, we specify that we wish for the second figure to be the thumbnail."><img alt="" src="_images/sphx_glr_plot_4_choose_thumbnail_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_4_choose_thumbnail.html#sphx-glr-auto-examples-plot-4-choose-thumbnail-py"><span class="std std-ref">Choosing the thumbnail figure</span></a></p>
  <div class="sphx-glr-thumbnail-title">Choosing the thumbnail figure</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This demonstrates how Sphinx-Gallery identifies when"><img alt="" src="_images/sphx_glr_plot_6_function_identifier_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_6_function_identifier.html#sphx-glr-auto-examples-plot-6-function-identifier-py"><span class="std std-ref">Identifying function names in a script</span></a></p>
  <div class="sphx-glr-thumbnail-title">Identifying function names in a script</div>
</div></div><p>You can also provide the list of items in the body of the directive:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">minigallery</span><span class="p">::</span>
    <span class="nc">:add-heading:</span>

    numpy.exp
<span class="c">    ../examples/plot_0_sin.py</span>
<span class="c">    ../examples/plot_4*</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">add-heading</span></code> option adds a heading for the mini-gallery. If no string
argument is provided, when only a single item is listed the default heading is:</p>
<blockquote>
<div><p>‚ÄúExamples using <em>{full qualified object name}</em>‚Äù</p>
</div></blockquote>
<p>Specifying a custom heading message is recommended for a gallery with multiple
items because otherwise the default message is:</p>
<blockquote>
<div><p>‚ÄúExamples of one of multiple objects‚Äù.</p>
</div></blockquote>
<p>The example mini-gallery shown above uses the default heading level <code class="docutils literal notranslate"><span class="pre">^</span></code>. This
can be changed using the <code class="docutils literal notranslate"><span class="pre">heading-level</span></code> option, which accepts a single
character (e.g., <code class="docutils literal notranslate"><span class="pre">-</span></code>).</p>
<p>You can also pass inputs to the minigallery directive as a space separated
list of arguments:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">minigallery</span><span class="p">::</span> numpy.exp ../examples/plot_0_sin.py ../examples/plot_4*
</pre></div>
</div>
<section id="sort-mini-gallery-thumbnails-from-files">
<span id="minigallery-order"></span><h4>Sort mini-gallery thumbnails from files<a class="headerlink" href="#sort-mini-gallery-thumbnails-from-files" title="Link to this heading">#</a></h4>
<p>The <a class="reference internal" href="#minigalleries-to-examples"><span class="std std-ref">minigallery</span></a> directive generates a gallery of
thumbnails corresponding to the input file strings or object names.
You can specify minigallery thumbnails order via the <code class="docutils literal notranslate"><span class="pre">minigallery_sort_order</span></code>
configuration, which gets passed to the <a class="reference external" href="https://docs.python.org/3/library/functions.html#sorted" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sorted()</span></code></a> <code class="docutils literal notranslate"><span class="pre">key</span></code> parameter when
sorting all minigalleries.
Sorting uses the paths to the gallery examples (e.g., <code class="docutils literal notranslate"><span class="pre">path/to/plot_example.py</span></code>)
and backreferences (e.g., <code class="docutils literal notranslate"><span class="pre">path/to/numpy.exp.examples</span></code>) corresponding to the
inputs.</p>
<p>See <a class="reference internal" href="#own-sort-keys"><span class="std std-ref">Custom sort keys</span></a> for details on writing a custom sort key.</p>
<p>As an example, to put backreference thumbnails at the end, we could define the function
below in <code class="docutils literal notranslate"><span class="pre">doc/sphinxext.py</span></code> (note that backreference filenames do not start with
‚Äúplot_‚Äù and <code class="docutils literal notranslate"><span class="pre">False</span></code> gets sorted ahead of <code class="docutils literal notranslate"><span class="pre">True</span></code> as 0 is less than 1):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">function_sorter</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;plot_&quot;</span><span class="p">),</span> <span class="n">x</span><span class="p">)::</span>
</pre></div>
</div>
<p>We can then set the configuration to be (ensuring the function is
<a class="reference internal" href="#importing-callables"><span class="std std-ref">importable</span></a>):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">#...,</span>
<span class="s2">&quot;minigallery_sort_order&quot;</span><span class="p">:</span> <span class="s2">&quot;sphinxext.function_sorter&quot;</span><span class="p">,</span>
<span class="c1">#...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sphinx-Gallery would resolve <code class="docutils literal notranslate"><span class="pre">&quot;sphinxext.function_sorter&quot;</span></code> to the
<code class="docutils literal notranslate"><span class="pre">function_sorter</span></code> object.</p>
<p>Sorting the set of thumbnails generated from
<a class="reference internal" href="#references-to-examples"><span class="std std-ref">API backreferences</span></a> (i.e. the thumbnails linked
to a qualified object name input) is not supported, but the sorting function can
be used to position the entire set of backreference thumbnails since minigallery sort
gets passed the <code class="docutils literal notranslate"><span class="pre">{input}.example</span></code> backreference filename. Thumbnails may be duplicated
if they correspond to multiple object names or an object name and file/glob
input.</p>
</section>
</section>
<section id="auto-documenting-your-api-with-links-to-examples">
<h3>Auto-documenting your API with links to examples<a class="headerlink" href="#auto-documenting-your-api-with-links-to-examples" title="Link to this heading">#</a></h3>
<p>The previous feature can be automated for all your modules combining
it with the standard sphinx extensions <a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html">autodoc</a> and
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/extensions/autosummary.html">autosummary</a>.
First enable them in your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> extensions list:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sphinx_gallery</span>
<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span>
    <span class="s1">&#39;sphinx.ext.autodoc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.ext.autosummary&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx_gallery.gen_gallery&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="c1"># generate autosummary even if no references</span>
<span class="n">autosummary_generate</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p><a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html">autodoc</a> and
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/extensions/autosummary.html">autosummary</a>
are very powerful extensions, please read about them. In this example we‚Äôll
explain how the <a class="reference internal" href="reference.html#sphx-glr-api-reference"><span class="std std-ref">Sphinx-Gallery API Reference</span></a> is automatically generated. The
documentation is done at the module level. We first start with the
<code class="docutils literal notranslate"><span class="pre">reference.rst</span></code> file</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="nt">_sphx_glr_api_reference:</span>

<span class="gh">Sphinx-Gallery API Reference</span>
<span class="gh">============================</span>

<span class="p">..</span> <span class="ow">note</span><span class="p">::</span>
   Sphinx-Gallery is typically used indirectly via Sphinx execution and
   configuration variables, see <span class="na">:ref:</span><span class="nv">`configuration`</span> for how to do this.
   However, as a standard  Python project, we document many functions and
   classes as well below, even though these will typically not be needed
   by end users.

<span class="p">..</span> <span class="ow">currentmodule</span><span class="p">::</span> sphinx_gallery

<span class="p">..</span> <span class="ow">automodule</span><span class="p">::</span> sphinx_gallery
   <span class="nc">:no-members:</span>
   <span class="nc">:no-inherited-members:</span>

<span class="na">:py:mod:</span><span class="nv">`sphinx_gallery`</span>:

<span class="p">..</span> <span class="ow">autosummary</span><span class="p">::</span>
   <span class="nc">:toctree:</span> gen_modules/
   <span class="nc">:template:</span> module.rst

   gen_gallery
   backreferences
   gen_rst
   scrapers
   py_source_parser
   block_parser
   docs_resolv
   notebook
   downloads
   sorting
   interactive_example
   directives

<span class="p">..</span> <span class="ow">currentmodule</span><span class="p">::</span> sphinx_gallery.utils

<span class="p">..</span> <span class="ow">automodule</span><span class="p">::</span> sphinx_gallery.utils
   <span class="nc">:no-members:</span>
   <span class="nc">:no-inherited-members:</span>

<span class="na">:py:mod:</span><span class="nv">`sphinx_gallery.utils`</span>:

<span class="p">..</span> <span class="ow">autosummary</span><span class="p">::</span>
   <span class="nc">:toctree:</span> gen_modules/
   <span class="nc">:template:</span> module.rst

   optipng
</pre></div>
</div>
<p>The important directives are <code class="docutils literal notranslate"><span class="pre">currentmodule</span></code> where we specify which
module we are documenting, for our purpose is <code class="docutils literal notranslate"><span class="pre">sphinx_gallery</span></code>. The
<code class="docutils literal notranslate"><span class="pre">autosummary</span></code> directive is responsible for generating the <code class="docutils literal notranslate"><span class="pre">rst</span></code>
files documenting each module. <code class="docutils literal notranslate"><span class="pre">autosummary</span></code> takes the option
<em>toctree</em> which is where the <code class="docutils literal notranslate"><span class="pre">rst</span></code> files are saved and <em>template</em>
which is the file that describes how the module <code class="docutils literal notranslate"><span class="pre">rst</span></code> documentation
file is to be constructed, finally we write the modules we wish to
document, in this case all modules of Sphinx-Gallery.</p>
<p>The template file <code class="docutils literal notranslate"><span class="pre">module.rst</span></code> for the <code class="docutils literal notranslate"><span class="pre">autosummary</span></code> directive has
to be saved in the path <code class="docutils literal notranslate"><span class="pre">_templates/module.rst</span></code>. We present our
configuration in the following block. The most relevant part is the
loop defined between lines <strong>12-21</strong> that parses all the functions/classes
of the module. There we have used the <code class="docutils literal notranslate"><span class="pre">minigallery</span></code> directive introduced in
the previous section.</p>
<p>We also add a cross referencing label (on line 16) before including the
examples mini-gallery. This enables you to reference the mini-gallery for
all functions/classes of the module using
<code class="docutils literal notranslate"><span class="pre">:ref:`sphx_glr_backref_&lt;fun/class&gt;`</span></code>, where ‚Äò&lt;fun/class&gt;‚Äô is the full path
to the function/class using dot notation (e.g.,
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery.backreferences.identify_names</span></code>). For example, see:
<a class="reference internal" href="gen_modules/sphinx_gallery.backreferences.html#sphx-glr-backref-sphinx-gallery-backreferences-identify-names"><span class="std std-ref">Examples using sphinx_gallery.backreferences.identify_names</span></a>.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>{{ fullname }}
<span class="linenos"> 2</span>{{ underline }}
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="p">..</span> <span class="ow">automodule</span><span class="p">::</span> {{ fullname }}
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>   {% block functions %}
<span class="linenos"> 7</span>   {% if functions %}
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>   Functions
<span class="linenos">10</span>   ---------
<span class="linenos">11</span>
<span class="hll"><span class="linenos">12</span>   {% for item in functions %}
</span><span class="hll"><span class="linenos">13</span>
</span><span class="hll"><span class="linenos">14</span><span class="p">   ..</span> <span class="ow">autofunction</span><span class="p">::</span> {{ item }}
</span><span class="hll"><span class="linenos">15</span>
</span><span class="hll"><span class="linenos">16</span><span class="p">   ..</span> <span class="nt">_sphx_glr_backref_{{fullname}}.{{item}}:</span>
</span><span class="hll"><span class="linenos">17</span>
</span><span class="hll"><span class="linenos">18</span><span class="p">   ..</span> <span class="ow">minigallery</span><span class="p">::</span> {{fullname}}.{{item}}
</span><span class="hll"><span class="linenos">19</span>       <span class="nc">:add-heading:</span>
</span><span class="hll"><span class="linenos">20</span>
</span><span class="hll"><span class="linenos">21</span>   {%- endfor %}
</span><span class="linenos">22</span>   {% endif %}
<span class="linenos">23</span>   {% endblock %}
<span class="linenos">24</span>
<span class="linenos">25</span>   {% block classes %}
<span class="linenos">26</span>   {% if classes %}
<span class="linenos">27</span>
<span class="linenos">28</span>   Classes
<span class="linenos">29</span>   -------
<span class="linenos">30</span>
<span class="hll"><span class="linenos">31</span>   {% for item in classes %}
</span><span class="hll"><span class="linenos">32</span><span class="p">   ..</span> <span class="ow">autoclass</span><span class="p">::</span> {{ item }}
</span><span class="hll"><span class="linenos">33</span>      <span class="nc">:members:</span>
</span><span class="hll"><span class="linenos">34</span>
</span><span class="hll"><span class="linenos">35</span><span class="p">   ..</span> <span class="nt">_sphx_glr_backref_{{fullname}}.{{item}}:</span>
</span><span class="hll"><span class="linenos">36</span>
</span><span class="hll"><span class="linenos">37</span><span class="p">   ..</span> <span class="ow">minigallery</span><span class="p">::</span> {{fullname}}.{{item}}
</span><span class="hll"><span class="linenos">38</span>       <span class="nc">:add-heading:</span>
</span><span class="linenos">39</span>
<span class="linenos">40</span>   {%- endfor %}
<span class="linenos">41</span>   {% endif %}
<span class="linenos">42</span>   {% endblock %}
<span class="linenos">43</span>
<span class="linenos">44</span>   {% block exceptions %}
<span class="linenos">45</span>   {% if exceptions %}
<span class="linenos">46</span>
<span class="linenos">47</span>   Exceptions
<span class="linenos">48</span>   ----------
<span class="linenos">49</span>
<span class="linenos">50</span><span class="p">   ..</span> <span class="ow">autosummary</span><span class="p">::</span>
<span class="linenos">51</span>   {% for item in exceptions %}
<span class="linenos">52</span>      {{ item }}
<span class="linenos">53</span>   {%- endfor %}
<span class="linenos">54</span>   {% endif %}
<span class="linenos">55</span>   {% endblock %}
</pre></div>
</div>
</section>
<section id="toggling-global-variable-inspection">
<h3>Toggling global variable inspection<a class="headerlink" href="#toggling-global-variable-inspection" title="Link to this heading">#</a></h3>
<p>By default, Sphinx-Gallery will inspect global variables (and code objects)
at the end of each code block to try to find classes of variables and
method calls. It also tries to find methods called on classes.
For example, this code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
</pre></div>
</div>
<p>should end up with the following links (assuming intersphinx is set up
properly):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lst</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v3.9.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plt.subplots</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">fig</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ax</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="(in Matplotlib v3.9.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ax.plot</span></code></a></p></li>
</ul>
<p>However, this feature might not work properly in all instances.
Moreover, if variable names get reused in the same script to refer to
different classes, it will break.</p>
<p>To disable this global variable introspection, you can use the configuration
key:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;inspect_global_variables&#39;</span>  <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="stylizing-code-links-using-css">
<span id="stylizing-code-links"></span><h3>Stylizing code links using CSS<a class="headerlink" href="#stylizing-code-links-using-css" title="Link to this heading">#</a></h3>
<p>Each link in the code blocks will be decorated with two or three CSS classes.</p>
<ol class="arabic">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-module-*</span></code></dt><dd><p>CSS class named after the module where the object is documented.
<code class="docutils literal notranslate"><span class="pre">*</span></code> represents the module, e.g.,
<code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-module-matplotlib-figure</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-type-*</span></code></dt><dd><p>CSS class named after the type of the object, where <code class="docutils literal notranslate"><span class="pre">*</span></code> represents
the object type. This is a sanitized intersphinx type, e.g., a
<code class="docutils literal notranslate"><span class="pre">py:class</span></code> will have the CSS class <code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-type-py-class</span></code>.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-instance</span></code></dt><dd><p>The third ‚Äòoptional‚Äô class that is added only if the object is an
instance of a class (rather than, e.g., a class itself, method, or
function). By default, Sphinx-Gallery adds the following CSS in
<code class="docutils literal notranslate"><span class="pre">gallery.css</span></code>:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="nt">a</span><span class="p">.</span><span class="nc">sphx-glr-backref-instance</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is done to reduce the visual impact of instance linking
in example code. This means that for the following code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code>, an instance of a class, will have the
<code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-instance</span></code> CSS class, and will not be decorated.
<code class="docutils literal notranslate"><span class="pre">Figure</span></code> however, is a class, so will not have the
<code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-instance</span></code> CSS class, and will thus be decorated the
standard way for links in the given parent styles.</p>
</dd>
</dl>
</li>
</ol>
<p>These three CSS classes are meant to give fine-grained control over how
different links are decorated. For example, using CSS selectors you could
choose to avoid highlighting any <code class="docutils literal notranslate"><span class="pre">sphx-glr-backref-*</span></code> links except for ones
that you allowlist (e.g., those from your own module). For example, the
following css prevents any module except for matplotlib from being decorated:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="nt">a</span><span class="o">[</span><span class="nt">class</span><span class="o">^=</span><span class="s2">&quot;sphx-glr-backref-module-&quot;</span><span class="o">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">a</span><span class="o">[</span><span class="nt">class</span><span class="o">^=</span><span class="s2">&quot;sphx-glr-backref-module-matplotlib&quot;</span><span class="o">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">underline</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are likely elements other than <code class="docutils literal notranslate"><span class="pre">text-decoration</span></code> that might be worth
setting, as well.</p>
<p>You can add these CSS classes by including your own CSS file via the Sphinx
configuration <a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/configuration.html#confval-html_static_path" title="(in Sphinx v8.1.0)"><code class="docutils literal notranslate"><span class="pre">html_static_path</span></code></a>, which will override the
default CSS classes in <a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/tree/master/sphinx_gallery/_static">Sphinx-Gallery CSS files</a>.</p>
</section>
</section>
<section id="using-a-custom-default-thumbnail">
<span id="custom-default-thumb"></span><h2>Using a custom default thumbnail<a class="headerlink" href="#using-a-custom-default-thumbnail" title="Link to this heading">#</a></h2>
<p>In case you want to use your own image for the thumbnail of examples that do
not generate any plot, you can specify it by editing your Sphinx <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>
file. You need to add to the configuration dictionary a key called
<cite>default_thumb_file</cite>. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;default_thumb_file&#39;</span><span class="p">:</span> <span class="s1">&#39;path/to/thumb/file.png&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="adding-line-numbers-to-examples">
<span id="adding-line-numbers"></span><h2>Adding line numbers to examples<a class="headerlink" href="#adding-line-numbers-to-examples" title="Link to this heading">#</a></h2>
<p>Line numbers can be displayed in listings by adding the global <code class="docutils literal notranslate"><span class="pre">line_numbers</span></code>
setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;line_numbers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or by adding a comment to the example script, which overrides any global
setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_line_numbers = True</span>
</pre></div>
</div>
</section>
<section id="removing-config-comments">
<span id="id6"></span><h2>Removing config comments<a class="headerlink" href="#removing-config-comments" title="Link to this heading">#</a></h2>
<p>Some configurations can be specified within a file by adding a special
comment with the pattern <code class="samp docutils literal notranslate"><span class="pre">#</span> <span class="pre">sphinx_gallery_</span><em><span class="pre">config</span></em> <span class="pre">[=</span> <em><span class="pre">value</span></em><span class="pre">]</span></code> to the
example source files. By default, the source files are parsed as is and thus
the comment will appear in the example.</p>
<p>To remove the comment from the rendered example set the option:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;remove_config_comments&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This only removes configuration comments from code blocks, not from text
blocks. However, note that technically, file-level configuration comments will
work when put in either code blocks or text blocks.</p>
</section>
<section id="add-your-own-first-and-last-notebook-cell">
<span id="own-notebook-cell"></span><h2>Add your own first and last notebook cell<a class="headerlink" href="#add-your-own-first-and-last-notebook-cell" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery allows you to add your own first and/or last cell to <em>every</em>
generated notebook. Adding a first cell can be useful for including code that
is required to run properly in the notebook, but not in a <code class="docutils literal notranslate"><span class="pre">.py</span></code> file. By
default, no first cell is added.</p>
<p>Adding a last cell can be useful for performing a desired action such as
reporting on the user‚Äôs environment. By default no last cell is added.</p>
<p>You can choose whatever text you like by modifying the <code class="docutils literal notranslate"><span class="pre">first_notebook_cell</span></code>
and <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code> configuration parameters. For example, you can add
the following first cell:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="c1"># This cell is added by Sphinx-Gallery</span>
<span class="c1"># It can be customized to whatever you like</span>
</pre></div>
</div>
<p>Which is achieved by the following configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;first_notebook_cell&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;# This cell is added by Sphinx-Gallery</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;# It can be customized to whatever you like</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A last cell may be added similarly by setting the <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code>
parameter:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;first_notebook_cell&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;# This cell is added by Sphinx-Gallery</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;# It can be customized to whatever you like</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="p">),</span>
    <span class="s1">&#39;last_notebook_cell&#39;</span><span class="p">:</span> <span class="s2">&quot;# This is the last cell&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the value of <code class="docutils literal notranslate"><span class="pre">first_notebook_cell</span></code> or <code class="docutils literal notranslate"><span class="pre">last_notebook_cell</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then no extra first or last cell will be added to the notebook.</p>
</section>
<section id="adding-images-to-notebooks">
<span id="notebook-images"></span><h2>Adding images to notebooks<a class="headerlink" href="#adding-images-to-notebooks" title="Link to this heading">#</a></h2>
<p>When notebooks are produced, by default (<code class="docutils literal notranslate"><span class="pre">notebook_images</span> <span class="pre">=</span> <span class="pre">False</span></code>) image
paths from the <cite>image</cite> directive in reST documentation blocks (not images
generated from code) are included in markdown using their original paths. This
includes paths to images expected to be present on the local filesystem which
is unlikely to be the case for those downloading the notebook.</p>
<p>By setting <code class="docutils literal notranslate"><span class="pre">notebook_images</span> <span class="pre">=</span> <span class="pre">True</span></code>, images will be embedded in the generated
notebooks via Base64-encoded <a class="reference external" href="https://en.wikipedia.org/wiki/Data_URI_scheme">data URIs</a>.
As inclusion of images via data URIs can significantly increase size of the
notebook, it‚Äôs suggested this only be used when small images are used throughout
galleries.</p>
<p>An alternative is to instead provide a prefix string that‚Äôll be used for images
e.g. the root URL of where your documentation is hosted. So for example the
following configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;examples_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples&#39;</span><span class="p">],</span>
    <span class="s1">&#39;gallery_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto_examples&#39;</span><span class="p">],</span>
    <span class="o">...</span>
    <span class="s1">&#39;notebook_images&#39;</span><span class="p">:</span> <span class="s1">&#39;https://project.example.com/en/latest/&#39;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>with an example <cite>image</cite> directive in an reST documentation block being:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">image</span><span class="p">::</span> ../_static/example.jpg
    <span class="nc">:alt:</span> An example image
</pre></div>
</div>
<p>The image will be added to the generated notebook pointing to the source URL
<code class="docutils literal notranslate"><span class="pre">https://project.example.com/en/latest/_static/example.jpg</span></code>. Note the image
path in the reST examples above is a relative path, therefore the URL doesn‚Äôt
contain <code class="docutils literal notranslate"><span class="pre">auto_examples</span></code> as <code class="docutils literal notranslate"><span class="pre">../</span></code> moved up a directory to the documentation
source directory. Both relative and absolute (from source directory) paths are
supported; so in the example above <code class="docutils literal notranslate"><span class="pre">/_static/example.jpg</span></code> would have resulted
in the same URL being produced.</p>
<p>Note that the prefix is applied directly, so a trailing <code class="docutils literal notranslate"><span class="pre">/</span></code> should be
included in the prefix if it‚Äôs required.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If building multiple versions of your documentation on a hosted service and
using prefix, consider using <a class="reference external" href="https://www.sphinx-doc.org/en/master/man/sphinx-build.html#cmdoption-sphinx-build-D">sphinx build -D</a>
command line option to ensure links point to the correct version. For
example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sphinx-build<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-b<span class="w"> </span>html<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-D<span class="w"> </span>sphinx_gallery_conf.notebook_images<span class="o">=</span><span class="s2">&quot;https://project.example.com/docs/</span><span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span><span class="s2">/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>source_dir<span class="w"> </span>build_dir
</pre></div>
</div>
</div>
</section>
<section id="using-pypandoc-to-convert-rest-to-markdown">
<span id="use-pypandoc"></span><h2>Using pypandoc to convert reST to markdown<a class="headerlink" href="#using-pypandoc-to-convert-rest-to-markdown" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery can use <a class="reference external" href="https://github.com/bebraw/pypandoc">pypandoc</a>
(if installed) to convert reST text blocks to markdown for the iPython
notebooks (<code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> files) generated for each example. These are made
available for download, along with the raw <code class="docutils literal notranslate"><span class="pre">.py</span></code> version, at the bottom
of each example.</p>
<p>The Sphinx-Gallery reST to markdown converter has limited support for more
complex reST syntax. If your examples have more complex reST, <code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> may
produce better results. By default, the ‚Äòpypandoc‚Äô configuration is set to
<code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> is not used.</p>
<p>To use <code class="docutils literal notranslate"><span class="pre">pypandoc</span></code> you can set:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;pypandoc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can also use pandoc options by setting the <code class="docutils literal notranslate"><span class="pre">pypandoc.convert_text()</span></code>
parameters <code class="docutils literal notranslate"><span class="pre">extra_args</span></code> and <code class="docutils literal notranslate"><span class="pre">filters</span></code>. To use these parameters, set the
‚Äòpypandoc‚Äô configuration to be a dictionary of keyword argument(s):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;pypandoc&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;extra_args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;--mathjax&#39;</span><span class="p">,],</span>
                 <span class="s1">&#39;filters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;pandoc-citeproc&#39;</span><span class="p">,],</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Certain pandoc options may result in undesirable effects. Use with caution.</p>
</div>
</section>
<section id="using-junit-xml-files">
<span id="junit-xml"></span><h2>Using JUnit XML files<a class="headerlink" href="#using-junit-xml-files" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery can create a JUnit XML file of your example run times,
successes, and failures. To create a file named e.g. <code class="docutils literal notranslate"><span class="pre">junit-result.xml</span></code>
in the <code class="docutils literal notranslate"><span class="pre">/build</span></code> output directory, set the configuration key (path is relative
to the HTML output directory):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;junit&#39;</span><span class="p">:</span> <span class="s1">&#39;../test-results/sphinx-gallery/junit.xml&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By default, JUnit XML file generation is disabled (by setting <code class="docutils literal notranslate"><span class="pre">'junit':</span> <span class="pre">''</span></code>).
JUnit XML files are useful for example on CircleCI builds, where you can add
a line like this to get a summary of your example run times in the CircleCI GUI
(which will parse the file path
<code class="docutils literal notranslate"><span class="pre">doc/_build/test-results/sphinx-gallery/junit.xml</span></code> and infer the tests
came from <code class="docutils literal notranslate"><span class="pre">sphinx-gallery</span></code> based on the nested subdirectory name):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">store_test_results</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">doc/_build/test-results</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">store_artifacts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">doc/_build/test-results</span>
</pre></div>
</div>
<p>For more information on CircleCI integration, peruse the related
<a class="reference external" href="https://circleci.com/docs/2.0/collect-test-data/#metadata-collection-in-custom-test-steps">CircleCI doc</a>
and <a class="reference external" href="https://circleci.com/blog/how-to-output-junit-tests-through-circleci-2-0-for-expanded-insights/">blog post</a>.</p>
</section>
<section id="setting-log-level">
<span id="log-level"></span><h2>Setting log level<a class="headerlink" href="#setting-log-level" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery logs output at several stages. Warnings can be generated for
code that requires case sensitivity (e.g., <code class="docutils literal notranslate"><span class="pre">plt.subplot</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.Subplot</span></code>)
when building docs on a filesystem that does not support case sensitive
naming (e.g., Windows). In this case, by default a <code class="docutils literal notranslate"><span class="pre">logger.warning</span></code> is
emitted, which will lead to a build failure when building with <code class="docutils literal notranslate"><span class="pre">-W</span></code>.
The log level can be set with:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;log_level&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;backreference_missing&#39;</span><span class="p">:</span> <span class="s1">&#39;warning&#39;</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The only valid key currently is <code class="docutils literal notranslate"><span class="pre">backreference_missing</span></code>.
The valid values are <code class="docutils literal notranslate"><span class="pre">'debug'</span></code>, <code class="docutils literal notranslate"><span class="pre">'info'</span></code>, <code class="docutils literal notranslate"><span class="pre">'warning'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'error'</span></code>.</p>
</section>
<section id="disabling-download-button-of-all-scripts">
<span id="disable-all-scripts-download"></span><h2>Disabling download button of all scripts<a class="headerlink" href="#disabling-download-button-of-all-scripts" title="Link to this heading">#</a></h2>
<p>By default Sphinx-Gallery collects all python scripts and all Jupyter
notebooks from each gallery into zip files which are made available for
download at the bottom of each gallery. To disable this behavior add to the
configuration dictionary in your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;download_all_examples&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="choosing-the-thumbnail-image">
<span id="choosing-thumbnail"></span><h2>Choosing the thumbnail image<a class="headerlink" href="#choosing-the-thumbnail-image" title="Link to this heading">#</a></h2>
<p>For examples that generate multiple figures, the default behavior will use
the first figure created in each as the thumbnail image displayed in the
gallery. To change the thumbnail image to a figure generated later in
an example script, add a comment to the example script to specify the
number of the figure you would like to use as the thumbnail. For example,
to use the 2nd figure created as the thumbnail:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<p>You can also use negative numbers, which counts from the last figure.
For example -1 means using the last figure created in the example
as the thumbnail:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = -1</span>
</pre></div>
</div>
<p>The default behavior is <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_thumbnail_number</span> <span class="pre">=</span> <span class="pre">1</span></code>. See
<a class="reference internal" href="auto_examples/plot_4_choose_thumbnail.html#sphx-glr-auto-examples-plot-4-choose-thumbnail-py"><span class="std std-ref">Choosing the thumbnail figure</span></a> for an example
of this functionality.</p>
</section>
<section id="providing-an-image-for-the-thumbnail-image">
<span id="providing-thumbnail"></span><h2>Providing an image for the thumbnail image<a class="headerlink" href="#providing-an-image-for-the-thumbnail-image" title="Link to this heading">#</a></h2>
<p>An arbitrary image can be used to serve as the thumbnail image for an example.
To specify an image to serve as the thumbnail, add a comment to the example
script specifying the path to the desired image. The path to the image should
be relative to the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file and the comment should be somewhere
below the docstring (ideally in a code block, see
<a class="reference internal" href="#removing-config-comments"><span class="std std-ref">Removing config comments</span></a>).</p>
<p>For example, the following defines that the image <code class="docutils literal notranslate"><span class="pre">demo.png</span></code> in the folder
<code class="docutils literal notranslate"><span class="pre">_static/</span></code> should be used to create the thumbnail:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_path = &#39;_static/demo.png&#39;</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_thumbnail_number</span></code> overrules
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_thumbnail_path</span></code>. See
<a class="reference internal" href="auto_examples/plot_4b_provide_thumbnail.html#sphx-glr-auto-examples-plot-4b-provide-thumbnail-py"><span class="std std-ref">Providing a figure for the thumbnail image</span></a> for an example of
this functionality.</p>
</section>
<section id="controlling-thumbnail-behaviour-in-failing-examples">
<span id="failing-thumbnail"></span><h2>Controlling thumbnail behaviour in failing examples<a class="headerlink" href="#controlling-thumbnail-behaviour-in-failing-examples" title="Link to this heading">#</a></h2>
<p>By default, expected failing examples will have their thumbnail image as a
stamp with the word ‚ÄúBROKEN‚Äù. This behaviour is controlled by
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_failing_thumbnail</span></code>, which is by default <code class="docutils literal notranslate"><span class="pre">True</span></code>. In cases
where control over the thumbnail image is desired, this should be set to
<code class="docutils literal notranslate"><span class="pre">False</span></code>. This will return thumbnail behaviour to ‚Äònormal‚Äô, whereby
thumbnail will be either the first figure created (or the
<a class="reference internal" href="#custom-default-thumb"><span class="std std-ref">default thumbnail</span></a> if no figure is created)
or <a class="reference internal" href="#providing-thumbnail"><span class="std std-ref">provided thumbnail</span></a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_failing_thumbnail = False</span>
</pre></div>
</div>
<p>Compare the thumbnails of
<a class="reference internal" href="auto_examples/no_output/plot_raise_thumbnail.html#sphx-glr-auto-examples-no-output-plot-raise-thumbnail-py"><span class="std std-ref">Example that fails to execute (with normal thumbnail behaviour)</span></a> (where the
option is <code class="docutils literal notranslate"><span class="pre">False</span></code>) and <a class="reference internal" href="auto_examples/no_output/plot_raise.html#sphx-glr-auto-examples-no-output-plot-raise-py"><span class="std std-ref">Example that fails to execute</span></a>
(where the option is the default <code class="docutils literal notranslate"><span class="pre">True</span></code>) for an example of this
functionality.</p>
</section>
<section id="generate-binder-links-for-gallery-notebooks-experimental">
<span id="binder-links"></span><h2>Generate Binder links for gallery notebooks (experimental)<a class="headerlink" href="#generate-binder-links-for-gallery-notebooks-experimental" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery automatically generates Jupyter notebooks for any
examples built with the gallery. <a class="reference external" href="https://mybinder.org">Binder</a> makes it
possible to create interactive GitHub repositories that connect to cloud
resources.</p>
<p>If you host your documentation on a GitHub repository, it is possible to
auto-generate a Binder link for each notebook. Clicking this link will
take users to a live version of the Jupyter notebook where they may
run the code interactively. For more information see the <a class="reference external" href="https://mybinder.readthedocs.io/en/latest/">Binder documentation</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Binder is still beta technology, so there may be instability in the
experience of users who click Binder links.</p>
</div>
<p>In order to enable Binder links with Sphinx-Gallery, you must specify
a few pieces of information in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>. These are given as a nested
dictionary following the pattern below:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">...</span>
  <span class="s1">&#39;binder&#39;</span><span class="p">:</span> <span class="p">{</span>
     <span class="c1"># Required keys</span>
     <span class="s1">&#39;org&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;github_org&gt;&#39;</span><span class="p">,</span>
     <span class="s1">&#39;repo&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;github_repo&gt;&#39;</span><span class="p">,</span>
     <span class="s1">&#39;branch&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;github_branch&gt;&#39;</span><span class="p">,</span> <span class="c1"># Can be any branch, tag, or commit hash. Use a branch that hosts your docs.</span>
     <span class="s1">&#39;binderhub_url&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;binder_url&gt;&#39;</span><span class="p">,</span> <span class="c1"># Any URL of a binderhub deployment. Must be full URL (e.g. https://mybinder.org).</span>
     <span class="s1">&#39;dependencies&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;list_of_paths_to_dependency_files&gt;&#39;</span><span class="p">,</span>
     <span class="c1"># Optional keys</span>
     <span class="s1">&#39;filepath_prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;prefix&gt;&#39;</span> <span class="c1"># A prefix to prepend to any filepaths in Binder links.</span>
     <span class="s1">&#39;notebooks_dir&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;notebooks-directory-name&gt;&#39;</span> <span class="c1"># Jupyter notebooks for Binder will be copied to this directory (relative to built documentation root).</span>
     <span class="s1">&#39;use_jupyter_lab&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">bool</span><span class="o">&gt;</span> <span class="c1"># Whether Binder links should start Jupyter Lab instead of the Jupyter Notebook interface.</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If a Sphinx-Gallery configuration for Binder is discovered, the following extra
things will happen:</p>
<ol class="arabic">
<li><p>The dependency files specified in <code class="docutils literal notranslate"><span class="pre">dependencies</span></code> will be copied to a
<code class="docutils literal notranslate"><span class="pre">binder/</span></code> folder in your built documentation.</p></li>
<li><p>The built Jupyter Notebooks from the documentation will be copied to a
folder called <code class="docutils literal notranslate"><span class="pre">&lt;notebooks_dir/&gt;</span></code> at the root of
your built documentation (they will follow the same folder hierarchy within
the notebooks directory folder.</p></li>
<li><p>The reST output of each Sphinx-Gallery example will now have a
<code class="docutils literal notranslate"><span class="pre">launch</span> <span class="pre">binder</span></code> button in it.</p></li>
<li><p>That button will point to a binder link with the following structure</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">binderhub_url</span><span class="p">&gt;</span>/v2/gh/<span class="p">&lt;</span><span class="nt">org</span><span class="p">&gt;</span>/<span class="p">&lt;</span><span class="nt">repo</span><span class="p">&gt;</span>/<span class="p">&lt;</span><span class="nt">ref</span><span class="p">&gt;</span>?filepath=<span class="p">&lt;</span><span class="nt">filepath_prefix</span><span class="p">&gt;</span>/<span class="p">&lt;</span><span class="nt">notebooks_dir</span><span class="p">&gt;</span>/path/to/notebook.ipynb
</pre></div>
</div>
</li>
</ol>
<p>Below is a more complete explanation of each field.</p>
<dl class="simple">
<dt>org (type: string)</dt><dd><p>The GitHub organization where your documentation is stored.</p>
</dd>
<dt>repo (type: string)</dt><dd><p>The GitHub repository where your documentation is stored.</p>
</dd>
<dt>branch (type: string)</dt><dd><p>A reference to the version of your repository where your documentation exists.
For example, if your built documentation is stored on a <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch,
then this field should be set to <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code>.</p>
</dd>
<dt>binderhub_url (type: string)</dt><dd><p>The full URL to a BinderHub deployment where you want your examples to run.
One public BinderHub deployment is at <code class="docutils literal notranslate"><span class="pre">https://mybinder.org</span></code>, though if you
(and your users) have access to another, this can be configured with this
field.</p>
</dd>
<dt>dependencies (type: list)</dt><dd><p>A list of paths (relative to <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>) to dependency files that Binder uses
to infer the environment needed to run your examples. For example, a
<code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file. These will be copied into a folder  called
<code class="docutils literal notranslate"><span class="pre">binder/</span></code> in your built documentation folder. For a list of all the possible
dependency files you can use, see <a class="reference external" href="https://mybinder.readthedocs.io/en/latest/using/config_files.html">the Binder configuration documentation</a>.</p>
</dd>
<dt>filepath_prefix (type: string | None, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>A prefix to append to the filepath in the Binder links. You should use this if
you will store your built documentation in a sub-folder of a repository,
instead of in the root.</p>
</dd>
<dt>notebooks_dir (type: string, default: <code class="docutils literal notranslate"><span class="pre">notebooks</span></code>)</dt><dd><p>The name of a folder where the built Jupyter notebooks will be copied. This
ensures that all the notebooks are in one place (though they retain their
folder hierarchy) in case you‚Äôd like users to browse multiple notebook
examples in one session.</p>
</dd>
<dt>use_jupyter_lab (type: bool, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</dt><dd><p>Whether the default interface activated by the Binder link will be for
Jupyter Lab or the classic Jupyter Notebook interface.</p>
</dd>
</dl>
<p>Each generated Jupyter Notebook will be copied to the folder
specified in <code class="docutils literal notranslate"><span class="pre">notebooks_dir</span></code>. This will be a subfolder of the sphinx output
directory and included with your site build.
Binder links will point to these notebooks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not currently possible to host notebooks generated by
Sphinx-Gallery with readthedocs.org, as RTD does not provide you
with a GitHub repository you could link Binder to. If you‚Äôd like to
use readthedocs with Sphinx-Gallery and Binder links, you should
independently build your documentation and host it on a GitHub branch
as well as building it with readthedocs.</p>
</div>
<p>See the Sphinx-Gallery <a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/blob/master/doc/conf.py">Sphinx configuration file</a>
for an example that uses the <a class="reference external" href="https://mybinder.org">public Binder server</a>.</p>
</section>
<section id="generate-jupyterlite-links-for-gallery-notebooks-experimental">
<span id="jupyterlite"></span><h2>Generate JupyterLite links for gallery notebooks (experimental)<a class="headerlink" href="#generate-jupyterlite-links-for-gallery-notebooks-experimental" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery automatically generates Jupyter notebooks for any examples built
with the gallery. <a class="reference external" href="https://jupyterlite.readthedocs.io">JupyterLite</a> makes it
possible to run an example in your browser. The functionality is quite similar
to Binder in the sense that you will get a Jupyter environment where you can
run the example interactively as a notebook. The main difference with Binder
are:</p>
<ul class="simple">
<li><p>with JupyterLite, the example actually runs in your browser, there is no need
for a separate machine in the cloud to run your Python code. That means that
starting a Jupyter server is generally quicker, no need to wait for the
Binder image to be built</p></li>
<li><p>with JupyterLite the first imports take time. At the time of writing
(February 2023) <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">scipy</span></code> can take ~15-30s. Some innocuously looking
Python code may just not work and break in an unexpected fashion. The Jupyter
kernel is based on Pyodide, see <a class="reference external" href="https://pyodide.org/en/latest/usage/wasm-constraints.html">here</a> for some
Pyodide limitations.</p></li>
<li><p>with JupyterLite environments are not as flexible as Binder, for example you
can not use a docker image but only the default <a class="reference external" href="https://pyodide.org/en/stable/index.html">Pyodide</a> environment. That means that
some non pure-Python packages may not be available, see list of <a class="reference external" href="https://pyodide.org/en/stable/usage/packages-in-pyodide.html">available
packages in Pyodide</a>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>JupyterLite is still beta technology and less mature than Binder, so there
may be instability or unexpected behaviour in the experience of users who
click JupyterLite links.</p>
</div>
<p>In order to enable JupyterLite links with Sphinx-Gallery, you need to install
the <a class="reference external" href="https://jupyterlite-sphinx.readthedocs.io">jupyterlite-sphinx</a> package.
For <cite>jupyterlite-sphinx&gt;=0.8</cite> (released 15 March 2023) you also need to install
<cite>jupyterlite-pyodide-kernel</cite>.</p>
<p>You then need to add <cite>jupyterlite_sphinx</cite> to your Sphinx extensions in
<code class="docutils literal notranslate"><span class="pre">conf.py</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="s1">&#39;jupyterlite_sphinx&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>You can configure JupyterLite integration by setting
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf['jupyterlite']</span></code> in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> like this:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">...</span>
  <span class="s1">&#39;jupyterlite&#39;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s1">&#39;use_jupyter_lab&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">bool</span><span class="o">&gt;</span><span class="p">,</span> <span class="c1"># Whether JupyterLite links should start Jupyter Lab instead of the Retrolab Notebook interface.</span>
     <span class="s1">&#39;notebook_modification_function&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">str</span><span class="o">&gt;</span><span class="p">,</span> <span class="c1"># fully qualified name of a function that implements JupyterLite-specific modifications of notebooks</span>
     <span class="s1">&#39;jupyterlite_contents&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">str</span><span class="o">&gt;</span><span class="p">,</span> <span class="c1"># where to copy the example notebooks (relative to Sphinx source directory)</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below is a more complete explanation of each field.</p>
<dl class="simple">
<dt>use_jupyter_lab (type: bool, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</dt><dd><p>Whether the default interface activated by the JupyterLite link will be for
Jupyter Lab or the RetroLab Notebook interface.</p>
</dd>
<dt>notebook_modification_function (type: str, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Fully qualified name of a
function that implements JupyterLite-specific modifications of notebooks. By
default, it is <code class="docutils literal notranslate"><span class="pre">None</span></code> which means that notebooks are not going to be
modified. Its signature should be <code class="docutils literal notranslate"><span class="pre">notebook_modification_function(json_dict:</span>
<span class="pre">dict,</span> <span class="pre">notebook_filename:</span> <span class="pre">str)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code> where <code class="docutils literal notranslate"><span class="pre">json_dict</span></code> is what you get
when you do <code class="docutils literal notranslate"><span class="pre">json.load(open(notebook_filename))</span></code>. The function is expected
to modify <code class="docutils literal notranslate"><span class="pre">json_dict</span></code> in place by adding notebook cells. It is not expected
to write to the file, since <code class="docutils literal notranslate"><span class="pre">sphinx-gallery</span></code> is in charge of this.
<code class="docutils literal notranslate"><span class="pre">notebook_filename</span></code> is provided for convenience because it is useful to
modify the notebook based on its filename. Potential usages of this function
are installing additional packages with a <code class="docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span> <span class="pre">seaborn</span></code> code cell,
or adding a markdown cell to indicate that a notebook is not expected to work
inside JupyterLite, for example because it is using packages that are not
packaged inside Pyodide. For backward compatibility it can also be a callable
but this will not be cached properly as part of the environment by Sphinx.</p>
</dd>
<dt>jupyterlite_contents (type: string, default: <code class="docutils literal notranslate"><span class="pre">jupyterlite_contents</span></code>)</dt><dd><p>The name of a folder where the built Jupyter notebooks will be copied,
relative to the Sphinx source directory. This is used as Jupyterlite
contents.</p>
</dd>
</dl>
<p>You can set variables in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> to configure <code class="docutils literal notranslate"><span class="pre">jupyterlite-sphinx</span></code>, see
the <a class="reference external" href="https://jupyterlite-sphinx.readthedocs.io/en/latest/configuration.html">jupyterlite-sphinx doc</a> for
more details.</p>
<p>If a Sphinx-Gallery configuration for JupyterLite is discovered, the following
extra things will happen:</p>
<ol class="arabic simple">
<li><p>Configure <code class="docutils literal notranslate"><span class="pre">jupyterlite-sphinx</span></code> with some reasonable defaults, e.g. set
<code class="docutils literal notranslate"><span class="pre">jupyterlite_bind_ipynb_suffix</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p></li>
<li><p>The built Jupyter Notebooks from the documentation will be copied to a
folder called <code class="docutils literal notranslate"><span class="pre">&lt;jupyterlite_contents&gt;/</span></code> (relative to Sphinx source
directory)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">notebook_modification_function</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, this function is
going to add JupyterLite-specific modifications to notebooks</p></li>
<li><p>The reST output of each Sphinx-Gallery example will now have a
<code class="docutils literal notranslate"><span class="pre">launch</span> <span class="pre">JupyterLite</span></code> button in it.</p></li>
<li><p>That button will point to a JupyterLite link which will start a Jupyter
server in your browser with the current example as notebook</p></li>
</ol>
<p>If, for some reason, you want to enable the <code class="docutils literal notranslate"><span class="pre">jupyterlite-sphinx</span></code> extension
but not use Sphinx-Gallery Jupyterlite integration you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="n">jupyterlite_sphinx</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">...</span>
  <span class="s1">&#39;jupyterlite&#39;</span><span class="p">:</span> <span class="kc">None</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See the Sphinx-Gallery <a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/blob/master/doc/conf.py">Sphinx configuration file</a>
for an example that uses the JupyterLite integration.</p>
</section>
<section id="controlling-notebook-download-links">
<span id="notebook-extensions"></span><h2>Controlling notebook download links<a class="headerlink" href="#controlling-notebook-download-links" title="Link to this heading">#</a></h2>
<p>By default, links to download Jupyter noteooks and launch Binder or JupyterLite (if
enabled) are shown only for Python examples. If parsing other file extensions has been
enabled (using the <code class="docutils literal notranslate"><span class="pre">example_extensions</span></code> option; see <a class="reference internal" href="#build-pattern"><span class="std std-ref">Parsing and executing examples via matching patterns</span></a>), notebook
downloads can be enabled using the <code class="docutils literal notranslate"><span class="pre">notebook_extensions</span></code> option. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;notebook_extensions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;.py&quot;</span><span class="p">,</span> <span class="s2">&quot;.jl&quot;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>where the listed extensions are compared to file names in the gallery directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, all generated notebooks specify Python as the kernel. After downloading,
the user will need to manually change to the correct kernel.</p>
</div>
</section>
<section id="making-cell-magic-executable-in-notebooks">
<span id="promote-jupyter-magic"></span><h2>Making cell magic executable in notebooks<a class="headerlink" href="#making-cell-magic-executable-in-notebooks" title="Link to this heading">#</a></h2>
<p>Often times, tutorials will include bash code for the user to copy/paste into
their terminal. This code should not be run when someone is building the
documentation, as they will already have those dependencies in their
environment. Hence they are normally written as code blocks inside text:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%</span>
<span class="c1"># Installing dependencies</span>
<span class="c1">#</span>
<span class="c1">#     .. code-block:: bash</span>
<span class="c1">#</span>
<span class="c1">#       pip install -q tensorflow</span>
<span class="c1">#       apt-get -qq install curl</span>
</pre></div>
</div>
<p>This works fine for the <code class="docutils literal notranslate"><span class="pre">.py</span></code> and <code class="docutils literal notranslate"><span class="pre">.html</span></code> files, but causes problems when
rendered as an Jupyter notebook. The downloaded <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file will not have
those dependencies installed, and will not work without running the bash code.</p>
<p>To fix this, we can set the <code class="docutils literal notranslate"><span class="pre">promote_jupyter_magic</span></code> flag in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;promote_jupyter_magic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If this flag is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then when a Jupyter notebook is being built, any code
block starting with <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html">Jupyter cell magics</a> (e.g. <code class="docutils literal notranslate"><span class="pre">%%bash</span></code> or <code class="docutils literal notranslate"><span class="pre">%%writefile</span></code>)
will be turned into a runnable code block.</p>
<p>For our earlier example, we could change the Markdown text to:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%</span>
<span class="c1"># Installing dependencies</span>
<span class="c1">#</span>
<span class="c1">#     .. code-block:: bash</span>
<span class="c1">#</span>
<span class="c1">#       %%bash</span>
<span class="c1">#       pip install -q tensorflow</span>
<span class="c1">#       apt-get -qq install curl</span>
</pre></div>
</div>
<p>meaning TensorFlow and Curl would be automatically installed upon running the
Jupyter notebook. This works for any cell magic (not just those mentioned above)
and only affects the creation of Jupyter notebooks.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is good practice to ensure the <code class="docutils literal notranslate"><span class="pre">.py</span></code> and <code class="docutils literal notranslate"><span class="pre">.html</span></code> files match the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code>
files as closely as possible. This functionality should only be used when the
relevant code is intended to be executed by the end user.</p>
</div>
</section>
<section id="building-without-executing-examples">
<span id="without-execution"></span><h2>Building without executing examples<a class="headerlink" href="#building-without-executing-examples" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery can parse all your examples and build the gallery
without executing any of the scripts. This is just for speed
visualization processes of the gallery and the size it takes your
website to display, or any use you can imagine for it. To achieve this you
need to pass the no plot option in the build process by modifying
your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> with:</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="nf">html-noplot</span><span class="o">:</span>
<span class="w">    </span><span class="k">$(</span>SPHINXBUILD<span class="k">)</span><span class="w"> </span>-D<span class="w"> </span><span class="nv">plot_gallery</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>-b<span class="w"> </span>html<span class="w"> </span><span class="k">$(</span>ALLSPHINXOPTS<span class="k">)</span><span class="w"> </span><span class="k">$(</span>SOURCEDIR<span class="k">)</span><span class="w"> </span><span class="k">$(</span>BUILDDIR<span class="k">)</span>/html
<span class="w">    </span>@echo
<span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;Build finished. The HTML pages are in </span><span class="k">$(</span>BUILDDIR<span class="k">)</span><span class="s2">/html.&quot;</span>
</pre></div>
</div>
<p>Remember that for <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> white space is significant and the indentation are tabs
and not spaces.</p>
<p>Alternatively, you can add the <code class="docutils literal notranslate"><span class="pre">plot_gallery</span></code> option to the
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code> dictionary inside your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> to have it as
a default:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;plot_gallery&#39;</span><span class="p">:</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The highest precedence is always given to the <cite>-D</cite> flag of the
<code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> command.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If adding <code class="docutils literal notranslate"><span class="pre">html-noplot</span></code> to your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, you will also need to
explicitly set the default value for <code class="docutils literal notranslate"><span class="pre">plot_gallery</span></code> in the
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code> dictionary inside your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file to avoid
a sphinx configuration warning.</p>
</div>
</section>
<section id="compressing-images">
<span id="compress-images"></span><h2>Compressing images<a class="headerlink" href="#compressing-images" title="Link to this heading">#</a></h2>
<p>When writing PNG files (the default scraper format), Sphinx-Gallery can be
configured to use <code class="docutils literal notranslate"><span class="pre">optipng</span></code> to optimize the PNG file sizes. Typically this
yields roughly a 50% reduction in file sizes, thus reducing the loading time
of galleries. However, it can increase build
time. The allowed values are <code class="docutils literal notranslate"><span class="pre">'images'</span></code> and <code class="docutils literal notranslate"><span class="pre">'thumbnails'</span></code>, or a
tuple/list (to optimize both), such as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;compress_images&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnails&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default is <code class="docutils literal notranslate"><span class="pre">()</span></code> (no optimization) and a warning will be emitted if
optimization is requested but <code class="docutils literal notranslate"><span class="pre">optipng</span></code> is not available. You can also pass
additional command-line options (starting with <code class="docutils literal notranslate"><span class="pre">'-'</span></code>), for example to
optimize less but speed up the build time you could do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;compress_images&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnails&#39;</span><span class="p">,</span> <span class="s1">&#39;-o1&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">optipng</span> <span class="pre">--help</span></code> for a complete list of options.</p>
</section>
<section id="multi-resolution-images">
<span id="image-srcset"></span><h2>Multi-resolution images<a class="headerlink" href="#multi-resolution-images" title="Link to this heading">#</a></h2>
<p>Web browsers allow a <code class="docutils literal notranslate"><span class="pre">srcset</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> tag that
allows the browser to support <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images">responsive resolution images</a>
for hi-dpi/retina displays. Sphinx Gallery supports this via the
<code class="docutils literal notranslate"><span class="pre">image_srcset</span></code> parameter:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;image_srcset&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2x&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>that saves a 1x image at the normal figure dpi (usually 100 dpi) and a 2x
version at twice the density (e.g. 200 dpi). The default is no extra images
(<code class="docutils literal notranslate"><span class="pre">'image_srcset':</span> <span class="pre">[]</span></code>), and you can specify other resolutions if desired as a
list: <code class="docutils literal notranslate"><span class="pre">[&quot;2x&quot;,</span> <span class="pre">&quot;1.5x&quot;]</span></code>.</p>
<p>The matplotlib scraper creates a custom image directive, <code class="docutils literal notranslate"><span class="pre">image-sg</span></code> in the
rst file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">image</span><span class="o">-</span><span class="n">sg</span><span class="p">::</span> <span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">sphx_glr_test_001</span><span class="o">.</span><span class="n">png</span>
    <span class="p">:</span><span class="n">alt</span><span class="p">:</span> <span class="n">test</span>
    <span class="p">:</span><span class="n">srcset</span><span class="p">:</span> <span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">sphx_glr_test_001</span><span class="o">.</span><span class="n">png</span><span class="p">,</span> <span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">sphx_glr_test_001_2_0x</span><span class="o">.</span><span class="n">png</span> <span class="mf">2.0</span><span class="n">x</span>
    <span class="p">:</span><span class="n">class</span><span class="p">:</span> <span class="n">sphx</span><span class="o">-</span><span class="n">glr</span><span class="o">-</span><span class="n">single</span><span class="o">-</span><span class="n">img</span>
</pre></div>
</div>
<p>This is converted to html by the custom directive as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;../_images/sphx_glr_test_001.png&quot;</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;sphx-glr-single-img&quot;</span><span class="p">,</span>
    <span class="n">srcset</span><span class="o">=</span><span class="s2">&quot;../_images/sphx_glr_test_001.png, ../_images/sphx_glr_test_001_2_0x.png 2.0x&gt;</span>
</pre></div>
</div>
<p>This leads to a larger website, but clients that support the <code class="docutils literal notranslate"><span class="pre">srcset</span></code> tag will only
download the appropriate-sized images.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">image-sg</span></code> directive currently ignores other <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">image</span></code>
directive tags like <code class="docutils literal notranslate"><span class="pre">width</span></code>, <code class="docutils literal notranslate"><span class="pre">height</span></code>, and <code class="docutils literal notranslate"><span class="pre">align</span></code>. It also only works
with the <em>html</em> and <em>latex</em>  builders.</p>
</section>
<section id="image-scrapers">
<span id="id8"></span><h2>Image scrapers<a class="headerlink" href="#image-scrapers" title="Link to this heading">#</a></h2>
<p>Image scrapers are plugins that allow Sphinx-Gallery to detect images produced
during execution of your examples, and then embed them into documentation.
Scrapers can be activated by appending scraper names to the
<code class="docutils literal notranslate"><span class="pre">'image_scrapers'</span></code> tuple in your Sphinx-Gallery configuration. For example,
to scrape matplotlib images you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;image_scrapers&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">'image_scrapers':</span> <span class="pre">('matplotlib',)</span></code> which only scrapes
Matplotlib images. Note that this includes any images produced by packages that
are based on Matplotlib, for example Seaborn or Yellowbrick.</p>
<section id="matplotlib-animations">
<h3>Matplotlib animations<a class="headerlink" href="#matplotlib-animations" title="Link to this heading">#</a></h3>
<p>If you wish to embed <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.animation.Animation.html#matplotlib.animation.Animation" title="(in Matplotlib v3.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.animation.Animation</span></code></a>s as animations rather
than a single static image of the animation figure, you should use the
<cite>matplotlib_animations</cite> configuration. It accepts either a bool, indicating whether
animations should be enabled, or a tuple of the format: (enabled: bool, format: str):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;matplotlib_animations&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;mp4&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p><cite>matplotlib_animations</cite> is <cite>False</cite> by default.</p>
<p>Any file format supported by Matplotlib for animations is allowed. If no format
is specified (i.e., it is a single bool), or it is <em>None</em>, then the format is
determined by <code class="docutils literal notranslate"><span class="pre">rcParams['animation.html']</span></code> and related options in your
<a class="reference external" href="https://matplotlib.org/stable/tutorials/introductory/customizing.html">matplotlib rcParams</a>.
This means that it can be set inside your code block, though note that Sphinx-Gallery
will reset Matplotib defaults before each example file executes (see
<a class="reference internal" href="#reset-modules"><span class="std std-ref">Resetting modules</span></a>).</p>
<p>If the format is <code class="docutils literal notranslate"><span class="pre">'html5'</span></code> or <code class="docutils literal notranslate"><span class="pre">'jshtml'</span></code>, the animation will effectively
be embedded in the resulting HTML file. Otherwise the animation will be saved
in an external file, thus reducing the size of the ReST file generated.
If you request a format that saves to an external file, you will need the
<a class="reference external" href="https://pypi.org/project/sphinxcontrib-video/">sphinxcontrib-video extension</a>
installed in your environment.</p>
<p>Note that while <code class="docutils literal notranslate"><span class="pre">matplotlib_animations</span></code> allows you to set the
<code class="docutils literal notranslate"><span class="pre">rcParams['animation.html']</span></code> globally, setting it inside a code block will
override the global setting.</p>
<p>It‚Äôs also recommended to ensure that ‚ÄúFFmpeg‚Äù or ‚Äúimagemagick‚Äù is available as a
<code class="docutils literal notranslate"><span class="pre">writer</span></code>. Use
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.animation.ImageMagickWriter.html#matplotlib.animation.ImageMagickWriter" title="(in Matplotlib v3.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.animation.ImageMagickWriter.isAvailable()</span></code></a>
or
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.animation.FFMpegWriter.html#matplotlib.animation.FFMpegWriter" title="(in Matplotlib v3.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.animation.FFMpegWriter.isAvailable()</span></code></a>
to check.
We recommend FFMpeg writer, unless you are using Matplotlib &lt;3.3.1.</p>
<p>The following scrapers are supported:</p>
<ul class="simple">
<li><dl class="simple">
<dt>matplotlib</dt><dd><p>Sphinx-Gallery maintains a scraper for
<a class="reference external" href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="(in Matplotlib v3.9.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code></a> figures via the string
<code class="docutils literal notranslate"><span class="pre">'matplotlib'</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PyVista</dt><dd><p><a class="reference external" href="https://github.com/pyvista/pyvista">PyVista</a> maintains a scraper
(for PyVista &gt;= 0.20.3) enabled by the string <code class="docutils literal notranslate"><span class="pre">'pyvista'</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PyGMT</dt><dd><p>See <a class="reference external" href="https://www.pygmt.org/dev/">their website</a> for more information on
how to integrate with Sphinx-Gallery.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>qtgallery</dt><dd><p>This library provides a scraper for Qt windows. See <a class="reference external" href="https://github.com/ixjlyons/qtgallery">their repository</a>
for instructions on integrating with Sphinx-Gallery.</p>
</dd>
</dl>
</li>
</ul>
<p>It is possible to write custom scrapers for images generated by packages
outside of those listed above. This is accomplished
by writing your own Python function to define how to detect and retrieve
images produced by an arbitrary package. For instructions, see
<a class="reference internal" href="advanced.html#custom-scraper"><span class="std std-ref">Write a custom image scraper</span></a>. If you come up with an implementation that would be
useful for general use (e.g., a custom scraper for a plotting library)
feel free to add it to the list above (see discussion
<a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/issues/441#issuecomment-493782430">here</a>)!</p>
</section>
</section>
<section id="using-multiple-code-blocks-to-create-a-single-figure">
<span id="defer-figures"></span><h2>Using multiple code blocks to create a single figure<a class="headerlink" href="#using-multiple-code-blocks-to-create-a-single-figure" title="Link to this heading">#</a></h2>
<p>By default, images are scraped following each code block in an example. Thus,
the following produces two plots, with one plot per code block:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># This first code block produces a plot with two lines</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># %%</span>
<span class="c1"># This second code block produces a plot with one line</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>However, sometimes it can be useful to use multiple code blocks to create a
single figure, particularly if the figure takes a large number commands that
would benefit from being interleaved with text blocks. The optional flag
<code class="docutils literal notranslate"><span class="pre">sphinx_gallery_defer_figures</span></code> can be inserted as a comment anywhere in a code
block to defer the scraping of images to the next code block (where it can be
further deferred, if desired). The following produces only one plot:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># This first code block does not produce any plot</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># sphinx_gallery_defer_figures</span>

<span class="c1"># %%</span>
<span class="c1"># This second code block produces a plot with three lines</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="hiding-lines-of-code">
<span id="hiding-code-blocks"></span><h2>Hiding lines of code<a class="headerlink" href="#hiding-lines-of-code" title="Link to this heading">#</a></h2>
<p>Normally, Sphinx-Gallery will render every line of Python code when building
HTML and iPython notebooks. This is usually desirable, as we want to ensure the
Python source files, HTML, and iPython notebooks all do the same thing.</p>
<p>However, it is sometimes useful to have Python code that runs, but is not
included in any user-facing documentation. For example, suppose we wanted to
add some <code class="docutils literal notranslate"><span class="pre">assert</span></code> statements to verify the docs were built successfully, but
did not want these shown to users. We could use the <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_start_ignore</span></code>
and <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_end_ignore</span></code> flags to achieve this:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="c1"># sphinx_gallery_start_ignore</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>
<span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">count_params</span><span class="p">()</span> <span class="o">==</span> <span class="mi">219058</span>
<span class="c1"># sphinx_gallery_end_ignore</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>When the HTML or iPython notebooks are built, this code block will be shown as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_start_ignore</span></code> and <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_end_ignore</span></code> flags may
be used in any code block, and multiple pairs of flags may be used in the same
block. Every start flag must always have a corresponding end flag, or an error
will be raised during doc generation. These flags and the code between them are
always removed, regardless of what <code class="docutils literal notranslate"><span class="pre">remove_config_comments</span></code> is set to.</p>
<p>Note that any output from the ignored code will still be captured.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This flag should be used sparingly, as it makes the <code class="docutils literal notranslate"><span class="pre">.py</span></code> source files less
equivalent to the generated <code class="docutils literal notranslate"><span class="pre">.html</span></code> and <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> files. It is bad practice
to use this when other methods that preserve this relationship are possible.</p>
</div>
</section>
<section id="generating-dummy-images">
<span id="dummy-images"></span><h2>Generating dummy images<a class="headerlink" href="#generating-dummy-images" title="Link to this heading">#</a></h2>
<p>For quick visualization of your gallery, especially during the writing process,
Sphinx-Gallery allows you to build your gallery without executing the
code (see <a class="reference internal" href="#without-execution"><span class="std std-ref">Building without executing examples</span></a> and
<a class="reference internal" href="#build-pattern"><span class="std std-ref">filename/ignore patterns</span></a>). This however,
can cause warnings about missing image files if you have manually written
links to automatically generated images. To prevent these warnings you can
tell Sphinx-Gallery to create a number of dummy images for an example.</p>
<p>For example, you may have an example (‚Äòmy_example.py‚Äô) that generates 2 figures,
which you then reference manually elsewhere, e.g.,:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>Below is a great figure:

<span class="p">..</span> <span class="ow">figure</span><span class="p">::</span> ../auto_examples/images/sphx_glr_my_example_001.png

Here is another one:

<span class="p">..</span> <span class="ow">figure</span><span class="p">::</span> ../auto_examples/images/sphx_glr_my_example_002.png
</pre></div>
</div>
<p>To prevent missing image file warnings when building without executing, you
can add the following to the example file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_dummy_images=2</span>
</pre></div>
</div>
<p>This will cause Sphinx-Gallery to generate 2 dummy images with the same
naming convention and stored in the same location as images that would be
generated when building with execution. No dummy images will be generated
if there are existing images (e.g., from a previous run of the build),
so they will not be overwritten.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This configuration <strong>only</strong> works when the example is set to not execute
(i.e., the <code class="docutils literal notranslate"><span class="pre">plot_gallery</span></code> is <code class="docutils literal notranslate"><span class="pre">'False'</span></code>, the example is in
<cite>ignore_pattern</cite> or the example is not in <code class="docutils literal notranslate"><span class="pre">filename_pattern</span></code> - see
<a class="reference internal" href="#build-pattern"><span class="std std-ref">filename/ignore patterns</span></a>). This means that you will
not need to remove any <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_dummy_images</span></code> lines in your
examples when you switch to building your gallery with execution.</p>
</div>
</section>
<section id="resetting-modules">
<span id="reset-modules"></span><h2>Resetting modules<a class="headerlink" href="#resetting-modules" title="Link to this heading">#</a></h2>
<p>Often you wish to ‚Äúreset‚Äù the behavior of your visualization packages in order
to ensure that any changes made to plotting behavior in one example do not
propagate to the other examples.</p>
<p>By default, before each example file executes, Sphinx-Gallery will
reset <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> (by using <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.rcdefaults.html#matplotlib.pyplot.rcdefaults" title="(in Matplotlib v3.9.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.rcdefaults()</span></code></a> and
reloading submodules that populate the units registry) and <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>
(by trying to unload the module from <code class="docutils literal notranslate"><span class="pre">sys.modules</span></code>). This is equivalent to the
following configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reset_modules&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Currently, Sphinx-Gallery natively supports resetting <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and
<code class="docutils literal notranslate"><span class="pre">seaborn</span></code>. However, you can also add your own custom function to
this tuple in order to define resetting behavior for other visualization libraries.</p>
<p>To do so, follow the instructions in <a class="reference internal" href="advanced.html#custom-reset"><span class="std std-ref">Resetting before each example</span></a>.</p>
<section id="order-of-resetting-modules">
<span id="reset-modules-order"></span><h3>Order of resetting modules<a class="headerlink" href="#order-of-resetting-modules" title="Link to this heading">#</a></h3>
<p>By default, Sphinx-Gallery will reset modules before each example is run.
The choices for <code class="docutils literal notranslate"><span class="pre">reset_modules_order</span></code> are <code class="docutils literal notranslate"><span class="pre">before</span></code> (default), <code class="docutils literal notranslate"><span class="pre">after</span></code>, and
<code class="docutils literal notranslate"><span class="pre">both</span></code>. If the last example run in Sphinx-Gallery modifies a module, it is
recommended to use <code class="docutils literal notranslate"><span class="pre">after</span></code> or <code class="docutils literal notranslate"><span class="pre">both</span></code> to avoid leaking out a modified module to
other parts of the Sphinx build process. For example, set <code class="docutils literal notranslate"><span class="pre">reset_modules_order</span></code>
to <code class="docutils literal notranslate"><span class="pre">both</span></code> in the configuration:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reset_modules_order&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Custom functions can be constructed to have custom functionality depending on
whether they are called before or after the examples. See <a class="reference internal" href="advanced.html#custom-reset"><span class="std std-ref">Resetting before each example</span></a>
for more information.</p>
</section>
</section>
<section id="dealing-with-failing-gallery-example-scripts">
<h2>Dealing with failing Gallery example scripts<a class="headerlink" href="#dealing-with-failing-gallery-example-scripts" title="Link to this heading">#</a></h2>
<p>As your project evolves some of your example scripts might stop
executing properly. Sphinx-Gallery will assist you in the discovery process
of those bugged examples. The default behavior is to replace the
thumbnail of those examples in the gallery with the broken
thumbnail. That allows you to find with a quick glance of the gallery
which examples failed. Broken examples remain accessible in the html
view of the gallery and the traceback message is written for the
failing code block. Refer to example
<a class="reference internal" href="auto_examples/no_output/plot_raise.html#sphx-glr-auto-examples-no-output-plot-raise-py"><span class="std std-ref">Example that fails to execute</span></a> to view the default
behavior.</p>
<p>The build is also failed exiting with code 1 and giving you a summary
of the failed examples with their respective traceback. This way you
are aware of failing examples right after the build and can find them
easily.</p>
<p>There are some additional options at your hand to deal with broken examples.</p>
<section id="abort-build-on-first-fail">
<span id="abort-on-first"></span><h3>Abort build on first fail<a class="headerlink" href="#abort-build-on-first-fail" title="Link to this heading">#</a></h3>
<p>Sphinx-Gallery provides the early fail option. In
this mode the gallery build process breaks as soon as an exception
occurs in the execution of the examples scripts. To activate this
behavior you need to pass a flag at the build process. It can be done
by including in your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>:</p>
<div class="highlight-makefile notranslate"><div class="highlight"><pre><span></span><span class="nf">html_abort_on_example_error</span><span class="o">:</span>
<span class="w">    </span><span class="k">$(</span>SPHINXBUILD<span class="k">)</span><span class="w"> </span>-D<span class="w"> </span><span class="nv">abort_on_example_error</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>-b<span class="w"> </span>html<span class="w"> </span><span class="k">$(</span>ALLSPHINXOPTS<span class="k">)</span><span class="w"> </span><span class="k">$(</span>BUILDDIR<span class="k">)</span>/html
<span class="w">    </span>@echo
<span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;Build finished. The HTML pages are in </span><span class="k">$(</span>BUILDDIR<span class="k">)</span><span class="s2">/html.&quot;</span>
</pre></div>
</div>
<p>Remember that for <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> white space is significant and the indentation
are tabs and not spaces.</p>
<p>Alternatively, you can add the <code class="docutils literal notranslate"><span class="pre">abort_on_example_error</span></code> option to
the <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code> dictionary inside your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>
configuration file to have it as a default:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;abort_on_example_error&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The highest precedence is always given to the <cite>-D</cite> flag of
the <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> command.</p>
</section>
<section id="don-t-fail-the-build-if-specific-examples-error">
<span id="dont-fail-exit"></span><h3>Don‚Äôt fail the build if specific examples error<a class="headerlink" href="#don-t-fail-the-build-if-specific-examples-error" title="Link to this heading">#</a></h3>
<p>It might be the case that you want to keep the gallery even with
failed examples. Thus you can configure Sphinx-Gallery to allow
certain examples to fail and still exit with a 0 exit code. For this
you need to list all the examples you want to allow to fail during
build. Change your <cite>conf.py</cite> accordingly:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;expected_failing_examples&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;../examples/plot_raise.py&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here you list the examples you allow to fail during the build process,
keep in mind to specify the full relative path from your <cite>conf.py</cite> to
the example script.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an example is expected to fail, Sphinx-Gallery will error if
the example runs without error.</p>
</div>
</section>
<section id="never-fail-the-build-on-error">
<span id="warning-on-error"></span><h3>Never fail the build on error<a class="headerlink" href="#never-fail-the-build-on-error" title="Link to this heading">#</a></h3>
<p>Sphinx-Gallery can be configured to only log warnings when examples fail.
This means that sphinx will only exit with a non-zero exit code if the <code class="docutils literal notranslate"><span class="pre">-W</span></code>
flag is passed to <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code>. This can be enabled by setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;only_warn_on_example_error&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="build-examples-in-parallel">
<span id="parallel"></span><h3>Build examples in parallel<a class="headerlink" href="#build-examples-in-parallel" title="Link to this heading">#</a></h3>
<p>Sphinx-Gallery can be configured to run examples simultaneously using
<a class="reference external" href="https://joblib.readthedocs.io/en/latest/index.html#module-joblib" title="(in joblib v1.5.dev0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">joblib</span></code></a>. This can be enabled by setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;parallel&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, then that number of jobs will be passed to <a class="reference external" href="https://joblib.readthedocs.io/en/latest/generated/joblib.Parallel.html#joblib.Parallel" title="(in joblib v1.5.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">joblib.Parallel</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the same number of jobs will be used as the <code class="docutils literal notranslate"><span class="pre">-j</span></code> flag for
Sphinx.</p>
<p>Warnings emitted by <a class="reference external" href="https://joblib.readthedocs.io/en/latest/index.html#module-joblib" title="(in joblib v1.5.dev0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">joblib</span></code></a> during documentation building (e.g., the
<code class="docutils literal notranslate"><span class="pre">UserWarning</span></code> about a
<a class="reference external" href="https://github.com/joblib/joblib/issues/883">worker restarting</a>) are emitted
during gallery generation at the same time as warnings from example
code execution. These can be filtered out with
<code class="docutils literal notranslate"><span class="pre">warnings.filterwarnings</span></code> (see <a class="reference internal" href="#removing-warnings"><span class="std std-ref">Removing warnings</span></a>). This is particularly
important to do if you have tweaked warning handling in your documentation build
to treat warnings as errors, e.g., with a line like
<code class="docutils literal notranslate"><span class="pre">warnings.filterwarnings(&quot;error)</span></code> which converts all warnings into errors. In
this case, if joblib emits a warning during build of an example, this example will fail
unexpectedly unless they are filtered out. Note that this differs from the warnings
affected by the <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">W</span></code> / <code class="docutils literal notranslate"><span class="pre">--fail-on-warning</span></code> <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> flag, which converts
Sphinx warnings during documentation building into errors.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Some packages might not play nicely with parallel processing, so this feature
is considered <strong>experimental</strong>!</p>
<p>For example, you might need to set variables or call functions in a
<a class="reference internal" href="advanced.html#custom-reset"><span class="std std-ref">custom resetter</span></a> to ensure that all spawned processes are
properly set up and torn down. Parallelism is achieved through the Loky backend of
joblib, see <a class="reference external" href="https://joblib.readthedocs.io/en/latest/parallel.html#parallel" title="(in joblib v1.5.dev0)"><span>Embarrassingly parallel for loops</span></a> for documentation of many relevant conisderations
(e.g., pickling, oversubscription of CPU resources, etc.).</p>
<p>Using parallel building will also disable memory measurements.</p>
</div>
</section>
</section>
<section id="enabling-the-example-recommender-system">
<span id="recommend-examples"></span><h2>Enabling the example recommender system<a class="headerlink" href="#enabling-the-example-recommender-system" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery can be configured to generate content-based recommendations for
an example gallery. A list of related examples is automatically generated by
computing the closest examples in the <a class="reference external" href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf">TF-IDF</a> space of their text contents.
Only examples within a single gallery (including it‚Äôs sub-galleries) are used to
compute the closest examples. The most similar content is then displayed at the bottom
of each example as a set of thumbnails.</p>
<p>The recommender system can be enabled by setting <code class="docutils literal notranslate"><span class="pre">enable</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. To
configure it, pass a dictionary to the <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code>, e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;recommender&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;n_examples&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;min_df&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;max_df&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The only necessary parameter is <code class="docutils literal notranslate"><span class="pre">enable</span></code>. If any other parameters is not
specified, the default value is used. Below is a more complete explanation of
each field:</p>
<dl class="simple">
<dt>enable (type: bool, default: False)</dt><dd><p>Whether to generate recommendations inside the example gallery. Enabling this
feature requires adding <cite>numpy</cite> to the dependencies.</p>
</dd>
<dt>n_examples (type: int, default: 5)</dt><dd><p>Number of most relevant examples to display.</p>
</dd>
<dt>min_df (type: float in range [0.0, 1.0] | int, default: 3)</dt><dd><p>When building the vocabulary ignore terms that have a document frequency
strictly lower than the given threshold. If float, the parameter represents a
proportion of documents, integer represents absolute counts. This value is
also called cut-off in the literature.</p>
</dd>
<dt>max_df (type: float in range [0.0, 1.0] | int, default: 0.9)</dt><dd><p>When building the vocabulary ignore terms that have a document frequency
strictly higher than the given threshold. If float, the parameter represents a
proportion of documents, integer represents absolute counts.</p>
</dd>
<dt>rubric_header (type: str, default: ‚ÄúRelated examples‚Äù)</dt><dd><p>Customizable rubric header. It can be edited to more descriptive text or to
add external links, e.g. to the API doc of the recommender system on the
Sphinx-Gallery documentation.</p>
</dd>
</dl>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">min_df</span></code> and <code class="docutils literal notranslate"><span class="pre">max_df</span></code> can be customized by the user to trim
the very rare/very common words. This may improve the recommendations quality,
but more importantly, it spares some computation resources that would be wasted
on non-informative tokens.</p>
<p>Currently example recommendations are only computed for <code class="docutils literal notranslate"><span class="pre">.py</span></code> files.</p>
</section>
<section id="setting-gallery-thumbnail-size">
<span id="setting-thumbnail-size"></span><h2>Setting gallery thumbnail size<a class="headerlink" href="#setting-gallery-thumbnail-size" title="Link to this heading">#</a></h2>
<p>By default Sphinx-Gallery will generate thumbnails at size <code class="docutils literal notranslate"><span class="pre">(400,</span> <span class="pre">280)</span></code>.
The thumbnail image will then be scaled to the size specified by
<code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code>, adding pillarboxes or letterboxes as necessary to
maintain the original aspect ratio. The default <code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code> is
<code class="docutils literal notranslate"><span class="pre">(400,</span> <span class="pre">280)</span></code> (no scaling) and can be changed via the <code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code>
configuration, e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;thumbnail_size&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The gallery uses various CSS classes to display these thumbnails, which
default to maximum 160x112px. To change this you can modify the default CSS by
including your own CSS file via the Sphinx configuration
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/configuration.html#confval-html_static_path" title="(in Sphinx v8.1.0)"><code class="docutils literal notranslate"><span class="pre">html_static_path</span></code></a> (which will override default CSS classes
in <a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery/tree/master/sphinx_gallery/_static">Sphinx-Gallery CSS files</a>).
The following CSS would display the images at 250x250px instead of the default
160x112px:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">min-height</span><span class="p">:</span><span class="w"> </span><span class="mi">320</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span><span class="w"> </span><span class="p">.</span><span class="nc">figure</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span><span class="w"> </span><span class="nt">img</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">max-height</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">sphx-glr-thumbcontainer</span><span class="w"> </span><span class="nt">a</span><span class="p">.</span><span class="nc">internal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">270</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value of <code class="docutils literal notranslate"><span class="pre">thumbnail_size</span></code> will change from
<code class="docutils literal notranslate"><span class="pre">(400,</span> <span class="pre">280)</span></code> (2.5x maximum specified by CSS) to <code class="docutils literal notranslate"><span class="pre">(320,</span> <span class="pre">224)</span></code>
(2x maximum specified by CSS) in version 0.9.0. This is to
prevent unnecessary over-sampling.</p>
</div>
</section>
<section id="minimal-reported-time">
<span id="min-reported-time"></span><h2>Minimal reported time<a class="headerlink" href="#minimal-reported-time" title="Link to this heading">#</a></h2>
<p>By default, Sphinx-Gallery logs and embeds in the html output the time it took
to run each script. If the majority of your examples runs quickly, you may not
need this information.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">min_reported_time</span></code> parameter can be set to a number of seconds. The
duration of scripts that ran faster than that amount will not be logged nor
embedded in the html output.</p>
</section>
<section id="write-computation-times">
<span id="id10"></span><h2>Write computation times<a class="headerlink" href="#write-computation-times" title="Link to this heading">#</a></h2>
<p>Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> if you want to omit computation times from all gallery outputs.
This helps with reproducible builds.
Default is <code class="docutils literal notranslate"><span class="pre">True</span></code> unless the <code class="docutils literal notranslate"><span class="pre">SOURCE_DATE_EPOCH</span></code> environment variable is set.</p>
</section>
<section id="showing-memory-consumption">
<span id="show-memory"></span><h2>Showing memory consumption<a class="headerlink" href="#showing-memory-consumption" title="Link to this heading">#</a></h2>
<p>Sphinx-Gallery can use <code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code>, if installed, to report the peak
memory during the run of an example. After installing <code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code>,
you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;show_memory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It‚Äôs also possible to use your own custom memory reporter, for example
if you would rather see the GPU memory. In that case, <code class="docutils literal notranslate"><span class="pre">show_memory</span></code> must
be a callable that takes a single function to call (i.e., one generated
internally to run an individual script code block), and returns a two-element
tuple containing:</p>
<ol class="arabic simple">
<li><p>The memory used in MiB while running the function, and</p></li>
<li><p>The function output</p></li>
</ol>
<p>A version of this that would always report 0 memory used would be:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;show_memory&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">func</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">func</span><span class="p">()),</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="show-signature">
<span id="id11"></span><h2>Show signature<a class="headerlink" href="#show-signature" title="Link to this heading">#</a></h2>
<p>By default, Sphinx-Gallery writes a <strong>Generated by ‚Ä¶</strong> notice in the
generated output.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">show_signature</span></code> parameter can be used to disable it.</p>
</section>
<section id="controlling-what-output-is-captured">
<span id="capture-repr"></span><h2>Controlling what output is captured<a class="headerlink" href="#controlling-what-output-is-captured" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Configure <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> to be an empty tuple (i.e., <cite>capture_repr: ()</cite>)
to return to the output capturing behaviour prior to release v0.5.0.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> configuration allows the user to control what output
is captured, while executing the example <code class="docutils literal notranslate"><span class="pre">.py</span></code> files, and subsequently
incorporated into the built documentation. Data directed to standard output
is always captured. The value of the last statement of <em>each</em> code block, <em>if</em>
it is an expression, can also be captured. This can be done by providing
the name of the ‚Äòrepresentation‚Äô method to be captured in the <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code>
tuple, in order of preference. The representation methods currently supported
are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__repr__</span></code> - returns the official string representation of an object. This
is what is returned when your Python shell evaluates an expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__str__</span></code> - returns a string containing a nicely printable representation
of an object. This is what is used when you <code class="docutils literal notranslate"><span class="pre">print()</span></code> an object or pass it
to <code class="docutils literal notranslate"><span class="pre">format()</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code> - returns a HTML version of the object. This method is only
present in some objects, for example, pandas dataframes.</p></li>
</ul>
<p>Output capture can be controlled globally by the <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> configuration
setting or file-by-file by adding a comment to the example file, which overrides
any global setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_capture_repr = ()</span>
</pre></div>
</div>
<p>The default setting is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;capture_repr&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;_repr_html_&#39;</span><span class="p">,</span> <span class="s1">&#39;__repr__&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the default setting Sphinx-Gallery would first attempt to capture the
<code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code> of the last statement of a code block, <em>if</em> it is an
expression. If this method does not exist for the expression, the second
‚Äòrepresentation‚Äô method in the tuple, <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>, would be captured. If the
<code class="docutils literal notranslate"><span class="pre">__repr__</span></code> also does not exist (unlikely for non-user defined objects),
nothing would be captured. Data directed to standard output is <strong>always</strong>
captured. For several examples, see <a class="reference internal" href="auto_examples/plot_3_capture_repr.html#capture-repr-examples"><span class="std std-ref">Capturing output representations</span></a>.</p>
<p>To capture only data directed to standard output, configure <code class="docutils literal notranslate"><span class="pre">'capture_repr'</span></code>
to be an empty tuple: <code class="docutils literal notranslate"><span class="pre">'capture_repr':</span> <span class="pre">()</span></code>. This will imitate the behaviour
of Sphinx-Gallery prior to v0.5.0.</p>
<p>From another perspective, take for example the following code block:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="mi">2</span>
<span class="n">a</span>  <span class="c1"># this is an expression</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">'Hello</span> <span class="pre">world'</span></code> would be captured for every <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> setting as this
is directed to standard output. Further,</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> is an empty tuple, nothing else would be
captured.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> is <code class="docutils literal notranslate"><span class="pre">('__repr__')</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code> would also be captured.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> is <code class="docutils literal notranslate"><span class="pre">('_repr_html_',</span> <span class="pre">'__repr__')</span></code> (the default)
Sphinx-Gallery would first attempt to capture <code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code>. Since this
does not exist for <code class="docutils literal notranslate"><span class="pre">a</span></code>, it will then attempt to capture <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>.
The <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> method does exist for <code class="docutils literal notranslate"><span class="pre">a</span></code>, thus <code class="docutils literal notranslate"><span class="pre">2</span></code> would be also
captured in this case.</p></li>
</ul>
<p><strong>Matplotlib note</strong>: if the <code class="docutils literal notranslate"><span class="pre">'capture_repr'</span></code> tuple includes <code class="docutils literal notranslate"><span class="pre">'__repr__'</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">'__str__'</span></code>, code blocks which have a Matplotlib function call as the
last expression will generally produce a yellow output box in the built
documentation, as well as the figure. This is because matplotlib function calls
usually return something as well as creating/amending the plot in standard
output. For example, <code class="docutils literal notranslate"><span class="pre">matplotlib.plot()</span></code> returns a list of <code class="docutils literal notranslate"><span class="pre">Line2D</span></code> objects
representing the plotted data. This list has a <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> and a <code class="docutils literal notranslate"><span class="pre">__str__</span></code>
method which would thus be captured. You can prevent this by:</p>
<ul>
<li><p>assigning the (last) plotting function to a temporary variable. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>add <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> (which does not return anything) to the end of your
code block. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
<p>The unwanted string output will not occur if <code class="docutils literal notranslate"><span class="pre">'capture_repr'</span></code> is an empty
tuple or does not contain <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> or <code class="docutils literal notranslate"><span class="pre">__str__</span></code>.</p>
<section id="prevent-capture-of-certain-classes">
<h3>Prevent capture of certain classes<a class="headerlink" href="#prevent-capture-of-certain-classes" title="Link to this heading">#</a></h3>
<p>If you wish to capture a representation of the last expression of each code
blocks <strong>unless</strong> the last expression is of a certain type, you can use
<code class="docutils literal notranslate"><span class="pre">'ignore_repr_types'</span></code>. <code class="docutils literal notranslate"><span class="pre">'ignore_repr_types'</span></code> is by default an empty raw
string (<code class="docutils literal notranslate"><span class="pre">r''</span></code>), meaning no types are ignored. To exclude specific type(s)
from being captured, <code class="docutils literal notranslate"><span class="pre">'ignore_repr_types'</span></code> can be set to a regular
expression matching the name(s) of the type(s) to be excluded.</p>
<p>For example, the configuration below would capture the <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> of the
last expression of each code block unless the name of the <code class="docutils literal notranslate"><span class="pre">type()</span></code> of the last
expression includes the string ‚Äòmatplotlib.text‚Äô <em>or</em> ‚Äòmatplotlib.axes‚Äô.
This would prevent capturing of all subclasses of ‚Äòmatplotlib.text‚Äô, e.g.
expressions of type ‚Äòmatplotlib.text.Annotation‚Äô, ‚Äòmatplotlib.text.OffsetFrom‚Äô
etc. Similarly subclasses of ‚Äòmatplotlib.axes‚Äô (e.g. ‚Äòmatplotlib.axes.Axes‚Äô,
‚Äòmatplotlib.axes.Axes.plot‚Äô etc.) will also not be captured.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;capture_repr&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;__repr__&#39;</span><span class="p">),</span>
    <span class="s1">&#39;ignore_repr_types&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;matplotlib\.(text|axes)&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="nesting-gallery-sections">
<span id="nested-sections"></span><h2>Nesting gallery sections<a class="headerlink" href="#nesting-gallery-sections" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">nested_sections</span></code> lets you control how gallery <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> files are generated
when your <a class="reference internal" href="#multiple-galleries-config"><span class="std std-ref">gallery</span></a> has subsections
(sub-folders inside <a class="reference internal" href="#multiple-galleries-config"><span class="std std-ref">examples_dirs</span></a>, aka
sub-galleries). This can be useful for
controlling sidebar appearance. The default is set to <code class="docutils literal notranslate"><span class="pre">nested_sections=True</span></code>
because it generally works with the popular
<a class="reference external" href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">pydata-sphinx-theme</a>
theme. It can however, cause undesirable duplication in the sidebar with other
themes so users are advised to choose the most suitable <code class="docutils literal notranslate"><span class="pre">nested_sections</span></code> setting
for their theme.</p>
<p>With default <code class="docutils literal notranslate"><span class="pre">nested_sections=True</span></code>, Sphinx-Gallery will use the
<code class="docutils literal notranslate"><span class="pre">GALLERY_HEADER.[ext]</span></code> (or <code class="docutils literal notranslate"><span class="pre">README.[ext]</span></code> for backward-compatibility) files
for the parent gallery and each subsection to build separate index files for the
parent gallery and each subsection.
subsection index files will contain the subsection‚Äôs header (from the
<code class="docutils literal notranslate"><span class="pre">GALLERY_HEADER.[ext]</span></code> file) and a toctree
linking to each gallery example in the subsection.
The parent gallery‚Äôs main <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file will contain, in sequence:</p>
<ul class="simple">
<li><p>parent gallery header followed by gallery thumbnails,</p></li>
<li><p>a toctree linking to each gallery example in the parent gallery,</p></li>
<li><p>subsection header followed by subsection thumbnails, for all subsections,</p></li>
<li><p>a second toctree, at the end of the file, linking to all subsection index files.</p></li>
</ul>
<p>The generated file structure and toctrees mimic that of the parent gallery folder,
which may be needed for generating sidebars with nested sections for some themes.</p>
<p>For other themes, having two toctrees can cause undesirable duplication in the sidebar.
In this case you can try moving all parent gallery examples to their own sub-folder,
as this will result in a single toctree in the parent gallery <code class="docutils literal notranslate"><span class="pre">index.rst</span></code>, or
using <code class="docutils literal notranslate"><span class="pre">nested_sections=False</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nested_sections=False</span></code> makes Sphinx-Gallery behave as it used to
prior to version 0.10.2.
Specifically, it will generate a single index file for the whole gallery.
This index file will contain headers for the parent gallery and each subsection, with
each header followed by a toctree that links to every example in the
parent gallery/subsection.
For some themes, sidebars generated using these toctrees would list all gallery items
with a flat structure and not reflect the nested folder structure of sub-galleries.</p>
</section>
<section id="manually-passing-files">
<span id="manual-passthrough"></span><h2>Manually passing files<a class="headerlink" href="#manually-passing-files" title="Link to this heading">#</a></h2>
<p>By default, Sphinx-Gallery creates all the files that are written in the
sphinx-build directory, either by generating rst and images from a <code class="docutils literal notranslate"><span class="pre">*.py</span></code>
in the gallery-source, or from  creating <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> from
<code class="docutils literal notranslate"><span class="pre">GALLERY_HEADER.rst</span></code> (or <code class="docutils literal notranslate"><span class="pre">README.[rst/txt]</span></code> for backward-compatibility)
in the gallery-source.  However, sometimes it is desirable to pass files
from the gallery-source to the sphinx-build.  For example, you may want
to pass an image that a gallery refers to, but does not generate itself.
You may also want to pass raw rst from the gallery-source to the
sphinx-build, because that material fits in thematically with your gallery,
but is easier to write as rst.  To accommodate this, you may set
<code class="docutils literal notranslate"><span class="pre">copyfile_regex</span></code> in <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code>.  The following copies
across rst files.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
   <span class="s1">&#39;copyfile_regex&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;.*\.rst&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that if you copy across rst files, for instance, it is your
responsibility to ensure that they are in a sphinx <code class="docutils literal notranslate"><span class="pre">toctree</span></code> somewhere
in your document.  You can, of course, add a <code class="docutils literal notranslate"><span class="pre">toctree</span></code> to your
<code class="docutils literal notranslate"><span class="pre">GALLERY_HEADER.rst</span></code>.</p>
<section id="manually-passing-index-rst">
<h3>Manually passing <code class="docutils literal notranslate"><span class="pre">index.rst</span></code><a class="headerlink" href="#manually-passing-index-rst" title="Link to this heading">#</a></h3>
<p>You can bypass Sphinx-Gallery automatically creating an  <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> from a
<code class="docutils literal notranslate"><span class="pre">GALLERY_HEADER.rst</span></code> in a gallery directory or nested sub-gallery directory. If your
<code class="docutils literal notranslate"><span class="pre">copyfile_regex</span></code> includes <code class="docutils literal notranslate"><span class="pre">index.rst</span></code>, and you have an <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> in the
gallery-source (i.e., a <a class="reference internal" href="#multiple-galleries-config"><span class="std std-ref">examples_dirs</span></a> directory),
Sphinx-Gallery will use that instead and not make an index file for that gallery
or any of its sub-galleries.
If you pass your own <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file, you are responsible for
adding your own Sphinx <code class="docutils literal notranslate"><span class="pre">toctree</span></code> in that index (or elsewhere in your Sphinx
documentation) that includes any gallery items or other files in that
directory. You are also responsible for adding any necessary <code class="docutils literal notranslate"><span class="pre">index.rst</span></code>
files for that gallery‚Äôs sub-galleries.</p>
</section>
</section>
<section id="showing-api-usage">
<span id="show-api-usage"></span><h2>Showing API Usage<a class="headerlink" href="#showing-api-usage" title="Link to this heading">#</a></h2>
<p>Graphs and documentation of both unused API entries and the examples that
each API entry is used in are generated in the sphinx output directory under
<code class="docutils literal notranslate"><span class="pre">sg_api_usage.html</span></code>. See the
<a class="reference external" href="sg_api_usage.html">Sphinx-Gallery API usage documentation and graphs</a>
for example. In large projects, there are many modules and, since a graph
of API usage is generated for each module, this can use a lot of resources
so <code class="docutils literal notranslate"><span class="pre">show_api_usage</span></code> is set to <code class="docutils literal notranslate"><span class="pre">'unused'</span></code> by default. The unused API
entries are all shown in one graph so this scales much better for large
projects. Setting <code class="docutils literal notranslate"><span class="pre">show_api_usage</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> will make one graph per
module showing all of the API entries connected to the example that they
are used in. This could be helpful for making a map of which examples to
look at if you want to learn about a particular module. Setting
<code class="docutils literal notranslate"><span class="pre">show_api_usage</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> will not make any graphs or documentation
about API usage. Note, <code class="docutils literal notranslate"><span class="pre">graphviz</span></code> is required for making the unused and
used API entry graphs.</p>
<section id="ignoring-api-entries">
<span id="api-usage-ignore"></span><h3>Ignoring API entries<a class="headerlink" href="#ignoring-api-entries" title="Link to this heading">#</a></h3>
<p>By default, <code class="docutils literal notranslate"><span class="pre">api_usage_ignore='.*__.*__'</span></code> ignores files that match this
regular expression in documenting and graphing the usage of API entries
within the example gallery. This regular expression can be modified to
ignore any kind of file that should not be considered. The default regular
expression ignores functions like <code class="docutils literal notranslate"><span class="pre">__len__()</span></code> for which it may not be
desirable to document if they are used in examples.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="syntax.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Structuring Python scripts for Sphinx-Gallery</p>
      </div>
    </a>
    <a class="right-next"
       href="projects_list.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Who uses Sphinx-Gallery</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-options">Configuration options</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-conf-py-configurations">Global <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> configurations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configurations-inside-examples">Configurations inside examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-options">Build options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#css-changes">CSS changes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-warnings">Removing warnings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-callables">Importing callables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ensuring-a-stable-repr">Ensuring a stable <code class="docutils literal notranslate"><span class="pre">__repr__</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manage-multiple-galleries">Manage multiple galleries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-and-executing-examples-via-matching-patterns">Parsing and executing examples via matching patterns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rerunning-stale-examples">Rerunning stale examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#passing-command-line-arguments-to-example-scripts">Passing command line arguments to example scripts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-gallery-subsections">Sorting gallery subsections</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-gallery-examples">Sorting gallery examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-sort-keys">Custom sort keys</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-intersphinx-links-to-your-examples">Add intersphinx links to your examples</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resolving-module-paths">Resolving module paths</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-mini-galleries">Add mini-galleries</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-mini-galleries-for-api-documentation">Add mini-galleries for API documentation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-using-numpy-exp">Examples using <code class="docutils literal notranslate"><span class="pre">numpy.exp</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-mini-galleries-using-file-paths">Create mini-galleries using file paths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-using-one-of-multiple-objects">Examples using one of multiple objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-mini-gallery-thumbnails-from-files">Sort mini-gallery thumbnails from files</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#auto-documenting-your-api-with-links-to-examples">Auto-documenting your API with links to examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toggling-global-variable-inspection">Toggling global variable inspection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stylizing-code-links-using-css">Stylizing code links using CSS</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-custom-default-thumbnail">Using a custom default thumbnail</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-line-numbers-to-examples">Adding line numbers to examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-config-comments">Removing config comments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-your-own-first-and-last-notebook-cell">Add your own first and last notebook cell</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-images-to-notebooks">Adding images to notebooks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pypandoc-to-convert-rest-to-markdown">Using pypandoc to convert reST to markdown</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-junit-xml-files">Using JUnit XML files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-log-level">Setting log level</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#disabling-download-button-of-all-scripts">Disabling download button of all scripts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-the-thumbnail-image">Choosing the thumbnail image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#providing-an-image-for-the-thumbnail-image">Providing an image for the thumbnail image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-thumbnail-behaviour-in-failing-examples">Controlling thumbnail behaviour in failing examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-binder-links-for-gallery-notebooks-experimental">Generate Binder links for gallery notebooks (experimental)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-jupyterlite-links-for-gallery-notebooks-experimental">Generate JupyterLite links for gallery notebooks (experimental)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-notebook-download-links">Controlling notebook download links</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-cell-magic-executable-in-notebooks">Making cell magic executable in notebooks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-without-executing-examples">Building without executing examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressing-images">Compressing images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-resolution-images">Multi-resolution images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-scrapers">Image scrapers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib-animations">Matplotlib animations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-multiple-code-blocks-to-create-a-single-figure">Using multiple code blocks to create a single figure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hiding-lines-of-code">Hiding lines of code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-dummy-images">Generating dummy images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resetting-modules">Resetting modules</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#order-of-resetting-modules">Order of resetting modules</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-failing-gallery-example-scripts">Dealing with failing Gallery example scripts</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abort-build-on-first-fail">Abort build on first fail</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#don-t-fail-the-build-if-specific-examples-error">Don‚Äôt fail the build if specific examples error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#never-fail-the-build-on-error">Never fail the build on error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-examples-in-parallel">Build examples in parallel</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#enabling-the-example-recommender-system">Enabling the example recommender system</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-gallery-thumbnail-size">Setting gallery thumbnail size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimal-reported-time">Minimal reported time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-computation-times">Write computation times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#showing-memory-consumption">Showing memory consumption</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#show-signature">Show signature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-what-output-is-captured">Controlling what output is captured</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prevent-capture-of-certain-classes">Prevent capture of certain classes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nesting-gallery-sections">Nesting gallery sections</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manually-passing-files">Manually passing files</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manually-passing-index-rst">Manually passing <code class="docutils literal notranslate"><span class="pre">index.rst</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#showing-api-usage">Showing API Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ignoring-api-entries">Ignoring API entries</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      ¬© Copyright 2014-2024, Sphinx-gallery developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>