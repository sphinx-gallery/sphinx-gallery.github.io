

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced usage &mdash; Sphinx-Gallery 0.7.0.dev0-git documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Frequently Asked Questions" href="faq.html" />
    <link rel="prev" title="Who uses Sphinx-Gallery" href="projects_list.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Sphinx-Gallery
          

          
          </a>

          
            
            
              <div class="version">
                0.7.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Versions</span>
        v: dev
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Versions</dt>
          
            <dd><a href="https://sphinx-gallery.github.io/dev">dev</a></dd>
          
            <dd><a href="https://sphinx-gallery.github.io/stable">stable</a></dd>
          
        </dl>
      </div>
    </div>

    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Using Sphinx Gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started with Sphinx-Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax.html">How to structure your Python scripts for Sphinx-Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects_list.html">Who uses Sphinx-Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced usage and information</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#extend-your-makefile-for-sphinx-gallery">Extend your Makefile for Sphinx-Gallery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cleaning-the-gallery-files">Cleaning the gallery files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-the-gallery-without-running-any-examples">Build the gallery without running any examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#know-your-gallery-files">Know your Gallery files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#write-a-custom-image-scraper">Write a custom image scraper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-1-a-matplotlib-and-mayavi-style-scraper">Example 1: a Matplotlib and Mayavi-style scraper</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2-detecting-image-files-on-disk">Example 2: detecting image files on disk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-3-matplotlib-with-svg-format">Example 3: matplotlib with SVG format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrate-custom-scrapers-with-sphinx-gallery">Integrate custom scrapers with Sphinx-gallery</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#define-resetting-behavior-e-g-for-custom-libraries">Define resetting behavior (e.g., for custom libraries)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-only-sphinx-gallery-styles">Using (only) Sphinx-gallery styles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Sphinx-Gallery Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Example galleries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Gallery of Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/index.html">Notebook style example</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_mayavi_examples/index.html">Gallery of Examples using Mayavi</a></li>
</ul>
<p class="caption"><span class="caption-text">API and developer reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Sphinx-Gallery API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sphinx-gallery/sphinx-gallery">Fork sphinx-gallery on Github</a></li>
</ul>

            
          

  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sphinx-Gallery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Advanced usage</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-usage">
<span id="id1"></span><h1>Advanced usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline">Â¶</a></h1>
<p>This page contains more advanced topics in case you want to understand how
to use Sphinx-Gallery more deeply.</p>
<div class="contents local topic" id="contents">
<p class="topic-title"><strong>Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#extend-your-makefile-for-sphinx-gallery" id="id2">Extend your Makefile for Sphinx-Gallery</a></p>
<ul>
<li><p><a class="reference internal" href="#cleaning-the-gallery-files" id="id3">Cleaning the gallery files</a></p></li>
<li><p><a class="reference internal" href="#build-the-gallery-without-running-any-examples" id="id4">Build the gallery without running any examples</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#know-your-gallery-files" id="id5">Know your Gallery files</a></p></li>
<li><p><a class="reference internal" href="#write-a-custom-image-scraper" id="id6">Write a custom image scraper</a></p>
<ul>
<li><p><a class="reference internal" href="#example-1-a-matplotlib-and-mayavi-style-scraper" id="id7">Example 1: a Matplotlib and Mayavi-style scraper</a></p></li>
<li><p><a class="reference internal" href="#example-2-detecting-image-files-on-disk" id="id8">Example 2: detecting image files on disk</a></p></li>
<li><p><a class="reference internal" href="#example-3-matplotlib-with-svg-format" id="id9">Example 3: matplotlib with SVG format</a></p></li>
<li><p><a class="reference internal" href="#integrate-custom-scrapers-with-sphinx-gallery" id="id10">Integrate custom scrapers with Sphinx-gallery</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#define-resetting-behavior-e-g-for-custom-libraries" id="id11">Define resetting behavior (e.g., for custom libraries)</a></p></li>
<li><p><a class="reference internal" href="#using-only-sphinx-gallery-styles" id="id12">Using (only) Sphinx-gallery styles</a></p></li>
</ul>
</div>
<div class="section" id="extend-your-makefile-for-sphinx-gallery">
<h2><a class="toc-backref" href="#id2">Extend your Makefile for Sphinx-Gallery</a><a class="headerlink" href="#extend-your-makefile-for-sphinx-gallery" title="Permalink to this headline">Â¶</a></h2>
<p>This section describes some common extensions to the documentation Makefile
that are useful for Sphinx-Gallery.</p>
<div class="section" id="cleaning-the-gallery-files">
<h3><a class="toc-backref" href="#id3">Cleaning the gallery files</a><a class="headerlink" href="#cleaning-the-gallery-files" title="Permalink to this headline">Â¶</a></h3>
<p>Once your gallery is working you might need completely remove all generated files by
Sphinx-Gallery to have a clean build. For this we recommend adding the following
to your Sphinx <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>clean:
        rm -rf <span class="k">$(</span>BUILDDIR<span class="k">)</span>/*
        rm -rf auto_examples/
</pre></div>
</div>
</div>
<div class="section" id="build-the-gallery-without-running-any-examples">
<h3><a class="toc-backref" href="#id4">Build the gallery without running any examples</a><a class="headerlink" href="#build-the-gallery-without-running-any-examples" title="Permalink to this headline">Â¶</a></h3>
<p>If you wish to build your gallery without running examples first (e.g., if an
example takes a long time to run), add the following to your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>html-noplot:
        <span class="k">$(</span>SPHINXBUILD<span class="k">)</span> -D <span class="nv">plot_gallery</span><span class="o">=</span><span class="m">0</span> -b html <span class="k">$(</span>ALLSPHINXOPTS<span class="k">)</span> <span class="k">$(</span>BUILDDIR<span class="k">)</span>/html
        @echo
        @echo <span class="s2">&quot;Build finished. The HTML pages are in </span><span class="k">$(</span>BUILDDIR<span class="k">)</span><span class="s2">/html.&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="know-your-gallery-files">
<h2><a class="toc-backref" href="#id5">Know your Gallery files</a><a class="headerlink" href="#know-your-gallery-files" title="Permalink to this headline">Â¶</a></h2>
<p>The Gallery has been built, now you and all of your projectâs users
can already start enjoying it. All the temporary files needed to
generate the gallery (rst files, images, cache objects, etc) are
stored where you configured in <code class="docutils literal notranslate"><span class="pre">gallery_dirs</span></code>. The final files that go
into the HTML version of your documentation have a particular
namespace, to avoid collisions with your own files and images.</p>
<p>Our namespace convention is to prefix everything with <code class="docutils literal notranslate"><span class="pre">sphx_glr</span></code> and
change path separators with underscores. This is valid for
cross-references labels, and images.</p>
<p>So for example if we want to reference the example
<a class="reference internal" href="auto_examples/plot_0_sin.html#sphx-glr-auto-examples-plot-0-sin-py"><span class="std std-ref">Introductory example - Plotting sin</span></a>, we just call
its reference
<code class="docutils literal notranslate"><span class="pre">:ref:`sphx_glr_auto_examples_plot_0_sin.py`</span></code>. The image
it generated has the name <code class="docutils literal notranslate"><span class="pre">sphx_glr_plot_0_sin_001.png</span></code>
and its thumbnail is <code class="docutils literal notranslate"><span class="pre">sphx_glr_plot_0_sin_thumb.png</span></code></p>
<p>You can also include part of a gallery script elsewhere in your documentation
using the <a class="reference external" href="https://www.sphinx-doc.org/en/stable/usage/restructuredtext/directives.html#directive-literalinclude" title="(in Sphinx v1.8.0)"><code class="xref rst rst-dir docutils literal notranslate"><span class="pre">literalinclude</span></code></a> directive, in order to limit code duplication:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">literalinclude</span><span class="p">::</span> ../examples/plot_0_sin.py
   <span class="nc">:language:</span> python
   <span class="nc">:start-after:</span> # License: BSD 3 clause
   <span class="nc">:end-before:</span> # To avoid matplotlib
</pre></div>
</div>
<p>The above directive inserts the following block:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sin(x)$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using literalinclude is fragile and can break easily when examples are
changed (all the more when line numbers are used instead of <code class="docutils literal notranslate"><span class="pre">start-after</span></code>
and  <code class="docutils literal notranslate"><span class="pre">end-before</span></code>). Use with caution: linking directly to examples is
a more robust alternative.</p>
</div>
</div>
<div class="section" id="write-a-custom-image-scraper">
<span id="custom-scraper"></span><h2><a class="toc-backref" href="#id6">Write a custom image scraper</a><a class="headerlink" href="#write-a-custom-image-scraper" title="Permalink to this headline">Â¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The API for custom scrapers is currently experimental.</p>
</div>
<p>By default, Sphinx-gallery supports image scrapers for Matplotlib
(<a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.matplotlib_scraper" title="sphinx_gallery.scrapers.matplotlib_scraper"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib_scraper()</span></code></a>) and Mayavi
(<a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.mayavi_scraper" title="sphinx_gallery.scrapers.mayavi_scraper"><code class="xref py py-func docutils literal notranslate"><span class="pre">mayavi_scraper()</span></code></a>). If you wish to capture
output from other python packages, first determine if the object you wish to
capture has a <code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code> method. If so, you can use the configuration
<code class="docutils literal notranslate"><span class="pre">capture_repr</span></code> (<a class="reference internal" href="configuration.html#capture-repr"><span class="std std-ref">Controlling what output is captured</span></a>) to control the display of the object,
without the need to write a custom scraper. This configuration allows capture
of the raw html output, in a process similar to other html-based displays such
as <a class="reference external" href="https://jupyter.org/">jupyter</a>. If the first option does not work,
this section describes how to write a custom scraper.</p>
<p>Image scrapers are functions (or callable class instances) that do two things:</p>
<ol class="arabic simple">
<li><p>Collect a list of images created in the latest execution of code.</p></li>
<li><p>Write these images to disk in PNG, JPEG, or SVG format (with .png, .jpg, or
.svg extensions, respectively)</p></li>
<li><p>Return rST that embeds these figures in the built documentation.</p></li>
</ol>
<p>The function should take the following inputs (in this order):</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">block</span></code> - a Sphinx-Gallery <code class="docutils literal notranslate"><span class="pre">.py</span></code> file is separated into consecutive
lines of âcodeâ and rST âtextâ, called âblocksâ. For each
block, a tuple containing the (label, content, line_number)
(e.g. <code class="docutils literal notranslate"><span class="pre">('code',</span> <span class="pre">'print(&quot;Hello</span> <span class="pre">world&quot;)',</span> <span class="pre">5)</span></code>) of the block is created.</p>
<ul class="simple">
<li><p>âlabelâ is a string that can either be <code class="docutils literal notranslate"><span class="pre">'text'</span></code> or <code class="docutils literal notranslate"><span class="pre">'code'</span></code>. In this
context, it should only be <code class="docutils literal notranslate"><span class="pre">'code'</span></code> as this function is only called for
code blocks.</p></li>
<li><p>âcontentâ is a string containing the actual content of the code block.</p></li>
<li><p>âline_numberâ is an integer, indicating the line number that the block
starts at.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">block_vars</span></code> - dictionary of configuration and runtime variables. Of
interest for image scrapers is the element <code class="docutils literal notranslate"><span class="pre">'image_path_iterator'</span></code> which
is an iterable object which returns an absolute path to an image file name
adhering to Sphinx-Gallery naming convention. The path directs to the
<code class="docutils literal notranslate"><span class="pre">gallery_dirs/images</span></code> directory (<a class="reference internal" href="getting_started.html#configure-and-use-sphinx-gallery"><span class="std std-ref">Configure and use sphinx-gallery</span></a>)
and the image file name is <code class="docutils literal notranslate"><span class="pre">'sphx_glr_'</span></code> followed by the name of the
source <code class="docutils literal notranslate"><span class="pre">.py</span></code> file then a number, which starts at 1 and increases by 1 at
each iteration. The default file format is <code class="docutils literal notranslate"><span class="pre">.'png'</span></code>. For example:
<code class="docutils literal notranslate"><span class="pre">'home/user/Documents/module/auto_examples/images/sphx_glr_plot_mymodule_001.png'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gallery_conf</span></code> - dictionary containing the configuration of Sphinx-Gallery,
set under <code class="docutils literal notranslate"><span class="pre">sphinx_gallery_conf</span></code> in <code class="docutils literal notranslate"><span class="pre">doc/conf.py</span></code> (<a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration</span></a>).</p></li>
</ol>
<p>It should return a string containing the rST for embedding this figure in the
documentation. See <a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.matplotlib_scraper" title="sphinx_gallery.scrapers.matplotlib_scraper"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib_scraper()</span></code></a> for an
example of a scraper function (click on âsourceâ below the function name to see
the source code). The <a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.matplotlib_scraper" title="sphinx_gallery.scrapers.matplotlib_scraper"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib_scraper()</span></code></a> uses
the helper function <a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.figure_rst" title="sphinx_gallery.scrapers.figure_rst"><code class="xref py py-func docutils literal notranslate"><span class="pre">sphinx_gallery.scrapers.figure_rst()</span></code></a> to help generate
rST (see below).</p>
<p>This function will be called once for each code block of your examples.
Sphinx-gallery will take care of scaling images for the gallery
index page thumbnails. PNG images are scaled using Pillow, and
SVG images are copied.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>SVG images do not work with <code class="docutils literal notranslate"><span class="pre">latex</span></code> build modes, thus will not
work while building a PDF version of your documentation.</p>
</div>
<div class="section" id="example-1-a-matplotlib-and-mayavi-style-scraper">
<h3><a class="toc-backref" href="#id7">Example 1: a Matplotlib and Mayavi-style scraper</a><a class="headerlink" href="#example-1-a-matplotlib-and-mayavi-style-scraper" title="Permalink to this headline">Â¶</a></h3>
<p>For example, we will show sample code for a scraper for a hypothetical package.
It uses an approach similar to what <a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.matplotlib_scraper" title="sphinx_gallery.scrapers.matplotlib_scraper"><code class="xref py py-func docutils literal notranslate"><span class="pre">sphinx_gallery.scrapers.matplotlib_scraper()</span></code></a>
and <a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.mayavi_scraper" title="sphinx_gallery.scrapers.mayavi_scraper"><code class="xref py py-func docutils literal notranslate"><span class="pre">sphinx_gallery.scrapers.mayavi_scraper()</span></code></a> do under the hood, which
use the helper function <a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.figure_rst" title="sphinx_gallery.scrapers.figure_rst"><code class="xref py py-func docutils literal notranslate"><span class="pre">sphinx_gallery.scrapers.figure_rst()</span></code></a> to
create the standardized rST. If your package will be used to write an image file
to disk (e.g., PNG or JPEG), we recommend you use a similar approach.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_module_scraper</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">block_vars</span><span class="p">,</span> <span class="n">gallery_conf</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">mymodule</span>
    <span class="c1"># We use a list to collect references to image names</span>
    <span class="n">image_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="c1"># The `image_path_iterator` is created by Sphinx-gallery, it will yield</span>
    <span class="c1"># a path to a file name that adheres to Sphinx-gallery naming convention.</span>
    <span class="n">image_path_iterator</span> <span class="o">=</span> <span class="n">block_vars</span><span class="p">[</span><span class="s1">&#39;image_path_iterator&#39;</span><span class="p">]</span>

    <span class="c1"># Define a list of our already-created figure objects.</span>
    <span class="n">list_of_my_figures</span> <span class="o">=</span> <span class="n">mymodule</span><span class="o">.</span><span class="n">get_figures</span><span class="p">()</span>

    <span class="c1"># Iterate through figure objects, save to disk, and keep track of paths.</span>
    <span class="k">for</span> <span class="n">fig</span><span class="p">,</span> <span class="n">image_path</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_of_my_figures</span><span class="p">,</span> <span class="n">image_path_iterator</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">save_png</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">image_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>

    <span class="c1"># Close all references to figures so they aren&#39;t used later.</span>
    <span class="n">mymodule</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

    <span class="c1"># Use the `figure_rst` helper function to generate the rST for this</span>
    <span class="c1"># code block&#39;s figures. Alternatively you can define your own rST.</span>
    <span class="k">return</span> <span class="n">figure_rst</span><span class="p">(</span><span class="n">image_names</span><span class="p">,</span> <span class="n">gallery_conf</span><span class="p">[</span><span class="s1">&#39;src_dir&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>This code would be defined either in your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file, or as a module that
you import into your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file. The configuration needed to use this
scraper would look like:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;image_scrapers&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="n">my_module_scraper</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2-detecting-image-files-on-disk">
<h3><a class="toc-backref" href="#id8">Example 2: detecting image files on disk</a><a class="headerlink" href="#example-2-detecting-image-files-on-disk" title="Permalink to this headline">Â¶</a></h3>
<p>Hereâs another example that assumes that images have <em>already been written to
disk</em>. In this case we wonât <em>generate</em> any image files, weâll only generate
the rST needed to embed them in the documentation.</p>
<p>Weâll use a callable class in this case, and assume it is defined within your
package in a module called <code class="docutils literal notranslate"><span class="pre">scraper</span></code>. Here is the scraper code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">sphinx_gallery.gen_rst</span> <span class="kn">import</span> <span class="n">figure_rst</span>

<span class="k">class</span> <span class="nc">PNGScraper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;PNGScraper&#39;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">block_vars</span><span class="p">,</span> <span class="n">gallery_conf</span><span class="p">):</span>
        <span class="c1"># Find all PNG files in the directory of this example.</span>
        <span class="n">path_current_example</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">block_vars</span><span class="p">[</span><span class="s1">&#39;src_file&#39;</span><span class="p">])</span>
        <span class="n">pngs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_current_example</span><span class="p">,</span> <span class="s1">&#39;*.png&#39;</span><span class="p">)))</span>

        <span class="c1"># Iterate through PNGs, copy them to the sphinx-gallery output directory</span>
        <span class="n">image_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">image_path_iterator</span> <span class="o">=</span> <span class="n">block_vars</span><span class="p">[</span><span class="s1">&#39;image_path_iterator&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">png</span> <span class="ow">in</span> <span class="n">pngs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">png</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seen</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seen</span> <span class="o">|=</span> <span class="nb">set</span><span class="p">(</span><span class="n">png</span><span class="p">)</span>
                <span class="n">this_image_path</span> <span class="o">=</span> <span class="n">image_path_iterator</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                <span class="n">image_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_image_path</span><span class="p">)</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">png</span><span class="p">,</span> <span class="n">this_image_path</span><span class="p">)</span>
        <span class="c1"># Use the `figure_rst` helper function to generate rST for image files</span>
        <span class="k">return</span> <span class="n">figure_rst</span><span class="p">(</span><span class="n">image_names</span><span class="p">,</span> <span class="n">gallery_conf</span><span class="p">[</span><span class="s1">&#39;src_dir&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Then, in our <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file, we include the following code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mymodule</span> <span class="kn">import</span> <span class="n">PNGScraper</span>

<span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;image_scrapers&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="n">PNGScraper</span><span class="p">()),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="example-3-matplotlib-with-svg-format">
<h3><a class="toc-backref" href="#id9">Example 3: matplotlib with SVG format</a><a class="headerlink" href="#example-3-matplotlib-with-svg-format" title="Permalink to this headline">Â¶</a></h3>
<p>The <a class="reference internal" href="gen_modules/sphinx_gallery.scrapers.html#sphinx_gallery.scrapers.matplotlib_scraper" title="sphinx_gallery.scrapers.matplotlib_scraper"><code class="xref py py-func docutils literal notranslate"><span class="pre">sphinx_gallery.scrapers.matplotlib_scraper()</span></code></a> supports <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>
to pass to <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure.savefig" title="(in Matplotlib v3.2.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.figure.Figure.savefig()</span></code></a>, one of which is the
<code class="docutils literal notranslate"><span class="pre">format</span></code> argument. Currently sphinx-gallery supports PNG (default) and SVG
output formats. To use SVG, you can do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sphinx_gallery.scrapers</span> <span class="kn">import</span> <span class="n">matplotlib_scraper</span>

<span class="k">class</span> <span class="nc">matplotlib_svg_scraper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">matplotlib_scraper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;svg&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;image_scrapers&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">matplotlib_svg_scraper</span><span class="p">(),),</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can also use different formats on a per-image basis, but this requires
writing a customized scraper class or function.</p>
</div>
<div class="section" id="integrate-custom-scrapers-with-sphinx-gallery">
<h3><a class="toc-backref" href="#id10">Integrate custom scrapers with Sphinx-gallery</a><a class="headerlink" href="#integrate-custom-scrapers-with-sphinx-gallery" title="Permalink to this headline">Â¶</a></h3>
<p>Sphinx-gallery plans to internally maintain only two scrapers: matplotlib and
mayavi. If you have extended or fixed bugs with these scrapers, we welcome PRs
to improve them!</p>
<p>On the other hand, if you have developed a custom scraper for a different
plotting library that would be useful to the broader community, we encourage
you to get it working with Sphinx-gallery and then maintain it externally
(probably in the package that it scrapes), and then integrate and advertise
it with Sphinx-gallery. You can:</p>
<ol class="arabic">
<li><p>Contribute it to the list of externally supported scrapers located in
<a class="reference internal" href="configuration.html#reset-modules"><span class="std std-ref">Resetting modules</span></a>.</p></li>
<li><p>Optional: add a custom hook to your module root to simplify scraper use.
Taking PyVista as an example, adding <code class="docutils literal notranslate"><span class="pre">pyvista._get_sg_image_scraper()</span></code>
that returns the <code class="docutils literal notranslate"><span class="pre">callable</span></code> scraper to be used by Sphinx-gallery allows
PyVista users to just use strings as they already can for
<code class="docutils literal notranslate"><span class="pre">'matplotlib'</span></code> and <code class="docutils literal notranslate"><span class="pre">'mayavi'</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;image_scrapers&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;pyvista&#39;</span><span class="p">,)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sphinx-gallery will look for this custom function and call it to get the
PyVista image scraper to use before running any examples.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="define-resetting-behavior-e-g-for-custom-libraries">
<span id="custom-reset"></span><h2><a class="toc-backref" href="#id11">Define resetting behavior (e.g., for custom libraries)</a><a class="headerlink" href="#define-resetting-behavior-e-g-for-custom-libraries" title="Permalink to this headline">Â¶</a></h2>
<p>Sphinx-gallery natively supports resetting <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>.
However, if youâd like to support resetting for other libraries (or would like
to modify the resetting behavior for a natively-supported library), you can
add a custom function to the resetting tuple defined in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>.</p>
<p>The function takes two variables: a dictionary called <code class="docutils literal notranslate"><span class="pre">gallery_conf</span></code> (which is
your Sphinx-gallery configuration) and a string called <code class="docutils literal notranslate"><span class="pre">fname</span></code> (which is the
file name of the currently-executed Python script). These generally donât need
to be used in order to perform whatever resetting behavior you want, but must
be included in the function definition for compatibility reasons.</p>
<p>For example, to reset matplotlib to always use the <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> style, you could do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reset_mpl</span><span class="p">(</span><span class="n">gallery_conf</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>
    <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any custom functions can be defined (or imported) in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> and given to
the <code class="docutils literal notranslate"><span class="pre">reset_modules</span></code> configuration key. For the function defined above:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx_gallery_conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;reset_modules&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">reset_mpl</span><span class="p">,</span> <span class="s1">&#39;seaborn&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using resetters such as <code class="docutils literal notranslate"><span class="pre">reset_mpl</span></code> that deviate from the
standard behavior that users will experience when manually running
examples themselves is discouraged due to the inconsistency
that results between the rendered examples and local outputs.</p>
</div>
</div>
<div class="section" id="using-only-sphinx-gallery-styles">
<h2><a class="toc-backref" href="#id12">Using (only) Sphinx-gallery styles</a><a class="headerlink" href="#using-only-sphinx-gallery-styles" title="Permalink to this headline">Â¶</a></h2>
<p>If you just want to make use of sphinx-gallery CSS files, instead of using
the <code class="docutils literal notranslate"><span class="pre">sphinx_gallery.gen_gallery</span></code> extension, you can use in <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sphinx_gallery.load_style&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>This will only cause the <code class="docutils literal notranslate"><span class="pre">gallery.css</span></code> file to be added to your build.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="faq.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="projects_list.html" class="btn btn-neutral float-left" title="Who uses Sphinx-Gallery" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2020, Sphinx-gallery developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>